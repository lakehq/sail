{
  "tests": [
    {
      "input": "\nSELECT\n/*+ REPARTITION(100, c), BROADCASTJOIN(u), COALESCE(50), REPARTITION(300, c) */\n* FROM t\n        ",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ BROADCAST(tab) */ * FROM testcat.db.tab",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "testcat",
                      "db",
                      "tab"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ BROADCASTJOIN(u) */ * FROM t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ BROADCASTJOIN(u), REPARTITION(100) */ * FROM t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ COALESCE(10) */ * FROM t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ COALESCE(30 + 50) */ * FROM t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ HINT */ * FROM t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ HINT() */ * FROM t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ HINT1('a', (b, c), (1, 2)) */ * from t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ HINT1(a, 1) */ /*+ hint2(b, 2) */ * from t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ HINT1(a, 1) hint2(b, 2) */ * from t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ HINT1(a, 1), hint2(b, 2) */ /*+ hint3(c, 3) */ * from t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ HINT1(a, 1),hint2(b, 2) */ * from t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ HINT1(a, 5, 'a', b) */ * from t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ HINT1(a, array(1, 2, 3)) */ * from t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ INDEX(a b c) */ * from default.t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "default",
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ INDEX(t, emp_job_ix) */ * FROM t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ MAPJOIN(`default.t`) */ * from `default.t`",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "default.t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ MAPJOIN(t) */ a from t where true group by a order by a",
      "output": {
        "success": {
          "root": {
            "sort": {
              "input": {
                "aggregate": {
                  "input": {
                    "filter": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "identifier": [
                              "t"
                            ],
                            "options": {}
                          },
                          "isStreaming": false
                        },
                        "planId": null,
                        "sourceInfo": null
                      },
                      "condition": {
                        "literal": {
                          "boolean": true
                        }
                      }
                    },
                    "planId": null,
                    "sourceInfo": null
                  },
                  "groupType": "groupBy",
                  "groupingExpressions": [
                    {
                      "unresolvedAttribute": {
                        "name": [
                          "a"
                        ],
                        "planId": null
                      }
                    }
                  ],
                  "aggregateExpressions": [
                    {
                      "unresolvedAttribute": {
                        "name": [
                          "a"
                        ],
                        "planId": null
                      }
                    }
                  ],
                  "pivot": null
                },
                "planId": null,
                "sourceInfo": null
              },
              "order": [
                {
                  "child": {
                    "unresolvedAttribute": {
                      "name": [
                        "a"
                      ],
                      "planId": null
                    }
                  },
                  "direction": "unspecified",
                  "nullOrdering": "unspecified"
                }
              ],
              "isGlobal": true
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ MAPJOIN(u) */ * FROM t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ REPARTITION(100) */ * FROM t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ REPARTITION(100, c) */ * FROM t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ REPARTITION(100, c), BROADCASTJOIN(u), COALESCE(50) */ * FROM t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ REPARTITION(100, c), COALESCE(50) */ * FROM t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ REPARTITION(c) */ * FROM t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ REPARTITION_BY_RANGE(100, c) */ * FROM t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ REPARTITION_BY_RANGE(c) */ * FROM t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    },
    {
      "input": "SELECT /*+ STREAMTABLE(a,b,c) */ * FROM t",
      "output": {
        "success": {
          "root": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "identifier": [
                      "t"
                    ],
                    "options": {}
                  },
                  "isStreaming": false
                },
                "planId": null,
                "sourceInfo": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null
                  }
                }
              ]
            },
            "planId": null,
            "sourceInfo": null
          }
        }
      }
    }
  ]
}
