{
  "tests": [
    {
      "input": "\nSELECT *\nFROM\n(\n    SELECT *\n    FROM testData\n)\nWATERMARK ts DELAY OF INTERVAL 10 seconds AS tbl\nWHERE a > 1\n",
      "output": {
        "failure": "invalid argument: found ts at 60:62 expected '(', 'NATURAL', 'INNER', 'CROSS', 'OUTER', 'SEMI', 'ANTI', 'LEFT', 'RIGHT', 'FULL', 'JOIN', ',', 'LATERAL', 'WHERE', 'GROUP', 'HAVING', 'INTERSECT', 'UNION', 'EXCEPT', 'MINUS', 'WINDOW', 'ORDER', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'LIMIT', 'OFFSET', ';', or end of input"
      }
    },
    {
      "input": "\nSELECT *\nFROM\nVALUES (1, 1), (2, 2)\nWATERMARK ts DELAY OF INTERVAL 10 seconds AS dst\nWHERE a > 1\n",
      "exception": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'ts'. SQLSTATE: 42601 (line 5, pos 10)\n\n== SQL ==\n\nSELECT *\nFROM\nVALUES (1, 1), (2, 2)\nWATERMARK ts DELAY OF INTERVAL 10 seconds AS dst\n----------^^^\nWHERE a > 1\n",
      "output": {
        "failure": "invalid argument: found DELAY at 50:55 expected '(', 'NATURAL', 'INNER', 'CROSS', 'OUTER', 'SEMI', 'ANTI', 'LEFT', 'RIGHT', 'FULL', 'JOIN', ',', 'LATERAL', 'WHERE', 'GROUP', 'HAVING', 'INTERSECT', 'UNION', 'EXCEPT', 'MINUS', 'WINDOW', 'ORDER', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'LIMIT', 'OFFSET', ';', or end of input"
      }
    },
    {
      "input": "\nSELECT *\nFROM\nmock_tvf(1, 'a')\nWATERMARK ts DELAY OF INTERVAL 10 seconds AS dst\nWHERE a > 1\n",
      "output": {
        "failure": "invalid argument: found ts at 42:44 expected '(', 'NATURAL', 'INNER', 'CROSS', 'OUTER', 'SEMI', 'ANTI', 'LEFT', 'RIGHT', 'FULL', 'JOIN', ',', 'LATERAL', 'WHERE', 'GROUP', 'HAVING', 'INTERSECT', 'UNION', 'EXCEPT', 'MINUS', 'WINDOW', 'ORDER', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'LIMIT', 'OFFSET', ';', or end of input"
      }
    },
    {
      "input": "\nSELECT *\nFROM testData\nWATERMARK timestamp_seconds(value) AS eventTime DELAY OF INTERVAL 10 seconds AS tbl\nWHERE a > 1\n",
      "output": {
        "failure": "invalid argument: found timestamp_seconds at 34:51 expected '(', 'NATURAL', 'INNER', 'CROSS', 'OUTER', 'SEMI', 'ANTI', 'LEFT', 'RIGHT', 'FULL', 'JOIN', ',', 'LATERAL', 'WHERE', 'GROUP', 'HAVING', 'INTERSECT', 'UNION', 'EXCEPT', 'MINUS', 'WINDOW', 'ORDER', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'LIMIT', 'OFFSET', ';', or end of input"
      }
    },
    {
      "input": "\nSELECT *\nFROM testData\nWATERMARK timestamp_seconds(value) DELAY OF INTERVAL 10 seconds AS tbl\nWHERE a > 1\n",
      "output": {
        "failure": "invalid argument: found timestamp_seconds at 34:51 expected '(', 'NATURAL', 'INNER', 'CROSS', 'OUTER', 'SEMI', 'ANTI', 'LEFT', 'RIGHT', 'FULL', 'JOIN', ',', 'LATERAL', 'WHERE', 'GROUP', 'HAVING', 'INTERSECT', 'UNION', 'EXCEPT', 'MINUS', 'WINDOW', 'ORDER', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'LIMIT', 'OFFSET', ';', or end of input"
      }
    },
    {
      "input": "\nSELECT *\nFROM testData\nWATERMARK ts DELAY OF INTERVAL 10 seconds AS tbl\nWHERE a > 1\n",
      "output": {
        "failure": "invalid argument: found ts at 34:36 expected '(', 'NATURAL', 'INNER', 'CROSS', 'OUTER', 'SEMI', 'ANTI', 'LEFT', 'RIGHT', 'FULL', 'JOIN', ',', 'LATERAL', 'WHERE', 'GROUP', 'HAVING', 'INTERSECT', 'UNION', 'EXCEPT', 'MINUS', 'WINDOW', 'ORDER', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'LIMIT', 'OFFSET', ';', or end of input"
      }
    },
    {
      "input": "\nSELECT -- continued after the following block comments...\n/* Deeply nested comment.\n   This includes a single apostrophe to make sure we aren't decoding this part as a string.\nSELECT 'deep nest' AS n1;\n/* Second level of nesting...\nSELECT 'deeper nest' as n2;\n/* Third level of nesting...\nSELECT 'deepest nest' as n3;\n*/\nHoo boy. Still two deep...\n*/\nNow just one deep...\n*/\n* FROM a\n      ",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a"
                    ],
                    "temporal": null,
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "\nSELECT TRANSFORM(a, b, c)\n  ROW FORMAT DELIMITED\n  FIELDS TERMINATED BY '\\t'\n  COLLECTION ITEMS TERMINATED BY '\u0002'\n  MAP KEYS TERMINATED BY '\u0003'\n  LINES TERMINATED BY '\\n'\n  NULL DEFINED AS 'null'\n  USING 'cat' AS (a, b, c)\n  ROW FORMAT DELIMITED\n  FIELDS TERMINATED BY '\\t'\n  COLLECTION ITEMS TERMINATED BY '\u0004'\n  MAP KEYS TERMINATED BY '\u0005'\n  LINES TERMINATED BY '\\n'\n  NULL DEFINED AS 'NULL'\nFROM testData\n      ",
      "output": {
        "failure": "invalid argument: found FORMAT at 33:39 expected ',', 'FROM', 'LATERAL', 'WHERE', 'GROUP', 'HAVING', 'INTERSECT', 'UNION', 'EXCEPT', 'MINUS', 'WINDOW', 'ORDER', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'LIMIT', 'OFFSET', ';', or end of input"
      }
    },
    {
      "input": "\nSELECT TRANSFORM(a, b, c)\nUSING 'cat'\nFROM testData\n      ",
      "output": {
        "failure": "invalid argument: found USING at 27:32 expected 'RESPECT', 'IGNORE', 'WITHIN', 'FILTER', 'OVER', '.', '[', '::', 'ESCAPE', 'IS', 'NOT', 'IN', '*', '/', '%', 'DIV', '+', '-', '||', '>>>', '>>', '<<', '&', '^', '|', '!=', '!>', '!<', '==', '=', '>=', '>', '<=>', '<=', '<>', '<', 'BETWEEN', 'LIKE', 'ILIKE', 'RLIKE', 'REGEXP', 'SIMILAR', 'AND', 'OR', 'AS', identifier, '(', ',', 'FROM', 'LATERAL', 'WHERE', 'GROUP', 'HAVING', 'INTERSECT', 'UNION', 'EXCEPT', 'MINUS', 'WINDOW', 'ORDER', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'LIMIT', 'OFFSET', ';', or end of input"
      }
    },
    {
      "input": "\nSELECT TRANSFORM(a, b, c)\nUSING 'cat' AS (a int, b string, c long)\nFROM testData\n      ",
      "output": {
        "failure": "invalid argument: found USING at 27:32 expected 'RESPECT', 'IGNORE', 'WITHIN', 'FILTER', 'OVER', '.', '[', '::', 'ESCAPE', 'IS', 'NOT', 'IN', '*', '/', '%', 'DIV', '+', '-', '||', '>>>', '>>', '<<', '&', '^', '|', '!=', '!>', '!<', '==', '=', '>=', '>', '<=>', '<=', '<>', '<', 'BETWEEN', 'LIKE', 'ILIKE', 'RLIKE', 'REGEXP', 'SIMILAR', 'AND', 'OR', 'AS', identifier, '(', ',', 'FROM', 'LATERAL', 'WHERE', 'GROUP', 'HAVING', 'INTERSECT', 'UNION', 'EXCEPT', 'MINUS', 'WINDOW', 'ORDER', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'LIMIT', 'OFFSET', ';', or end of input"
      }
    },
    {
      "input": "\nSELECT TRANSFORM(a, b, c)\nUSING 'cat' AS (a, b, c)\nFROM testData\n      ",
      "output": {
        "failure": "invalid argument: found USING at 27:32 expected 'RESPECT', 'IGNORE', 'WITHIN', 'FILTER', 'OVER', '.', '[', '::', 'ESCAPE', 'IS', 'NOT', 'IN', '*', '/', '%', 'DIV', '+', '-', '||', '>>>', '>>', '<<', '&', '^', '|', '!=', '!>', '!<', '==', '=', '>=', '>', '<=>', '<=', '<>', '<', 'BETWEEN', 'LIKE', 'ILIKE', 'RLIKE', 'REGEXP', 'SIMILAR', 'AND', 'OR', 'AS', identifier, '(', ',', 'FROM', 'LATERAL', 'WHERE', 'GROUP', 'HAVING', 'INTERSECT', 'UNION', 'EXCEPT', 'MINUS', 'WINDOW', 'ORDER', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'LIMIT', 'OFFSET', ';', or end of input"
      }
    },
    {
      "input": "\nSELECT key, time\nFROM\n(\n    SELECT key, time\n    FROM\n    testData\n    WATERMARK timestamp_seconds(ts) AS time DELAY OF INTERVAL 10 seconds\n)\nAS tbl\nWHERE key = 'a'\n",
      "output": {
        "failure": "invalid argument: found timestamp_seconds at 82:99 expected '(', 'NATURAL', 'INNER', 'CROSS', 'OUTER', 'SEMI', 'ANTI', 'LEFT', 'RIGHT', 'FULL', 'JOIN', ',', 'LATERAL', 'WHERE', 'GROUP', 'HAVING', 'INTERSECT', 'UNION', 'EXCEPT', 'MINUS', 'WINDOW', 'ORDER', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'LIMIT', 'OFFSET', or ')'"
      }
    },
    {
      "input": "SELECT * FROM (INSERT INTO BAR VALUES (2))",
      "exception": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'BAR': missing ')'. SQLSTATE: 42601 (line 1, pos 27)\n\n== SQL ==\nSELECT * FROM (INSERT INTO BAR VALUES (2))\n---------------------------^^^\n",
      "output": {
        "failure": "invalid argument: found INTO at 22:26 expected '.', '(', 'FOR', 'SYSTEM_VERSION', 'VERSION', 'SYSTEM_TIME', 'TIMESTAMP', 'TABLESAMPLE', 'PIVOT', 'UNPIVOT', 'AS', identifier, 'NATURAL', 'INNER', 'CROSS', 'OUTER', 'SEMI', 'ANTI', 'LEFT', 'RIGHT', 'FULL', 'JOIN', or ')'"
      }
    },
    {
      "input": "SELECT * FROM (SELECT a AS x, b AS y FROM t) t(col1, col2)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "tableAlias": {
                  "input": {
                    "project": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "expressions": [
                        {
                          "alias": {
                            "expr": {
                              "unresolvedAttribute": {
                                "name": [
                                  "a"
                                ],
                                "planId": null,
                                "isMetadataColumn": false
                              }
                            },
                            "name": [
                              "x"
                            ],
                            "metadata": null
                          }
                        },
                        {
                          "alias": {
                            "expr": {
                              "unresolvedAttribute": {
                                "name": [
                                  "b"
                                ],
                                "planId": null,
                                "isMetadataColumn": false
                              }
                            },
                            "name": [
                              "y"
                            ],
                            "metadata": null
                          }
                        }
                      ]
                    },
                    "planId": null
                  },
                  "name": "t",
                  "columns": [
                    "col1",
                    "col2"
                  ]
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM S WHERE C1 IN (INSERT INTO T VALUES (2))",
      "exception": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'IN'. SQLSTATE: 42601 (line 1, pos 25)\n\n== SQL ==\nSELECT * FROM S WHERE C1 IN (INSERT INTO T VALUES (2))\n-------------------------^^^\n",
      "output": {
        "failure": "invalid argument: found INTO at 36:40 expected '->', '.', '(', '[', '::', 'ESCAPE', 'IS', 'NOT', 'IN', '*', '/', '%', 'DIV', '+', '-', '||', '>>>', '>>', '<<', '&', '^', '|', '!=', '!>', '!<', '==', '=', '>=', '>', '<=>', '<=', '<>', '<', 'BETWEEN', 'LIKE', 'ILIKE', 'RLIKE', 'REGEXP', 'SIMILAR', 'AND', 'OR', ',', or ')'"
      }
    },
    {
      "input": "SELECT * FROM a",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a"
                    ],
                    "temporal": null,
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a LIMIT 10",
      "output": {
        "success": {
          "query": {
            "limit": {
              "input": {
                "project": {
                  "input": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "a"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "expressions": [
                    {
                      "unresolvedStar": {
                        "target": null,
                        "planId": null,
                        "wildcardOptions": {
                          "ilikePattern": null,
                          "excludeColumns": null,
                          "exceptColumns": null,
                          "replaceColumns": null,
                          "renameColumns": null
                        }
                      }
                    }
                  ]
                },
                "planId": null
              },
              "skip": null,
              "limit": {
                "literal": {
                  "int32": {
                    "value": 10
                  }
                }
              }
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c FOR SYSTEM_TIME AS OF '2019-01-29 00:37:58'",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "timestamp": {
                        "value": {
                          "literal": {
                            "utf8": {
                              "value": "2019-01-29 00:37:58"
                            }
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c FOR SYSTEM_TIME AS OF (SELECT current_date())",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "timestamp": {
                        "value": {
                          "scalarSubquery": {
                            "subquery": {
                              "project": {
                                "input": {
                                  "empty": {
                                    "produceOneRow": true
                                  },
                                  "planId": null
                                },
                                "expressions": [
                                  {
                                    "unresolvedFunction": {
                                      "functionName": [
                                        "current_date"
                                      ],
                                      "arguments": [],
                                      "namedArguments": [],
                                      "isDistinct": false,
                                      "isUserDefinedFunction": false,
                                      "isInternal": null,
                                      "ignoreNulls": null,
                                      "filter": null,
                                      "orderBy": null
                                    }
                                  }
                                ]
                              },
                              "planId": null
                            }
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c FOR SYSTEM_TIME AS OF current_date()",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "timestamp": {
                        "value": {
                          "unresolvedFunction": {
                            "functionName": [
                              "current_date"
                            ],
                            "arguments": [],
                            "namedArguments": [],
                            "isDistinct": false,
                            "isUserDefinedFunction": false,
                            "isInternal": null,
                            "ignoreNulls": null,
                            "filter": null,
                            "orderBy": null
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c FOR SYSTEM_VERSION AS OF 'Snapshot123456789'",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "version": {
                        "value": {
                          "literal": {
                            "utf8": {
                              "value": "Snapshot123456789"
                            }
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c FOR SYSTEM_VERSION AS OF 123456789",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "version": {
                        "value": {
                          "literal": {
                            "int32": {
                              "value": 123456789
                            }
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c FOR TIMESTAMP AS OF '2019-01-29 00:37:58'",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "timestamp": {
                        "value": {
                          "literal": {
                            "utf8": {
                              "value": "2019-01-29 00:37:58"
                            }
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c FOR TIMESTAMP AS OF (SELECT current_date())",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "timestamp": {
                        "value": {
                          "scalarSubquery": {
                            "subquery": {
                              "project": {
                                "input": {
                                  "empty": {
                                    "produceOneRow": true
                                  },
                                  "planId": null
                                },
                                "expressions": [
                                  {
                                    "unresolvedFunction": {
                                      "functionName": [
                                        "current_date"
                                      ],
                                      "arguments": [],
                                      "namedArguments": [],
                                      "isDistinct": false,
                                      "isUserDefinedFunction": false,
                                      "isInternal": null,
                                      "ignoreNulls": null,
                                      "filter": null,
                                      "orderBy": null
                                    }
                                  }
                                ]
                              },
                              "planId": null
                            }
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c FOR TIMESTAMP AS OF current_date()",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "timestamp": {
                        "value": {
                          "unresolvedFunction": {
                            "functionName": [
                              "current_date"
                            ],
                            "arguments": [],
                            "namedArguments": [],
                            "isDistinct": false,
                            "isUserDefinedFunction": false,
                            "isInternal": null,
                            "ignoreNulls": null,
                            "filter": null,
                            "orderBy": null
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c FOR VERSION AS OF 'Snapshot123456789'",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "version": {
                        "value": {
                          "literal": {
                            "utf8": {
                              "value": "Snapshot123456789"
                            }
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c FOR VERSION AS OF 123456789",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "version": {
                        "value": {
                          "literal": {
                            "int32": {
                              "value": 123456789
                            }
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c SYSTEM_TIME AS OF '2019-01-29 00:37:58'",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "timestamp": {
                        "value": {
                          "literal": {
                            "utf8": {
                              "value": "2019-01-29 00:37:58"
                            }
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c SYSTEM_TIME AS OF (SELECT current_date())",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "timestamp": {
                        "value": {
                          "scalarSubquery": {
                            "subquery": {
                              "project": {
                                "input": {
                                  "empty": {
                                    "produceOneRow": true
                                  },
                                  "planId": null
                                },
                                "expressions": [
                                  {
                                    "unresolvedFunction": {
                                      "functionName": [
                                        "current_date"
                                      ],
                                      "arguments": [],
                                      "namedArguments": [],
                                      "isDistinct": false,
                                      "isUserDefinedFunction": false,
                                      "isInternal": null,
                                      "ignoreNulls": null,
                                      "filter": null,
                                      "orderBy": null
                                    }
                                  }
                                ]
                              },
                              "planId": null
                            }
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c SYSTEM_TIME AS OF current_date()",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "timestamp": {
                        "value": {
                          "unresolvedFunction": {
                            "functionName": [
                              "current_date"
                            ],
                            "arguments": [],
                            "namedArguments": [],
                            "isDistinct": false,
                            "isUserDefinedFunction": false,
                            "isInternal": null,
                            "ignoreNulls": null,
                            "filter": null,
                            "orderBy": null
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c SYSTEM_VERSION AS OF 'Snapshot123456789'",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "version": {
                        "value": {
                          "literal": {
                            "utf8": {
                              "value": "Snapshot123456789"
                            }
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c SYSTEM_VERSION AS OF 123456789",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "version": {
                        "value": {
                          "literal": {
                            "int32": {
                              "value": 123456789
                            }
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c TIMESTAMP AS OF '2019-01-29 00:37:58'",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "timestamp": {
                        "value": {
                          "literal": {
                            "utf8": {
                              "value": "2019-01-29 00:37:58"
                            }
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c TIMESTAMP AS OF (SELECT current_date())",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "timestamp": {
                        "value": {
                          "scalarSubquery": {
                            "subquery": {
                              "project": {
                                "input": {
                                  "empty": {
                                    "produceOneRow": true
                                  },
                                  "planId": null
                                },
                                "expressions": [
                                  {
                                    "unresolvedFunction": {
                                      "functionName": [
                                        "current_date"
                                      ],
                                      "arguments": [],
                                      "namedArguments": [],
                                      "isDistinct": false,
                                      "isUserDefinedFunction": false,
                                      "isInternal": null,
                                      "ignoreNulls": null,
                                      "filter": null,
                                      "orderBy": null
                                    }
                                  }
                                ]
                              },
                              "planId": null
                            }
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c TIMESTAMP AS OF col",
      "exception": "\nInvalid time travel spec: timestamp expression cannot refer to any columns.\n== SQL (line 1, position 21) ==\nSELECT * FROM a.b.c TIMESTAMP AS OF col\n                    ^^^^^^^^^^^^^^^^^^^\n",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "timestamp": {
                        "value": {
                          "unresolvedAttribute": {
                            "name": [
                              "col"
                            ],
                            "planId": null,
                            "isMetadataColumn": false
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c TIMESTAMP AS OF current_date()",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "timestamp": {
                        "value": {
                          "unresolvedFunction": {
                            "functionName": [
                              "current_date"
                            ],
                            "arguments": [],
                            "namedArguments": [],
                            "isDistinct": false,
                            "isUserDefinedFunction": false,
                            "isInternal": null,
                            "ignoreNulls": null,
                            "filter": null,
                            "orderBy": null
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c VERSION AS OF 'Snapshot123456789'",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "version": {
                        "value": {
                          "literal": {
                            "utf8": {
                              "value": "Snapshot123456789"
                            }
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM a.b.c VERSION AS OF 123456789",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a",
                      "b",
                      "c"
                    ],
                    "temporal": {
                      "version": {
                        "value": {
                          "literal": {
                            "int32": {
                              "value": 123456789
                            }
                          }
                        }
                      }
                    },
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM parquet_t0 TABLESAMPLE(300M) s",
      "exception": "\nTABLESAMPLE(byteLengthLiteral) is not supported.\n== SQL (line 1, position 26) ==\nSELECT * FROM parquet_t0 TABLESAMPLE(300M) s\n                         ^^^^^^^^^^^^^^^^^\n",
      "output": {
        "failure": "invalid argument: found ) at 41:42 expected '->', '.', '(', '[', '::', 'ESCAPE', 'IS', 'NOT', 'IN', '*', '/', '%', 'DIV', '+', '-', '||', '>>>', '>>', '<<', '&', '^', '|', '!=', '!>', '!<', '==', '=', '>=', '>', '<=>', '<=', '<>', '<', 'BETWEEN', 'LIKE', 'ILIKE', 'RLIKE', 'REGEXP', 'SIMILAR', 'AND', 'OR', 'PERCENT', or 'ROWS'"
      }
    },
    {
      "input": "SELECT * FROM parquet_t0 TABLESAMPLE(BUCKET 3 OUT OF 32 ON rand()) s",
      "exception": "\nTABLESAMPLE(BUCKET x OUT OF y ON function) is not supported.\n== SQL (line 1, position 26) ==\nSELECT * FROM parquet_t0 TABLESAMPLE(BUCKET 3 OUT OF 32 ON rand()) s\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "output": {
        "failure": "invalid argument: found ON at 56:58 expected ')'"
      }
    },
    {
      "input": "SELECT * FROM range(10) AS t",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "tableAlias": {
                  "input": {
                    "read": {
                      "udtf": {
                        "name": [
                          "range"
                        ],
                        "arguments": [
                          {
                            "literal": {
                              "int32": {
                                "value": 10
                              }
                            }
                          }
                        ],
                        "namedArguments": [],
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "name": "t",
                  "columns": []
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM range(7) AS t(a)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "tableAlias": {
                  "input": {
                    "read": {
                      "udtf": {
                        "name": [
                          "range"
                        ],
                        "arguments": [
                          {
                            "literal": {
                              "int32": {
                                "value": 7
                              }
                            }
                          }
                        ],
                        "namedArguments": [],
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "name": "t",
                  "columns": [
                    "a"
                  ]
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM testData AS t(col1, col2)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "tableAlias": {
                  "input": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "testData"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "name": "t",
                  "columns": [
                    "col1",
                    "col2"
                  ]
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT * FROM testcat.db.tab",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "testcat",
                      "db",
                      "tab"
                    ],
                    "temporal": null,
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT 42",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "literal": {
                    "int32": {
                      "value": 42
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT OVERLAY('Spark SQL' PLACING 'ANSI ' FROM 7 FOR 0)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedFunction": {
                    "functionName": [
                      "overlay"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "utf8": {
                            "value": "Spark SQL"
                          }
                        }
                      },
                      {
                        "literal": {
                          "utf8": {
                            "value": "ANSI "
                          }
                        }
                      },
                      {
                        "literal": {
                          "int32": {
                            "value": 7
                          }
                        }
                      },
                      {
                        "literal": {
                          "int32": {
                            "value": 0
                          }
                        }
                      }
                    ],
                    "namedArguments": [],
                    "isDistinct": false,
                    "isUserDefinedFunction": false,
                    "isInternal": null,
                    "ignoreNulls": null,
                    "filter": null,
                    "orderBy": null
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT OVERLAY('Spark SQL' PLACING 'CORE' FROM 7)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedFunction": {
                    "functionName": [
                      "overlay"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "utf8": {
                            "value": "Spark SQL"
                          }
                        }
                      },
                      {
                        "literal": {
                          "utf8": {
                            "value": "CORE"
                          }
                        }
                      },
                      {
                        "literal": {
                          "int32": {
                            "value": 7
                          }
                        }
                      }
                    ],
                    "namedArguments": [],
                    "isDistinct": false,
                    "isUserDefinedFunction": false,
                    "isInternal": null,
                    "ignoreNulls": null,
                    "filter": null,
                    "orderBy": null
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT OVERLAY('Spark SQL' PLACING '_' FROM 6)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedFunction": {
                    "functionName": [
                      "overlay"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "utf8": {
                            "value": "Spark SQL"
                          }
                        }
                      },
                      {
                        "literal": {
                          "utf8": {
                            "value": "_"
                          }
                        }
                      },
                      {
                        "literal": {
                          "int32": {
                            "value": 6
                          }
                        }
                      }
                    ],
                    "namedArguments": [],
                    "isDistinct": false,
                    "isUserDefinedFunction": false,
                    "isInternal": null,
                    "ignoreNulls": null,
                    "filter": null,
                    "orderBy": null
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT OVERLAY('Spark SQL' PLACING 'tructured' FROM 2 FOR 4)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedFunction": {
                    "functionName": [
                      "overlay"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "utf8": {
                            "value": "Spark SQL"
                          }
                        }
                      },
                      {
                        "literal": {
                          "utf8": {
                            "value": "tructured"
                          }
                        }
                      },
                      {
                        "literal": {
                          "int32": {
                            "value": 2
                          }
                        }
                      },
                      {
                        "literal": {
                          "int32": {
                            "value": 4
                          }
                        }
                      }
                    ],
                    "namedArguments": [],
                    "isDistinct": false,
                    "isUserDefinedFunction": false,
                    "isInternal": null,
                    "ignoreNulls": null,
                    "filter": null,
                    "orderBy": null
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT TRANSFORM(a, b, c)\n  ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'\n  WITH SERDEPROPERTIES(\n    \"separatorChar\" = \"\\t\",\n    \"quoteChar\" = \"'\",\n    \"escapeChar\" = \"\\\\\")\n  USING 'cat' AS (a, b, c)\n  ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'\n  WITH SERDEPROPERTIES(\n    \"separatorChar\" = \"\\t\",\n    \"quoteChar\" = \"'\",\n    \"escapeChar\" = \"\\\\\")\nFROM testData",
      "exception": "\n[UNSUPPORTED_FEATURE.TRANSFORM_NON_HIVE] The feature is not supported: TRANSFORM with SERDE is only supported in hive mode. SQLSTATE: 0A000\n== SQL (line 1, position 1) ==\nSELECT TRANSFORM(a, b, c)\n^^^^^^^^^^^^^^^^^^^^^^^^^\n  ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  WITH SERDEPROPERTIES(\n^^^^^^^^^^^^^^^^^^^^^^^\n    \"separatorChar\" = \"\\t\",\n^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    \"quoteChar\" = \"'\",\n^^^^^^^^^^^^^^^^^^^^^^\n    \"escapeChar\" = \"\\\\\")\n^^^^^^^^^^^^^^^^^^^^^^^^\n  USING 'cat' AS (a, b, c)\n^^^^^^^^^^^^^^^^^^^^^^^^^^\n  ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  WITH SERDEPROPERTIES(\n^^^^^^^^^^^^^^^^^^^^^^^\n    \"separatorChar\" = \"\\t\",\n^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    \"quoteChar\" = \"'\",\n^^^^^^^^^^^^^^^^^^^^^^\n    \"escapeChar\" = \"\\\\\")\n^^^^^^^^^^^^^^^^^^^^^^^^\nFROM testData\n^^^^^^^^^^^^^\n",
      "output": {
        "failure": "invalid argument: found FORMAT at 32:38 expected ',', 'FROM', 'LATERAL', 'WHERE', 'GROUP', 'HAVING', 'INTERSECT', 'UNION', 'EXCEPT', 'MINUS', 'WINDOW', 'ORDER', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'LIMIT', 'OFFSET', ';', or end of input"
      }
    },
    {
      "input": "SELECT TRIM('xyz' FROM 'yxTomxx')",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedFunction": {
                    "functionName": [
                      "trim"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "utf8": {
                            "value": "yxTomxx"
                          }
                        }
                      },
                      {
                        "literal": {
                          "utf8": {
                            "value": "xyz"
                          }
                        }
                      }
                    ],
                    "namedArguments": [],
                    "isDistinct": false,
                    "isUserDefinedFunction": false,
                    "isInternal": null,
                    "ignoreNulls": null,
                    "filter": null,
                    "orderBy": null
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT TRIM(BOTH '@$%&( )abc' FROM '@ $ % & ()abc ' )",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedFunction": {
                    "functionName": [
                      "trim"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "utf8": {
                            "value": "@ $ % & ()abc "
                          }
                        }
                      },
                      {
                        "literal": {
                          "utf8": {
                            "value": "@$%&( )abc"
                          }
                        }
                      }
                    ],
                    "namedArguments": [],
                    "isDistinct": false,
                    "isUserDefinedFunction": false,
                    "isInternal": null,
                    "ignoreNulls": null,
                    "filter": null,
                    "orderBy": null
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT TRIM(BOTH FROM '  bunch o blanks  ')",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedFunction": {
                    "functionName": [
                      "trim"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "utf8": {
                            "value": "  bunch o blanks  "
                          }
                        }
                      }
                    ],
                    "namedArguments": [],
                    "isDistinct": false,
                    "isUserDefinedFunction": false,
                    "isInternal": null,
                    "ignoreNulls": null,
                    "filter": null,
                    "orderBy": null
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT TRIM(LEADING 'c []' FROM '[ ccccbcc ')",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedFunction": {
                    "functionName": [
                      "ltrim"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "utf8": {
                            "value": "[ ccccbcc "
                          }
                        }
                      },
                      {
                        "literal": {
                          "utf8": {
                            "value": "c []"
                          }
                        }
                      }
                    ],
                    "namedArguments": [],
                    "isDistinct": false,
                    "isUserDefinedFunction": false,
                    "isInternal": null,
                    "ignoreNulls": null,
                    "filter": null,
                    "orderBy": null
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT TRIM(LEADING FROM '  bunch o blanks  ')",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedFunction": {
                    "functionName": [
                      "ltrim"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "utf8": {
                            "value": "  bunch o blanks  "
                          }
                        }
                      }
                    ],
                    "namedArguments": [],
                    "isDistinct": false,
                    "isUserDefinedFunction": false,
                    "isInternal": null,
                    "ignoreNulls": null,
                    "filter": null,
                    "orderBy": null
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT TRIM(TRAILING 'c&^,.' FROM 'bc...,,,&&&ccc')",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedFunction": {
                    "functionName": [
                      "rtrim"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "utf8": {
                            "value": "bc...,,,&&&ccc"
                          }
                        }
                      },
                      {
                        "literal": {
                          "utf8": {
                            "value": "c&^,."
                          }
                        }
                      }
                    ],
                    "namedArguments": [],
                    "isDistinct": false,
                    "isUserDefinedFunction": false,
                    "isInternal": null,
                    "ignoreNulls": null,
                    "filter": null,
                    "orderBy": null
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT TRIM(TRAILING FROM '  bunch o blanks  ')",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedFunction": {
                    "functionName": [
                      "rtrim"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "utf8": {
                            "value": "  bunch o blanks  "
                          }
                        }
                      }
                    ],
                    "namedArguments": [],
                    "isDistinct": false,
                    "isUserDefinedFunction": false,
                    "isInternal": null,
                    "ignoreNulls": null,
                    "filter": null,
                    "orderBy": null
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT abs(123)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedFunction": {
                    "functionName": [
                      "abs"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "int32": {
                            "value": 123
                          }
                        }
                      }
                    ],
                    "namedArguments": [],
                    "isDistinct": false,
                    "isUserDefinedFunction": false,
                    "isInternal": null,
                    "ignoreNulls": null,
                    "filter": null,
                    "orderBy": null
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT interval FROM VALUES ('abc') AS tbl(interval);",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "tableAlias": {
                  "input": {
                    "values": [
                      [
                        {
                          "literal": {
                            "utf8": {
                              "value": "abc"
                            }
                          }
                        }
                      ]
                    ],
                    "planId": null
                  },
                  "name": "tbl",
                  "columns": [
                    "interval"
                  ]
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedAttribute": {
                    "name": [
                      "interval"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "SELECT t.col1, t.col2 FROM (SELECT a AS x, b AS y FROM t) t(col1, col2)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "tableAlias": {
                  "input": {
                    "project": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "expressions": [
                        {
                          "alias": {
                            "expr": {
                              "unresolvedAttribute": {
                                "name": [
                                  "a"
                                ],
                                "planId": null,
                                "isMetadataColumn": false
                              }
                            },
                            "name": [
                              "x"
                            ],
                            "metadata": null
                          }
                        },
                        {
                          "alias": {
                            "expr": {
                              "unresolvedAttribute": {
                                "name": [
                                  "b"
                                ],
                                "planId": null,
                                "isMetadataColumn": false
                              }
                            },
                            "name": [
                              "y"
                            ],
                            "metadata": null
                          }
                        }
                      ]
                    },
                    "planId": null
                  },
                  "name": "t",
                  "columns": [
                    "col1",
                    "col2"
                  ]
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedAttribute": {
                    "name": [
                      "t",
                      "col1"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                },
                {
                  "unresolvedAttribute": {
                    "name": [
                      "t",
                      "col2"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "sELEct * FroM a",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a"
                    ],
                    "temporal": null,
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select (select max(b) from s) ss from t",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "t"
                    ],
                    "temporal": null,
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "alias": {
                    "expr": {
                      "scalarSubquery": {
                        "subquery": {
                          "project": {
                            "input": {
                              "read": {
                                "namedTable": {
                                  "name": [
                                    "s"
                                  ],
                                  "temporal": null,
                                  "sample": null,
                                  "options": []
                                },
                                "isStreaming": false
                              },
                              "planId": null
                            },
                            "expressions": [
                              {
                                "unresolvedFunction": {
                                  "functionName": [
                                    "max"
                                  ],
                                  "arguments": [
                                    {
                                      "unresolvedAttribute": {
                                        "name": [
                                          "b"
                                        ],
                                        "planId": null,
                                        "isMetadataColumn": false
                                      }
                                    }
                                  ],
                                  "namedArguments": [],
                                  "isDistinct": false,
                                  "isUserDefinedFunction": false,
                                  "isInternal": null,
                                  "ignoreNulls": null,
                                  "filter": null,
                                  "orderBy": null
                                }
                              }
                            ]
                          },
                          "planId": null
                        }
                      }
                    },
                    "name": [
                      "ss"
                    ],
                    "metadata": null
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select *\nfrom t\nlateral view explode(x) expl\nlateral view outer json_tuple(x, y) jtup q, z",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "lateralView": {
                  "input": {
                    "lateralView": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "function": [
                        "explode"
                      ],
                      "arguments": [
                        {
                          "unresolvedAttribute": {
                            "name": [
                              "x"
                            ],
                            "planId": null,
                            "isMetadataColumn": false
                          }
                        }
                      ],
                      "namedArguments": [],
                      "tableAlias": [
                        "expl"
                      ],
                      "columnAliases": null,
                      "outer": false
                    },
                    "planId": null
                  },
                  "function": [
                    "json_tuple"
                  ],
                  "arguments": [
                    {
                      "unresolvedAttribute": {
                        "name": [
                          "x"
                        ],
                        "planId": null,
                        "isMetadataColumn": false
                      }
                    },
                    {
                      "unresolvedAttribute": {
                        "name": [
                          "y"
                        ],
                        "planId": null,
                        "isMetadataColumn": false
                      }
                    }
                  ],
                  "namedArguments": [],
                  "tableAlias": [
                    "jtup"
                  ],
                  "columnAliases": [
                    "q",
                    "z"
                  ],
                  "outer": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select *\nfrom t\nlateral view explode(x) expl\npivot (\n  sum(x)\n  FOR y IN ('a', 'b')\n)",
      "exception": "\n[NOT_ALLOWED_IN_FROM.LATERAL_WITH_PIVOT] Not allowed in the FROM clause: LATERAL together with PIVOT. SQLSTATE: 42601\n== SQL (line 2, position 1) ==\nfrom t\n^^^^^^\nlateral view explode(x) expl\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npivot (\n^^^^^^^\n  sum(x)\n^^^^^^^^\n  FOR y IN ('a', 'b')\n^^^^^^^^^^^^^^^^^^^^^\n)\n^\n",
      "output": {
        "failure": "invalid argument: found ( at 51:52 expected ',', 'LATERAL', 'WHERE', 'GROUP', 'HAVING', 'INTERSECT', 'UNION', 'EXCEPT', 'MINUS', 'WINDOW', 'ORDER', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'LIMIT', 'OFFSET', ';', or end of input"
      }
    },
    {
      "input": "select *\nfrom t\nlateral view explode(x) expl\npivot (\n  sum(x)\n  FOR y IN ('a', 'b')\n)\nunpivot (\n  val FOR y IN (x)\n)",
      "exception": "\n[NOT_ALLOWED_IN_FROM.UNPIVOT_WITH_PIVOT] Not allowed in the FROM clause: UNPIVOT together with PIVOT. SQLSTATE: 42601\n== SQL (line 2, position 1) ==\nfrom t\n^^^^^^\nlateral view explode(x) expl\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^\npivot (\n^^^^^^^\n  sum(x)\n^^^^^^^^\n  FOR y IN ('a', 'b')\n^^^^^^^^^^^^^^^^^^^^^\n)\n^\nunpivot (\n^^^^^^^^^\n  val FOR y IN (x)\n^^^^^^^^^^^^^^^^^^\n)\n^\n",
      "output": {
        "failure": "invalid argument: found ( at 51:52 expected ',', 'LATERAL', 'WHERE', 'GROUP', 'HAVING', 'INTERSECT', 'UNION', 'EXCEPT', 'MINUS', 'WINDOW', 'ORDER', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'LIMIT', 'OFFSET', ';', or end of input"
      }
    },
    {
      "input": "select *\nfrom t\nlateral view explode(x) expl\nunpivot (\n  val FOR y IN (x)\n)",
      "exception": "\n[NOT_ALLOWED_IN_FROM.LATERAL_WITH_UNPIVOT] Not allowed in the FROM clause: LATERAL together with UNPIVOT. SQLSTATE: 42601\n== SQL (line 2, position 1) ==\nfrom t\n^^^^^^\nlateral view explode(x) expl\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nunpivot (\n^^^^^^^^^\n  val FOR y IN (x)\n^^^^^^^^^^^^^^^^^^\n)\n^\n",
      "output": {
        "failure": "invalid argument: found ( at 53:54 expected ',', 'LATERAL', 'WHERE', 'GROUP', 'HAVING', 'INTERSECT', 'UNION', 'EXCEPT', 'MINUS', 'WINDOW', 'ORDER', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'LIMIT', 'OFFSET', ';', or end of input"
      }
    },
    {
      "input": "select * fRoM a",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "a"
                    ],
                    "temporal": null,
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from (from a select * select *)",
      "output": {
        "failure": "invalid argument: found select at 22:28 expected '(', 'NATURAL', 'INNER', 'CROSS', 'OUTER', 'SEMI', 'ANTI', 'LEFT', 'RIGHT', 'FULL', 'JOIN', or ')'"
      }
    },
    {
      "input": "select * from a, lateral (select * from b) bb, lateral (select * from c) cc",
      "output": {
        "failure": "invalid argument: expected function for lateral table factor"
      }
    },
    {
      "input": "select * from default.range(2)",
      "exception": "\n[INVALID_SQL_SYNTAX.INVALID_TABLE_VALUED_FUNC_NAME] Invalid SQL syntax: Table valued function cannot specify database name: `default`.`range`. SQLSTATE: 42000\n== SQL (line 1, position 15) ==\nselect * from default.range(2)\n              ^^^^^^^^^^^^^^^^\n",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "udtf": {
                    "name": [
                      "default",
                      "range"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "int32": {
                            "value": 2
                          }
                        }
                      }
                    ],
                    "namedArguments": [],
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from my_tvf(2, arg1 => 'value1', arg2 => true)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "udtf": {
                    "name": [
                      "my_tvf"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "int32": {
                            "value": 2
                          }
                        }
                      }
                    ],
                    "namedArguments": [
                      [
                        "arg1",
                        {
                          "literal": {
                            "utf8": {
                              "value": "value1"
                            }
                          }
                        }
                      ],
                      [
                        "arg2",
                        {
                          "literal": {
                            "boolean": {
                              "value": true
                            }
                          }
                        }
                      ]
                    ],
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from my_tvf(2, table (v1), arg1 => table (select 1))",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "udtf": {
                    "name": [
                      "my_tvf"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "int32": {
                            "value": 2
                          }
                        }
                      },
                      {
                        "table": {
                          "expr": {
                            "unresolvedAttribute": {
                              "name": [
                                "v1"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        }
                      }
                    ],
                    "namedArguments": [
                      [
                        "arg1",
                        {
                          "table": {
                            "expr": {
                              "scalarSubquery": {
                                "subquery": {
                                  "project": {
                                    "input": {
                                      "empty": {
                                        "produceOneRow": true
                                      },
                                      "planId": null
                                    },
                                    "expressions": [
                                      {
                                        "literal": {
                                          "int32": {
                                            "value": 1
                                          }
                                        }
                                      }
                                    ]
                                  },
                                  "planId": null
                                }
                              }
                            }
                          }
                        }
                      ]
                    ],
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from my_tvf(arg1 => 'value1', 2, arg2 => true)",
      "output": {
        "failure": "invalid argument: positional argument after named argument"
      }
    },
    {
      "input": "select * from my_tvf(arg1 => 'value1', arg2 => true)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "udtf": {
                    "name": [
                      "my_tvf"
                    ],
                    "arguments": [],
                    "namedArguments": [
                      [
                        "arg1",
                        {
                          "literal": {
                            "utf8": {
                              "value": "value1"
                            }
                          }
                        }
                      ],
                      [
                        "arg2",
                        {
                          "literal": {
                            "boolean": {
                              "value": true
                            }
                          }
                        }
                      ]
                    ],
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from my_tvf(arg1 => table (v1), 2, arg2 => true)",
      "output": {
        "failure": "invalid argument: positional argument after named argument"
      }
    },
    {
      "input": "select * from my_tvf(arg1 => table (v1), arg2 => table (select 1))",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "udtf": {
                    "name": [
                      "my_tvf"
                    ],
                    "arguments": [],
                    "namedArguments": [
                      [
                        "arg1",
                        {
                          "table": {
                            "expr": {
                              "unresolvedAttribute": {
                                "name": [
                                  "v1"
                                ],
                                "planId": null,
                                "isMetadataColumn": false
                              }
                            }
                          }
                        }
                      ],
                      [
                        "arg2",
                        {
                          "table": {
                            "expr": {
                              "scalarSubquery": {
                                "subquery": {
                                  "project": {
                                    "input": {
                                      "empty": {
                                        "produceOneRow": true
                                      },
                                      "planId": null
                                    },
                                    "expressions": [
                                      {
                                        "literal": {
                                          "int32": {
                                            "value": 1
                                          }
                                        }
                                      }
                                    ]
                                  },
                                  "planId": null
                                }
                              }
                            }
                          }
                        }
                      ]
                    ],
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from my_tvf(arg1 => table v1)",
      "exception": "\n[INVALID_SQL_SYNTAX.INVALID_TABLE_FUNCTION_IDENTIFIER_ARGUMENT_MISSING_PARENTHESES] Invalid SQL syntax: Syntax error: call to table-valued function is invalid because parentheses are missing around the provided TABLE argument `v1`; please surround this with parentheses and try again. SQLSTATE: 42000\n== SQL (line 1, position 30) ==\nselect * from my_tvf(arg1 => table v1)\n                             ^^^^^^^^\n",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "udtf": {
                    "name": [
                      "my_tvf"
                    ],
                    "arguments": [],
                    "namedArguments": [
                      [
                        "arg1",
                        {
                          "table": {
                            "expr": {
                              "unresolvedAttribute": {
                                "name": [
                                  "v1"
                                ],
                                "planId": null,
                                "isMetadataColumn": false
                              }
                            }
                          }
                        }
                      ]
                    ],
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from my_tvf(arg1 => table(1) partition by col1 with single partition)",
      "exception": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'partition'. SQLSTATE: 42601 (line 1, pos 38)\n\n== SQL ==\nselect * from my_tvf(arg1 => table(1) partition by col1 with single partition)\n--------------------------------------^^^\n",
      "output": {
        "failure": "invalid argument: found partition at 38:47 expected '.', '[', '::', 'ESCAPE', 'IS', 'NOT', 'IN', '*', '/', '%', 'DIV', '+', '-', '||', '>>>', '>>', '<<', '&', '^', '|', '!=', '!>', '!<', '==', '=', '>=', '>', '<=>', '<=', '<>', '<', 'BETWEEN', 'LIKE', 'ILIKE', 'RLIKE', 'REGEXP', 'SIMILAR', 'AND', 'OR', ',', or ')'"
      }
    },
    {
      "input": "select * from my_tvf(arg1 => table(v1) distribute by col1)",
      "output": {
        "failure": "invalid argument: found distribute at 39:49 expected '.', '[', '::', 'ESCAPE', 'IS', 'NOT', 'IN', '*', '/', '%', 'DIV', '+', '-', '||', '>>>', '>>', '<<', '&', '^', '|', '!=', '!>', '!<', '==', '=', '>=', '>', '<=>', '<=', '<>', '<', 'BETWEEN', 'LIKE', 'ILIKE', 'RLIKE', 'REGEXP', 'SIMILAR', 'AND', 'OR', ',', or ')'"
      }
    },
    {
      "input": "select * from my_tvf(arg1 => table(v1) partition by col1)",
      "output": {
        "failure": "invalid argument: found partition at 39:48 expected '.', '[', '::', 'ESCAPE', 'IS', 'NOT', 'IN', '*', '/', '%', 'DIV', '+', '-', '||', '>>>', '>>', '<<', '&', '^', '|', '!=', '!>', '!<', '==', '=', '>=', '>', '<=>', '<=', '<>', '<', 'BETWEEN', 'LIKE', 'ILIKE', 'RLIKE', 'REGEXP', 'SIMILAR', 'AND', 'OR', ',', or ')'"
      }
    },
    {
      "input": "select * from my_tvf(arg1 => table(v1) with single partition)",
      "output": {
        "failure": "invalid argument: found with at 39:43 expected '.', '[', '::', 'ESCAPE', 'IS', 'NOT', 'IN', '*', '/', '%', 'DIV', '+', '-', '||', '>>>', '>>', '<<', '&', '^', '|', '!=', '!>', '!<', '==', '=', '>=', '>', '<=>', '<=', '<>', '<', 'BETWEEN', 'LIKE', 'ILIKE', 'RLIKE', 'REGEXP', 'SIMILAR', 'AND', 'OR', ',', or ')'"
      }
    },
    {
      "input": "select * from my_tvf(group => 'abc')",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "udtf": {
                    "name": [
                      "my_tvf"
                    ],
                    "arguments": [],
                    "namedArguments": [
                      [
                        "group",
                        {
                          "literal": {
                            "utf8": {
                              "value": "abc"
                            }
                          }
                        }
                      ]
                    ],
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from my_tvf(table (v1), table (select 1))",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "udtf": {
                    "name": [
                      "my_tvf"
                    ],
                    "arguments": [
                      {
                        "table": {
                          "expr": {
                            "unresolvedAttribute": {
                              "name": [
                                "v1"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        }
                      },
                      {
                        "table": {
                          "expr": {
                            "scalarSubquery": {
                              "subquery": {
                                "project": {
                                  "input": {
                                    "empty": {
                                      "produceOneRow": true
                                    },
                                    "planId": null
                                  },
                                  "expressions": [
                                    {
                                      "literal": {
                                        "int32": {
                                          "value": 1
                                        }
                                      }
                                    }
                                  ]
                                },
                                "planId": null
                              }
                            }
                          }
                        }
                      }
                    ],
                    "namedArguments": [],
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from range(2)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "udtf": {
                    "name": [
                      "range"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "int32": {
                            "value": 2
                          }
                        }
                      }
                    ],
                    "namedArguments": [],
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from spark_catalog.default.range(2)",
      "exception": "\n[INVALID_SQL_SYNTAX.INVALID_TABLE_VALUED_FUNC_NAME] Invalid SQL syntax: Table valued function cannot specify database name: `spark_catalog`.`default`.`range`. SQLSTATE: 42000\n== SQL (line 1, position 15) ==\nselect * from spark_catalog.default.range(2)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "udtf": {
                    "name": [
                      "spark_catalog",
                      "default",
                      "range"
                    ],
                    "arguments": [
                      {
                        "literal": {
                          "int32": {
                            "value": 2
                          }
                        }
                      }
                    ],
                    "namedArguments": [],
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "t"
                    ],
                    "temporal": null,
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t , lateral (select * from u) uu",
      "output": {
        "failure": "invalid argument: expected function for lateral table factor"
      }
    },
    {
      "input": "select * from t as tt , u",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "cross",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t cluster by a distribute by a",
      "exception": "\n[UNSUPPORTED_FEATURE.COMBINATION_QUERY_RESULT_CLAUSES] The feature is not supported: Combination of ORDER BY/SORT BY/DISTRIBUTE BY/CLUSTER BY. SQLSTATE: 0A000\n== SQL (line 1, position 17) ==\nselect * from t cluster by a distribute by a\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "output": {
        "failure": "not implemented: CLUSTER BY"
      }
    },
    {
      "input": "select * from t lateral view explode(x) expl as x",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "lateralView": {
                  "input": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "function": [
                    "explode"
                  ],
                  "arguments": [
                    {
                      "unresolvedAttribute": {
                        "name": [
                          "x"
                        ],
                        "planId": null,
                        "isMetadataColumn": false
                      }
                    }
                  ],
                  "namedArguments": [],
                  "tableAlias": [
                    "expl"
                  ],
                  "columnAliases": [
                    "x"
                  ],
                  "outer": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t lateral view posexplode(x) posexpl as x, y",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "lateralView": {
                  "input": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "function": [
                    "posexplode"
                  ],
                  "arguments": [
                    {
                      "unresolvedAttribute": {
                        "name": [
                          "x"
                        ],
                        "planId": null,
                        "isMetadataColumn": false
                      }
                    }
                  ],
                  "namedArguments": [],
                  "tableAlias": [
                    "posexpl"
                  ],
                  "columnAliases": [
                    "x",
                    "y"
                  ],
                  "outer": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t limit 10",
      "output": {
        "success": {
          "query": {
            "limit": {
              "input": {
                "project": {
                  "input": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "expressions": [
                    {
                      "unresolvedStar": {
                        "target": null,
                        "planId": null,
                        "wildcardOptions": {
                          "ilikePattern": null,
                          "excludeColumns": null,
                          "exceptColumns": null,
                          "replaceColumns": null,
                          "renameColumns": null
                        }
                      }
                    }
                  ]
                },
                "planId": null
              },
              "skip": null,
              "limit": {
                "literal": {
                  "int32": {
                    "value": 10
                  }
                }
              }
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t limit cast(9 / 4 as int)",
      "output": {
        "success": {
          "query": {
            "limit": {
              "input": {
                "project": {
                  "input": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "expressions": [
                    {
                      "unresolvedStar": {
                        "target": null,
                        "planId": null,
                        "wildcardOptions": {
                          "ilikePattern": null,
                          "excludeColumns": null,
                          "exceptColumns": null,
                          "replaceColumns": null,
                          "renameColumns": null
                        }
                      }
                    }
                  ]
                },
                "planId": null
              },
              "skip": null,
              "limit": {
                "cast": {
                  "expr": {
                    "unresolvedFunction": {
                      "functionName": [
                        "/"
                      ],
                      "arguments": [
                        {
                          "literal": {
                            "int32": {
                              "value": 9
                            }
                          }
                        },
                        {
                          "literal": {
                            "int32": {
                              "value": 4
                            }
                          }
                        }
                      ],
                      "namedArguments": [],
                      "isDistinct": false,
                      "isUserDefinedFunction": false,
                      "isInternal": null,
                      "ignoreNulls": null,
                      "filter": null,
                      "orderBy": null
                    }
                  },
                  "castToType": "int32",
                  "rename": true,
                  "isTry": false
                }
              }
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t tablesample(100 rows)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "t"
                    ],
                    "temporal": null,
                    "sample": {
                      "method": {
                        "rows": {
                          "value": {
                            "literal": {
                              "int32": {
                                "value": 100
                              }
                            }
                          }
                        }
                      },
                      "seed": null
                    },
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t tablesample(43 percent) as x",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "tableAlias": {
                  "input": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": {
                          "method": {
                            "percent": {
                              "value": {
                                "literal": {
                                  "int32": {
                                    "value": 43
                                  }
                                }
                              }
                            }
                          },
                          "seed": null
                        },
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "name": "x",
                  "columns": []
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t tablesample(bucket 11 out of 10) as x",
      "exception": "\nSampling fraction (1.1) must be on interval [0, 1].\n== SQL (line 1, position 17) ==\nselect * from t tablesample(bucket 11 out of 10) as x\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "tableAlias": {
                  "input": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": {
                          "method": {
                            "bucket": {
                              "numerator": 11,
                              "denominator": 10
                            }
                          },
                          "seed": null
                        },
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "name": "x",
                  "columns": []
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t tablesample(bucket 4 out of 10 on x) as x",
      "exception": "\nTABLESAMPLE(BUCKET x OUT OF y ON colname) is not supported.\n== SQL (line 1, position 17) ==\nselect * from t tablesample(bucket 4 out of 10 on x) as x\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",
      "output": {
        "failure": "invalid argument: found on at 47:49 expected ')'"
      }
    },
    {
      "input": "select * from t tablesample(bucket 4 out of 10) as x",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "tableAlias": {
                  "input": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": {
                          "method": {
                            "bucket": {
                              "numerator": 4,
                              "denominator": 10
                            }
                          },
                          "seed": null
                        },
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "name": "x",
                  "columns": []
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t where a = (select b from s)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "filter": {
                  "input": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "condition": {
                    "unresolvedFunction": {
                      "functionName": [
                        "=="
                      ],
                      "arguments": [
                        {
                          "unresolvedAttribute": {
                            "name": [
                              "a"
                            ],
                            "planId": null,
                            "isMetadataColumn": false
                          }
                        },
                        {
                          "scalarSubquery": {
                            "subquery": {
                              "project": {
                                "input": {
                                  "read": {
                                    "namedTable": {
                                      "name": [
                                        "s"
                                      ],
                                      "temporal": null,
                                      "sample": null,
                                      "options": []
                                    },
                                    "isStreaming": false
                                  },
                                  "planId": null
                                },
                                "expressions": [
                                  {
                                    "unresolvedAttribute": {
                                      "name": [
                                        "b"
                                      ],
                                      "planId": null,
                                      "isMetadataColumn": false
                                    }
                                  }
                                ]
                              },
                              "planId": null
                            }
                          }
                        }
                      ],
                      "namedArguments": [],
                      "isDistinct": false,
                      "isUserDefinedFunction": false,
                      "isInternal": null,
                      "ignoreNulls": null,
                      "filter": null,
                      "orderBy": null
                    }
                  }
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t window w1 as ()",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "t"
                    ],
                    "temporal": null,
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t window w1 as () limit 10",
      "output": {
        "success": {
          "query": {
            "limit": {
              "input": {
                "project": {
                  "input": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "expressions": [
                    {
                      "unresolvedStar": {
                        "target": null,
                        "planId": null,
                        "wildcardOptions": {
                          "ilikePattern": null,
                          "excludeColumns": null,
                          "exceptColumns": null,
                          "replaceColumns": null,
                          "renameColumns": null
                        }
                      }
                    }
                  ]
                },
                "planId": null
              },
              "skip": null,
              "limit": {
                "literal": {
                  "int32": {
                    "value": 10
                  }
                }
              }
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select 1",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "literal": {
                    "int32": {
                      "value": 1
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select 1;",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "literal": {
                    "int32": {
                      "value": 1
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select a from 1k.2m",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "1k",
                      "2m"
                    ],
                    "temporal": null,
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedAttribute": {
                    "name": [
                      "a"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select a, b",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedAttribute": {
                    "name": [
                      "a"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                },
                {
                  "unresolvedAttribute": {
                    "name": [
                      "b"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select a, b from db.c",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "db",
                      "c"
                    ],
                    "temporal": null,
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedAttribute": {
                    "name": [
                      "a"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                },
                {
                  "unresolvedAttribute": {
                    "name": [
                      "b"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select a, b from db.c having x < 1",
      "output": {
        "success": {
          "query": {
            "aggregate": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "db",
                      "c"
                    ],
                    "temporal": null,
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "grouping": [],
              "aggregate": [
                {
                  "unresolvedAttribute": {
                    "name": [
                      "a"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                },
                {
                  "unresolvedAttribute": {
                    "name": [
                      "b"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                }
              ],
              "having": {
                "unresolvedFunction": {
                  "functionName": [
                    "<"
                  ],
                  "arguments": [
                    {
                      "unresolvedAttribute": {
                        "name": [
                          "x"
                        ],
                        "planId": null,
                        "isMetadataColumn": false
                      }
                    },
                    {
                      "literal": {
                        "int32": {
                          "value": 1
                        }
                      }
                    }
                  ],
                  "namedArguments": [],
                  "isDistinct": false,
                  "isUserDefinedFunction": false,
                  "isInternal": null,
                  "ignoreNulls": null,
                  "filter": null,
                  "orderBy": null
                }
              },
              "withGroupingExpressions": false
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select a, b from db.c where x !< 1",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "filter": {
                  "input": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "db",
                          "c"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "condition": {
                    "unresolvedFunction": {
                      "functionName": [
                        ">="
                      ],
                      "arguments": [
                        {
                          "unresolvedAttribute": {
                            "name": [
                              "x"
                            ],
                            "planId": null,
                            "isMetadataColumn": false
                          }
                        },
                        {
                          "literal": {
                            "int32": {
                              "value": 1
                            }
                          }
                        }
                      ],
                      "namedArguments": [],
                      "isDistinct": false,
                      "isUserDefinedFunction": false,
                      "isInternal": null,
                      "ignoreNulls": null,
                      "filter": null,
                      "orderBy": null
                    }
                  }
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedAttribute": {
                    "name": [
                      "a"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                },
                {
                  "unresolvedAttribute": {
                    "name": [
                      "b"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select a, b from db.c where x !> 1",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "filter": {
                  "input": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "db",
                          "c"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "condition": {
                    "unresolvedFunction": {
                      "functionName": [
                        "<="
                      ],
                      "arguments": [
                        {
                          "unresolvedAttribute": {
                            "name": [
                              "x"
                            ],
                            "planId": null,
                            "isMetadataColumn": false
                          }
                        },
                        {
                          "literal": {
                            "int32": {
                              "value": 1
                            }
                          }
                        }
                      ],
                      "namedArguments": [],
                      "isDistinct": false,
                      "isUserDefinedFunction": false,
                      "isInternal": null,
                      "ignoreNulls": null,
                      "filter": null,
                      "orderBy": null
                    }
                  }
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedAttribute": {
                    "name": [
                      "a"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                },
                {
                  "unresolvedAttribute": {
                    "name": [
                      "b"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select a, b from db.c where x < 1",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "filter": {
                  "input": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "db",
                          "c"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "condition": {
                    "unresolvedFunction": {
                      "functionName": [
                        "<"
                      ],
                      "arguments": [
                        {
                          "unresolvedAttribute": {
                            "name": [
                              "x"
                            ],
                            "planId": null,
                            "isMetadataColumn": false
                          }
                        },
                        {
                          "literal": {
                            "int32": {
                              "value": 1
                            }
                          }
                        }
                      ],
                      "namedArguments": [],
                      "isDistinct": false,
                      "isUserDefinedFunction": false,
                      "isInternal": null,
                      "ignoreNulls": null,
                      "filter": null,
                      "orderBy": null
                    }
                  }
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedAttribute": {
                    "name": [
                      "a"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                },
                {
                  "unresolvedAttribute": {
                    "name": [
                      "b"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select a, b from db.c; ;;  ;",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "db",
                      "c"
                    ],
                    "temporal": null,
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedAttribute": {
                    "name": [
                      "a"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                },
                {
                  "unresolvedAttribute": {
                    "name": [
                      "b"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select a, b from db.c;;;",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "db",
                      "c"
                    ],
                    "temporal": null,
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedAttribute": {
                    "name": [
                      "a"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                },
                {
                  "unresolvedAttribute": {
                    "name": [
                      "b"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select a, b;",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedAttribute": {
                    "name": [
                      "a"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                },
                {
                  "unresolvedAttribute": {
                    "name": [
                      "b"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select all a, b from db.c",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "db",
                      "c"
                    ],
                    "temporal": null,
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedAttribute": {
                    "name": [
                      "a"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                },
                {
                  "unresolvedAttribute": {
                    "name": [
                      "b"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select distinct a, b from db.c",
      "output": {
        "success": {
          "query": {
            "deduplicate": {
              "input": {
                "project": {
                  "input": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "db",
                          "c"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "expressions": [
                    {
                      "unresolvedAttribute": {
                        "name": [
                          "a"
                        ],
                        "planId": null,
                        "isMetadataColumn": false
                      }
                    },
                    {
                      "unresolvedAttribute": {
                        "name": [
                          "b"
                        ],
                        "planId": null,
                        "isMetadataColumn": false
                      }
                    }
                  ]
                },
                "planId": null
              },
              "columnNames": [],
              "allColumnsAsKeys": true,
              "withinWatermark": false
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select from tbl",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "empty": {
                  "produceOneRow": true
                },
                "planId": null
              },
              "expressions": [
                {
                  "alias": {
                    "expr": {
                      "unresolvedAttribute": {
                        "name": [
                          "from"
                        ],
                        "planId": null,
                        "isMetadataColumn": false
                      }
                    },
                    "name": [
                      "tbl"
                    ],
                    "metadata": null
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select id from ((((((t0))))))",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "t0"
                    ],
                    "temporal": null,
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedAttribute": {
                    "name": [
                      "id"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select id from (t0)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "read": {
                  "namedTable": {
                    "name": [
                      "t0"
                    ],
                    "temporal": null,
                    "sample": null,
                    "options": []
                  },
                  "isStreaming": false
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedAttribute": {
                    "name": [
                      "id"
                    ],
                    "planId": null,
                    "isMetadataColumn": false
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select ltrim(both 'S' from 'SS abc S'",
      "exception": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'from'. SQLSTATE: 42601 (line 1, pos 22)\n\n== SQL ==\nselect ltrim(both 'S' from 'SS abc S'\n----------------------^^^\n",
      "output": {
        "failure": "invalid argument: found 'S' at 18:21 expected '->', '.', '(', '[', '::', 'ESCAPE', 'IS', 'NOT', 'IN', '*', '/', '%', 'DIV', '+', '-', '||', '>>>', '>>', '<<', '&', '^', '|', '!=', '!>', '!<', '==', '=', '>=', '>', '<=>', '<=', '<>', '<', 'BETWEEN', 'LIKE', 'ILIKE', 'RLIKE', 'REGEXP', 'SIMILAR', 'AND', 'OR', '=>', ',', 'RESPECT', 'IGNORE', or ')'"
      }
    },
    {
      "input": "select rtrim(trailing 'S' from 'SS abc S'",
      "exception": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'from'. SQLSTATE: 42601 (line 1, pos 26)\n\n== SQL ==\nselect rtrim(trailing 'S' from 'SS abc S'\n--------------------------^^^\n",
      "output": {
        "failure": "invalid argument: found 'S' at 22:25 expected '->', '.', '(', '[', '::', 'ESCAPE', 'IS', 'NOT', 'IN', '*', '/', '%', 'DIV', '+', '-', '||', '>>>', '>>', '<<', '&', '^', '|', '!=', '!>', '!<', '==', '=', '>=', '>', '<=>', '<=', '<>', '<', 'BETWEEN', 'LIKE', 'ILIKE', 'RLIKE', 'REGEXP', 'SIMILAR', 'AND', 'OR', '=>', ',', 'RESPECT', 'IGNORE', or ')'"
      }
    }
  ]
}
