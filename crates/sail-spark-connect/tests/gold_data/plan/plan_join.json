{
  "tests": [
    {
      "input": "SELECT * FROM (src1 s1 INNER JOIN src2 s2 ON s1.id = s2.id) dst(a, b, c, d)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "tableAlias": {
                  "input": {
                    "join": {
                      "left": {
                        "tableAlias": {
                          "input": {
                            "read": {
                              "namedTable": {
                                "name": [
                                  "src1"
                                ],
                                "temporal": null,
                                "sample": null,
                                "options": []
                              },
                              "isStreaming": false
                            },
                            "planId": null
                          },
                          "name": "s1",
                          "columns": []
                        },
                        "planId": null
                      },
                      "right": {
                        "tableAlias": {
                          "input": {
                            "read": {
                              "namedTable": {
                                "name": [
                                  "src2"
                                ],
                                "temporal": null,
                                "sample": null,
                                "options": []
                              },
                              "isStreaming": false
                            },
                            "planId": null
                          },
                          "name": "s2",
                          "columns": []
                        },
                        "planId": null
                      },
                      "joinType": "inner",
                      "joinCriteria": {
                        "on": {
                          "unresolvedFunction": {
                            "functionName": [
                              "=="
                            ],
                            "arguments": [
                              {
                                "unresolvedAttribute": {
                                  "name": [
                                    "s1",
                                    "id"
                                  ],
                                  "planId": null,
                                  "isMetadataColumn": false
                                }
                              },
                              {
                                "unresolvedAttribute": {
                                  "name": [
                                    "s2",
                                    "id"
                                  ],
                                  "planId": null,
                                  "isMetadataColumn": false
                                }
                              }
                            ],
                            "namedArguments": [],
                            "isDistinct": false,
                            "isUserDefinedFunction": false,
                            "isInternal": null,
                            "ignoreNulls": null,
                            "filter": null,
                            "orderBy": null
                          }
                        }
                      },
                      "joinDataType": null
                    },
                    "planId": null
                  },
                  "name": "dst",
                  "columns": [
                    "a",
                    "b",
                    "c",
                    "d"
                  ]
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from a join b join c right join d",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "join": {
                      "left": {
                        "join": {
                          "left": {
                            "read": {
                              "namedTable": {
                                "name": [
                                  "a"
                                ],
                                "temporal": null,
                                "sample": null,
                                "options": []
                              },
                              "isStreaming": false
                            },
                            "planId": null
                          },
                          "right": {
                            "read": {
                              "namedTable": {
                                "name": [
                                  "b"
                                ],
                                "temporal": null,
                                "sample": null,
                                "options": []
                              },
                              "isStreaming": false
                            },
                            "planId": null
                          },
                          "joinType": "inner",
                          "joinCriteria": null,
                          "joinDataType": null
                        },
                        "planId": null
                      },
                      "right": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "c"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "joinType": "inner",
                      "joinCriteria": null,
                      "joinDataType": null
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "d"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "rightOuter",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from a natural cross join b",
      "exception": "\n[INCOMPATIBLE_JOIN_TYPES] The join types NATURAL and CROSS are incompatible. SQLSTATE: 42613\n== SQL (line 1, position 17) ==\nselect * from a natural cross join b\n                ^^^^^^^^^^^^^^^^^^^^\n",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "a"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "b"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "cross",
                  "joinCriteria": "natural",
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from a natural join b on a.id = b.id",
      "exception": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'on'. SQLSTATE: 42601 (line 1, pos 31)\n\n== SQL ==\nselect * from a natural join b on a.id = b.id\n-------------------------------^^^\n",
      "output": {
        "failure": "invalid argument: NATURAL JOIN with criteria"
      }
    },
    {
      "input": "select * from t anti join u as uu on a = b",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "leftAnti",
                  "joinCriteria": {
                    "on": {
                      "unresolvedFunction": {
                        "functionName": [
                          "=="
                        ],
                        "arguments": [
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "a"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          },
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "b"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        ],
                        "namedArguments": [],
                        "isDistinct": false,
                        "isUserDefinedFunction": false,
                        "isInternal": null,
                        "ignoreNulls": null,
                        "filter": null,
                        "orderBy": null
                      }
                    }
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t anti join u using(a, b)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "leftAnti",
                  "joinCriteria": {
                    "using": [
                      "a",
                      "b"
                    ]
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t as tt anti join u",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "leftAnti",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t as tt cross join u",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "cross",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t as tt full join u",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "fullOuter",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t as tt full outer join u",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "fullOuter",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t as tt inner join u",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "inner",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t as tt join u",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "inner",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t as tt left anti join u",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "leftAnti",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t as tt left join u",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "leftOuter",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t as tt left outer join u",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "leftOuter",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t as tt left semi join u",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "leftSemi",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t as tt right join u",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "rightOuter",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t as tt right outer join u",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "rightOuter",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t as tt semi join u",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "leftSemi",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t cross join lateral (select * from u) uu",
      "output": {
        "failure": "invalid argument: expected function for lateral table factor"
      }
    },
    {
      "input": "select * from t full join u as uu on a = b",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "fullOuter",
                  "joinCriteria": {
                    "on": {
                      "unresolvedFunction": {
                        "functionName": [
                          "=="
                        ],
                        "arguments": [
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "a"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          },
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "b"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        ],
                        "namedArguments": [],
                        "isDistinct": false,
                        "isUserDefinedFunction": false,
                        "isInternal": null,
                        "ignoreNulls": null,
                        "filter": null,
                        "orderBy": null
                      }
                    }
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t full join u using(a, b)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "fullOuter",
                  "joinCriteria": {
                    "using": [
                      "a",
                      "b"
                    ]
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t full outer join u as uu on a = b",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "fullOuter",
                  "joinCriteria": {
                    "on": {
                      "unresolvedFunction": {
                        "functionName": [
                          "=="
                        ],
                        "arguments": [
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "a"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          },
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "b"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        ],
                        "namedArguments": [],
                        "isDistinct": false,
                        "isUserDefinedFunction": false,
                        "isInternal": null,
                        "ignoreNulls": null,
                        "filter": null,
                        "orderBy": null
                      }
                    }
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t full outer join u using(a, b)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "fullOuter",
                  "joinCriteria": {
                    "using": [
                      "a",
                      "b"
                    ]
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t inner join lateral (select * from u) uu",
      "output": {
        "failure": "invalid argument: expected function for lateral table factor"
      }
    },
    {
      "input": "select * from t inner join u as uu on a = b",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "inner",
                  "joinCriteria": {
                    "on": {
                      "unresolvedFunction": {
                        "functionName": [
                          "=="
                        ],
                        "arguments": [
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "a"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          },
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "b"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        ],
                        "namedArguments": [],
                        "isDistinct": false,
                        "isUserDefinedFunction": false,
                        "isInternal": null,
                        "ignoreNulls": null,
                        "filter": null,
                        "orderBy": null
                      }
                    }
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t inner join u using(a, b)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "inner",
                  "joinCriteria": {
                    "using": [
                      "a",
                      "b"
                    ]
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t join lateral (select * from u) uu",
      "output": {
        "failure": "invalid argument: expected function for lateral table factor"
      }
    },
    {
      "input": "select * from t join lateral (select * from u) uu on true",
      "output": {
        "failure": "not supported: LATERAL JOIN with criteria"
      }
    },
    {
      "input": "select * from t join u as uu on a = b",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "inner",
                  "joinCriteria": {
                    "on": {
                      "unresolvedFunction": {
                        "functionName": [
                          "=="
                        ],
                        "arguments": [
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "a"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          },
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "b"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        ],
                        "namedArguments": [],
                        "isDistinct": false,
                        "isUserDefinedFunction": false,
                        "isInternal": null,
                        "ignoreNulls": null,
                        "filter": null,
                        "orderBy": null
                      }
                    }
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t join u using(a, b)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "inner",
                  "joinCriteria": {
                    "using": [
                      "a",
                      "b"
                    ]
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t left anti join u as uu on a = b",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "leftAnti",
                  "joinCriteria": {
                    "on": {
                      "unresolvedFunction": {
                        "functionName": [
                          "=="
                        ],
                        "arguments": [
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "a"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          },
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "b"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        ],
                        "namedArguments": [],
                        "isDistinct": false,
                        "isUserDefinedFunction": false,
                        "isInternal": null,
                        "ignoreNulls": null,
                        "filter": null,
                        "orderBy": null
                      }
                    }
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t left anti join u using(a, b)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "leftAnti",
                  "joinCriteria": {
                    "using": [
                      "a",
                      "b"
                    ]
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t left join lateral (select * from u) uu",
      "output": {
        "failure": "invalid argument: expected function for lateral table factor"
      }
    },
    {
      "input": "select * from t left join u as uu on a = b",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "leftOuter",
                  "joinCriteria": {
                    "on": {
                      "unresolvedFunction": {
                        "functionName": [
                          "=="
                        ],
                        "arguments": [
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "a"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          },
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "b"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        ],
                        "namedArguments": [],
                        "isDistinct": false,
                        "isUserDefinedFunction": false,
                        "isInternal": null,
                        "ignoreNulls": null,
                        "filter": null,
                        "orderBy": null
                      }
                    }
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t left join u using(a, b)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "leftOuter",
                  "joinCriteria": {
                    "using": [
                      "a",
                      "b"
                    ]
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t left outer join lateral (select * from u) uu",
      "output": {
        "failure": "invalid argument: expected function for lateral table factor"
      }
    },
    {
      "input": "select * from t left outer join u as uu on a = b",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "leftOuter",
                  "joinCriteria": {
                    "on": {
                      "unresolvedFunction": {
                        "functionName": [
                          "=="
                        ],
                        "arguments": [
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "a"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          },
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "b"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        ],
                        "namedArguments": [],
                        "isDistinct": false,
                        "isUserDefinedFunction": false,
                        "isInternal": null,
                        "ignoreNulls": null,
                        "filter": null,
                        "orderBy": null
                      }
                    }
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t left outer join u using(a, b)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "leftOuter",
                  "joinCriteria": {
                    "using": [
                      "a",
                      "b"
                    ]
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t left semi join u as uu on a = b",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "leftSemi",
                  "joinCriteria": {
                    "on": {
                      "unresolvedFunction": {
                        "functionName": [
                          "=="
                        ],
                        "arguments": [
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "a"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          },
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "b"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        ],
                        "namedArguments": [],
                        "isDistinct": false,
                        "isUserDefinedFunction": false,
                        "isInternal": null,
                        "ignoreNulls": null,
                        "filter": null,
                        "orderBy": null
                      }
                    }
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t left semi join u using(a, b)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "leftSemi",
                  "joinCriteria": {
                    "using": [
                      "a",
                      "b"
                    ]
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t right join u as uu on a = b",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "rightOuter",
                  "joinCriteria": {
                    "on": {
                      "unresolvedFunction": {
                        "functionName": [
                          "=="
                        ],
                        "arguments": [
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "a"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          },
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "b"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        ],
                        "namedArguments": [],
                        "isDistinct": false,
                        "isUserDefinedFunction": false,
                        "isInternal": null,
                        "ignoreNulls": null,
                        "filter": null,
                        "orderBy": null
                      }
                    }
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t right join u using(a, b)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "rightOuter",
                  "joinCriteria": {
                    "using": [
                      "a",
                      "b"
                    ]
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t right outer join u as uu on a = b",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "rightOuter",
                  "joinCriteria": {
                    "on": {
                      "unresolvedFunction": {
                        "functionName": [
                          "=="
                        ],
                        "arguments": [
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "a"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          },
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "b"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        ],
                        "namedArguments": [],
                        "isDistinct": false,
                        "isUserDefinedFunction": false,
                        "isInternal": null,
                        "ignoreNulls": null,
                        "filter": null,
                        "orderBy": null
                      }
                    }
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t right outer join u using(a, b)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "rightOuter",
                  "joinCriteria": {
                    "using": [
                      "a",
                      "b"
                    ]
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t semi join u as uu on a = b",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "leftSemi",
                  "joinCriteria": {
                    "on": {
                      "unresolvedFunction": {
                        "functionName": [
                          "=="
                        ],
                        "arguments": [
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "a"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          },
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "b"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        ],
                        "namedArguments": [],
                        "isDistinct": false,
                        "isUserDefinedFunction": false,
                        "isInternal": null,
                        "ignoreNulls": null,
                        "filter": null,
                        "orderBy": null
                      }
                    }
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t semi join u using(a, b)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "u"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "leftSemi",
                  "joinCriteria": {
                    "using": [
                      "a",
                      "b"
                    ]
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t tt natural full join u as uu",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "fullOuter",
                  "joinCriteria": "natural",
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t tt natural full outer join u as uu",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "fullOuter",
                  "joinCriteria": "natural",
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t tt natural inner join u as uu",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "inner",
                  "joinCriteria": "natural",
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t tt natural join u as uu",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "inner",
                  "joinCriteria": "natural",
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t tt natural left join u as uu",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "leftOuter",
                  "joinCriteria": "natural",
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t tt natural left outer join u as uu",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "leftOuter",
                  "joinCriteria": "natural",
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t tt natural right join u as uu",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "rightOuter",
                  "joinCriteria": "natural",
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t tt natural right outer join u as uu",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "tt",
                      "columns": []
                    },
                    "planId": null
                  },
                  "right": {
                    "tableAlias": {
                      "input": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "u"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "name": "uu",
                      "columns": []
                    },
                    "planId": null
                  },
                  "joinType": "rightOuter",
                  "joinCriteria": "natural",
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t1 JOIN t2, t3 join t2 on t1.col1 = t2.col2",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "join": {
                      "left": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t1"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "right": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t2"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "joinType": "inner",
                      "joinCriteria": null,
                      "joinDataType": null
                    },
                    "planId": null
                  },
                  "right": {
                    "join": {
                      "left": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t3"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "right": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t2"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "joinType": "inner",
                      "joinCriteria": {
                        "on": {
                          "unresolvedFunction": {
                            "functionName": [
                              "=="
                            ],
                            "arguments": [
                              {
                                "unresolvedAttribute": {
                                  "name": [
                                    "t1",
                                    "col1"
                                  ],
                                  "planId": null,
                                  "isMetadataColumn": false
                                }
                              },
                              {
                                "unresolvedAttribute": {
                                  "name": [
                                    "t2",
                                    "col2"
                                  ],
                                  "planId": null,
                                  "isMetadataColumn": false
                                }
                              }
                            ],
                            "namedArguments": [],
                            "isDistinct": false,
                            "isUserDefinedFunction": false,
                            "isInternal": null,
                            "ignoreNulls": null,
                            "filter": null,
                            "orderBy": null
                          }
                        }
                      },
                      "joinDataType": null
                    },
                    "planId": null
                  },
                  "joinType": "cross",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t1 cross join t2 join t3 on t3.id = t1.id join t4 on t4.id = t1.id",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "join": {
                      "left": {
                        "join": {
                          "left": {
                            "read": {
                              "namedTable": {
                                "name": [
                                  "t1"
                                ],
                                "temporal": null,
                                "sample": null,
                                "options": []
                              },
                              "isStreaming": false
                            },
                            "planId": null
                          },
                          "right": {
                            "read": {
                              "namedTable": {
                                "name": [
                                  "t2"
                                ],
                                "temporal": null,
                                "sample": null,
                                "options": []
                              },
                              "isStreaming": false
                            },
                            "planId": null
                          },
                          "joinType": "cross",
                          "joinCriteria": null,
                          "joinDataType": null
                        },
                        "planId": null
                      },
                      "right": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t3"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "joinType": "inner",
                      "joinCriteria": {
                        "on": {
                          "unresolvedFunction": {
                            "functionName": [
                              "=="
                            ],
                            "arguments": [
                              {
                                "unresolvedAttribute": {
                                  "name": [
                                    "t3",
                                    "id"
                                  ],
                                  "planId": null,
                                  "isMetadataColumn": false
                                }
                              },
                              {
                                "unresolvedAttribute": {
                                  "name": [
                                    "t1",
                                    "id"
                                  ],
                                  "planId": null,
                                  "isMetadataColumn": false
                                }
                              }
                            ],
                            "namedArguments": [],
                            "isDistinct": false,
                            "isUserDefinedFunction": false,
                            "isInternal": null,
                            "ignoreNulls": null,
                            "filter": null,
                            "orderBy": null
                          }
                        }
                      },
                      "joinDataType": null
                    },
                    "planId": null
                  },
                  "right": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t4"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "joinType": "inner",
                  "joinCriteria": {
                    "on": {
                      "unresolvedFunction": {
                        "functionName": [
                          "=="
                        ],
                        "arguments": [
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "t4",
                                "id"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          },
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "t1",
                                "id"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        ],
                        "namedArguments": [],
                        "isDistinct": false,
                        "isUserDefinedFunction": false,
                        "isInternal": null,
                        "ignoreNulls": null,
                        "filter": null,
                        "orderBy": null
                      }
                    }
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t1 inner join (t2 inner join t3 on col3 = col2)",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t1"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "join": {
                      "left": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t2"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "right": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t3"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "joinType": "inner",
                      "joinCriteria": {
                        "on": {
                          "unresolvedFunction": {
                            "functionName": [
                              "=="
                            ],
                            "arguments": [
                              {
                                "unresolvedAttribute": {
                                  "name": [
                                    "col3"
                                  ],
                                  "planId": null,
                                  "isMetadataColumn": false
                                }
                              },
                              {
                                "unresolvedAttribute": {
                                  "name": [
                                    "col2"
                                  ],
                                  "planId": null,
                                  "isMetadataColumn": false
                                }
                              }
                            ],
                            "namedArguments": [],
                            "isDistinct": false,
                            "isUserDefinedFunction": false,
                            "isInternal": null,
                            "ignoreNulls": null,
                            "filter": null,
                            "orderBy": null
                          }
                        }
                      },
                      "joinDataType": null
                    },
                    "planId": null
                  },
                  "joinType": "inner",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t1 inner join (t2 inner join t3 on col3 = col2) on col3 = col1",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t1"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "join": {
                      "left": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t2"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "right": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t3"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "joinType": "inner",
                      "joinCriteria": {
                        "on": {
                          "unresolvedFunction": {
                            "functionName": [
                              "=="
                            ],
                            "arguments": [
                              {
                                "unresolvedAttribute": {
                                  "name": [
                                    "col3"
                                  ],
                                  "planId": null,
                                  "isMetadataColumn": false
                                }
                              },
                              {
                                "unresolvedAttribute": {
                                  "name": [
                                    "col2"
                                  ],
                                  "planId": null,
                                  "isMetadataColumn": false
                                }
                              }
                            ],
                            "namedArguments": [],
                            "isDistinct": false,
                            "isUserDefinedFunction": false,
                            "isInternal": null,
                            "ignoreNulls": null,
                            "filter": null,
                            "orderBy": null
                          }
                        }
                      },
                      "joinDataType": null
                    },
                    "planId": null
                  },
                  "joinType": "inner",
                  "joinCriteria": {
                    "on": {
                      "unresolvedFunction": {
                        "functionName": [
                          "=="
                        ],
                        "arguments": [
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "col3"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          },
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "col1"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        ],
                        "namedArguments": [],
                        "isDistinct": false,
                        "isUserDefinedFunction": false,
                        "isInternal": null,
                        "ignoreNulls": null,
                        "filter": null,
                        "orderBy": null
                      }
                    }
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t1 inner join (t2 inner join t3) on col3 = col2",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t1"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "join": {
                      "left": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t2"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "right": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t3"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "joinType": "inner",
                      "joinCriteria": null,
                      "joinDataType": null
                    },
                    "planId": null
                  },
                  "joinType": "inner",
                  "joinCriteria": {
                    "on": {
                      "unresolvedFunction": {
                        "functionName": [
                          "=="
                        ],
                        "arguments": [
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "col3"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          },
                          {
                            "unresolvedAttribute": {
                              "name": [
                                "col2"
                              ],
                              "planId": null,
                              "isMetadataColumn": false
                            }
                          }
                        ],
                        "namedArguments": [],
                        "isDistinct": false,
                        "isUserDefinedFunction": false,
                        "isInternal": null,
                        "ignoreNulls": null,
                        "filter": null,
                        "orderBy": null
                      }
                    }
                  },
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    },
    {
      "input": "select * from t1 inner join t2 inner join t3 on col3 = col2 on col3 = col1",
      "exception": "\n[PARSE_SYNTAX_ERROR] Syntax error at or near 'on'. SQLSTATE: 42601 (line 1, pos 60)\n\n== SQL ==\nselect * from t1 inner join t2 inner join t3 on col3 = col2 on col3 = col1\n------------------------------------------------------------^^^\n",
      "output": {
        "failure": "invalid argument: found on at 60:62 expected 'NATURAL', 'INNER', 'CROSS', 'OUTER', 'SEMI', 'ANTI', 'LEFT', 'RIGHT', 'FULL', 'JOIN', ',', 'LATERAL', 'WHERE', 'GROUP', 'HAVING', 'INTERSECT', 'UNION', 'EXCEPT', 'MINUS', 'WINDOW', 'ORDER', 'SORT', 'CLUSTER', 'DISTRIBUTE', 'LIMIT', 'OFFSET', ';', or end of input"
      }
    },
    {
      "input": "select * from t1, t3 join t2 on t1.col1 = t2.col2",
      "output": {
        "success": {
          "query": {
            "project": {
              "input": {
                "join": {
                  "left": {
                    "read": {
                      "namedTable": {
                        "name": [
                          "t1"
                        ],
                        "temporal": null,
                        "sample": null,
                        "options": []
                      },
                      "isStreaming": false
                    },
                    "planId": null
                  },
                  "right": {
                    "join": {
                      "left": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t3"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "right": {
                        "read": {
                          "namedTable": {
                            "name": [
                              "t2"
                            ],
                            "temporal": null,
                            "sample": null,
                            "options": []
                          },
                          "isStreaming": false
                        },
                        "planId": null
                      },
                      "joinType": "inner",
                      "joinCriteria": {
                        "on": {
                          "unresolvedFunction": {
                            "functionName": [
                              "=="
                            ],
                            "arguments": [
                              {
                                "unresolvedAttribute": {
                                  "name": [
                                    "t1",
                                    "col1"
                                  ],
                                  "planId": null,
                                  "isMetadataColumn": false
                                }
                              },
                              {
                                "unresolvedAttribute": {
                                  "name": [
                                    "t2",
                                    "col2"
                                  ],
                                  "planId": null,
                                  "isMetadataColumn": false
                                }
                              }
                            ],
                            "namedArguments": [],
                            "isDistinct": false,
                            "isUserDefinedFunction": false,
                            "isInternal": null,
                            "ignoreNulls": null,
                            "filter": null,
                            "orderBy": null
                          }
                        }
                      },
                      "joinDataType": null
                    },
                    "planId": null
                  },
                  "joinType": "cross",
                  "joinCriteria": null,
                  "joinDataType": null
                },
                "planId": null
              },
              "expressions": [
                {
                  "unresolvedStar": {
                    "target": null,
                    "planId": null,
                    "wildcardOptions": {
                      "ilikePattern": null,
                      "excludeColumns": null,
                      "exceptColumns": null,
                      "replaceColumns": null,
                      "renameColumns": null
                    }
                  }
                }
              ]
            },
            "planId": null
          }
        }
      }
    }
  ]
}
