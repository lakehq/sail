== Codegen ==
Whole-stage codegen is not supported; showing physical plan instead.

== Plan Steps ==
initial_logical_plan:
Limit: skip=0, fetch=Int32(100)
  Sort: <exprs>
    Projection: <exprs>
      Distinct:
        Union
          Distinct:
            Union
              Projection: <exprs>
                Filter: web.#<col> <= Int32(10) OR web.#<col> <= Int32(10)
                  SubqueryAlias: web
                    Projection: <exprs>
                      WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                        WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                          SubqueryAlias: in_web
                            Projection: <exprs>
                              Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, Int32(0))), sum(coalesce(ws.#<col>, Int32(0))), sum(coalesce(wr.#<col>, Int32(0))), sum(coalesce(ws.#<col>, Int32(0)))]]
                                Filter: wr.#<col> > Int32(10000) AND ws.#<col> > Int32(1) AND ws.#<col> > Int32(0) AND ws.#<col> > Int32(0) AND ws.#<col> = date_dim.#<col> AND date_dim.#<col> = Int32(2000) AND date_dim.#<col> = Int32(12)
                                  Cross Join: 
                                    Left Join:  Filter: ws.#<col> = wr.#<col> AND ws.#<col> = wr.#<col>
                                      SubqueryAlias: ws
                                        Projection: <exprs>
                                          Projection: <exprs>
                                            SubqueryAlias: web_sales
                                              Projection: <exprs>
                                                Projection: <exprs>
                                                  TableScan: ?table?
                                      SubqueryAlias: wr
                                        Projection: <exprs>
                                          Projection: <exprs>
                                            SubqueryAlias: web_returns
                                              Projection: <exprs>
                                                Projection: <exprs>
                                                  TableScan: ?table?
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: date_dim
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
              Projection: <exprs>
                Filter: catalog.#<col> <= Int32(10) OR catalog.#<col> <= Int32(10)
                  SubqueryAlias: catalog
                    Projection: <exprs>
                      WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                        WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                          SubqueryAlias: in_cat
                            Projection: <exprs>
                              Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, Int32(0))), sum(coalesce(cs.#<col>, Int32(0))), sum(coalesce(cr.#<col>, Int32(0))), sum(coalesce(cs.#<col>, Int32(0)))]]
                                Filter: cr.#<col> > Int32(10000) AND cs.#<col> > Int32(1) AND cs.#<col> > Int32(0) AND cs.#<col> > Int32(0) AND cs.#<col> = date_dim.#<col> AND date_dim.#<col> = Int32(2000) AND date_dim.#<col> = Int32(12)
                                  Cross Join: 
                                    Left Join:  Filter: cs.#<col> = cr.#<col> AND cs.#<col> = cr.#<col>
                                      SubqueryAlias: cs
                                        Projection: <exprs>
                                          Projection: <exprs>
                                            SubqueryAlias: catalog_sales
                                              Projection: <exprs>
                                                Projection: <exprs>
                                                  TableScan: ?table?
                                      SubqueryAlias: cr
                                        Projection: <exprs>
                                          Projection: <exprs>
                                            SubqueryAlias: catalog_returns
                                              Projection: <exprs>
                                                Projection: <exprs>
                                                  TableScan: ?table?
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: date_dim
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
          Projection: <exprs>
            Filter: store.#<col> <= Int32(10) OR store.#<col> <= Int32(10)
              SubqueryAlias: store
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_store
                        Projection: <exprs>
                          Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, Int32(0))), sum(coalesce(sts.#<col>, Int32(0))), sum(coalesce(sr.#<col>, Int32(0))), sum(coalesce(sts.#<col>, Int32(0)))]]
                            Filter: sr.#<col> > Int32(10000) AND sts.#<col> > Int32(1) AND sts.#<col> > Int32(0) AND sts.#<col> > Int32(0) AND sts.#<col> = date_dim.#<col> AND date_dim.#<col> = Int32(2000) AND date_dim.#<col> = Int32(12)
                              Cross Join: 
                                Left Join:  Filter: sts.#<col> = sr.#<col> AND sts.#<col> = sr.#<col>
                                  SubqueryAlias: sts
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: sr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?

logical_plan after resolve_grouping_function:
SAME TEXT AS ABOVE

logical_plan after type_coercion:
Limit: skip=0, fetch=CAST(Int32(100) AS Int64)
  Sort: <exprs>
    Projection: <exprs>
      Distinct:
        Union
          Distinct:
            Union
              Projection: <exprs>
                Filter: web.#<col> <= Int32(10) OR web.#<col> <= Int32(10)
                  SubqueryAlias: web
                    Projection: <exprs>
                      WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                        WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                          SubqueryAlias: in_web
                            Projection: <exprs>
                              Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, CAST(Int32(0) AS Float64))), sum(coalesce(ws.#<col>, CAST(Int32(0) AS Float64))), sum(coalesce(CAST(wr.#<col> AS Decimal128(12, 2)), CAST(Int32(0) AS Decimal128(12, 2)))), sum(coalesce(CAST(ws.#<col> AS Decimal128(12, 2)), CAST(Int32(0) AS Decimal128(12, 2))))]]
                                Filter: CAST(wr.#<col> AS Decimal128(12, 2)) > CAST(Int32(10000) AS Decimal128(12, 2)) AND CAST(ws.#<col> AS Decimal128(12, 2)) > CAST(Int32(1) AS Decimal128(12, 2)) AND CAST(ws.#<col> AS Decimal128(12, 2)) > CAST(Int32(0) AS Decimal128(12, 2)) AND ws.#<col> > CAST(Int32(0) AS Float64) AND ws.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = CAST(Int32(2000) AS Int64) AND date_dim.#<col> = CAST(Int32(12) AS Int64)
                                  Cross Join: 
                                    Left Join:  Filter: ws.#<col> = wr.#<col> AND ws.#<col> = wr.#<col>
                                      SubqueryAlias: ws
                                        Projection: <exprs>
                                          Projection: <exprs>
                                            SubqueryAlias: web_sales
                                              Projection: <exprs>
                                                Projection: <exprs>
                                                  TableScan: ?table?
                                      SubqueryAlias: wr
                                        Projection: <exprs>
                                          Projection: <exprs>
                                            SubqueryAlias: web_returns
                                              Projection: <exprs>
                                                Projection: <exprs>
                                                  TableScan: ?table?
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: date_dim
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
              Projection: <exprs>
                Filter: catalog.#<col> <= Int32(10) OR catalog.#<col> <= Int32(10)
                  SubqueryAlias: catalog
                    Projection: <exprs>
                      WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                        WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                          SubqueryAlias: in_cat
                            Projection: <exprs>
                              Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, CAST(Int32(0) AS Float64))), sum(coalesce(cs.#<col>, CAST(Int32(0) AS Float64))), sum(coalesce(CAST(cr.#<col> AS Decimal128(12, 2)), CAST(Int32(0) AS Decimal128(12, 2)))), sum(coalesce(CAST(cs.#<col> AS Decimal128(12, 2)), CAST(Int32(0) AS Decimal128(12, 2))))]]
                                Filter: CAST(cr.#<col> AS Decimal128(12, 2)) > CAST(Int32(10000) AS Decimal128(12, 2)) AND CAST(cs.#<col> AS Decimal128(12, 2)) > CAST(Int32(1) AS Decimal128(12, 2)) AND CAST(cs.#<col> AS Decimal128(12, 2)) > CAST(Int32(0) AS Decimal128(12, 2)) AND cs.#<col> > CAST(Int32(0) AS Float64) AND cs.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = CAST(Int32(2000) AS Int64) AND date_dim.#<col> = CAST(Int32(12) AS Int64)
                                  Cross Join: 
                                    Left Join:  Filter: cs.#<col> = cr.#<col> AND cs.#<col> = cr.#<col>
                                      SubqueryAlias: cs
                                        Projection: <exprs>
                                          Projection: <exprs>
                                            SubqueryAlias: catalog_sales
                                              Projection: <exprs>
                                                Projection: <exprs>
                                                  TableScan: ?table?
                                      SubqueryAlias: cr
                                        Projection: <exprs>
                                          Projection: <exprs>
                                            SubqueryAlias: catalog_returns
                                              Projection: <exprs>
                                                Projection: <exprs>
                                                  TableScan: ?table?
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: date_dim
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
          Projection: <exprs>
            Filter: store.#<col> <= Int32(10) OR store.#<col> <= Int32(10)
              SubqueryAlias: store
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_store
                        Projection: <exprs>
                          Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, CAST(Int32(0) AS Float64))), sum(coalesce(sts.#<col>, CAST(Int32(0) AS Float64))), sum(coalesce(CAST(sr.#<col> AS Decimal128(12, 2)), CAST(Int32(0) AS Decimal128(12, 2)))), sum(coalesce(CAST(sts.#<col> AS Decimal128(12, 2)), CAST(Int32(0) AS Decimal128(12, 2))))]]
                            Filter: CAST(sr.#<col> AS Decimal128(12, 2)) > CAST(Int32(10000) AS Decimal128(12, 2)) AND CAST(sts.#<col> AS Decimal128(12, 2)) > CAST(Int32(1) AS Decimal128(12, 2)) AND CAST(sts.#<col> AS Decimal128(12, 2)) > CAST(Int32(0) AS Decimal128(12, 2)) AND sts.#<col> > CAST(Int32(0) AS Float64) AND sts.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = CAST(Int32(2000) AS Int64) AND date_dim.#<col> = CAST(Int32(12) AS Int64)
                              Cross Join: 
                                Left Join:  Filter: sts.#<col> = sr.#<col> AND sts.#<col> = sr.#<col>
                                  SubqueryAlias: sts
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: sr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?

analyzed_logical_plan:
SAME TEXT AS ABOVE

logical_plan after eliminate_nested_union:
Limit: skip=0, fetch=CAST(Int32(100) AS Int64)
  Sort: <exprs>
    Projection: <exprs>
      Distinct:
        Union
          Projection: <exprs>
            Filter: web.#<col> <= Int32(10) OR web.#<col> <= Int32(10)
              SubqueryAlias: web
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_web
                        Projection: <exprs>
                          Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, CAST(Int32(0) AS Float64))), sum(coalesce(ws.#<col>, CAST(Int32(0) AS Float64))), sum(coalesce(CAST(wr.#<col> AS Decimal128(12, 2)), CAST(Int32(0) AS Decimal128(12, 2)))), sum(coalesce(CAST(ws.#<col> AS Decimal128(12, 2)), CAST(Int32(0) AS Decimal128(12, 2))))]]
                            Filter: CAST(wr.#<col> AS Decimal128(12, 2)) > CAST(Int32(10000) AS Decimal128(12, 2)) AND CAST(ws.#<col> AS Decimal128(12, 2)) > CAST(Int32(1) AS Decimal128(12, 2)) AND CAST(ws.#<col> AS Decimal128(12, 2)) > CAST(Int32(0) AS Decimal128(12, 2)) AND ws.#<col> > CAST(Int32(0) AS Float64) AND ws.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = CAST(Int32(2000) AS Int64) AND date_dim.#<col> = CAST(Int32(12) AS Int64)
                              Cross Join: 
                                Left Join:  Filter: ws.#<col> = wr.#<col> AND ws.#<col> = wr.#<col>
                                  SubqueryAlias: ws
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: web_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: wr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: web_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?
          Projection: <exprs>
            Filter: catalog.#<col> <= Int32(10) OR catalog.#<col> <= Int32(10)
              SubqueryAlias: catalog
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_cat
                        Projection: <exprs>
                          Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, CAST(Int32(0) AS Float64))), sum(coalesce(cs.#<col>, CAST(Int32(0) AS Float64))), sum(coalesce(CAST(cr.#<col> AS Decimal128(12, 2)), CAST(Int32(0) AS Decimal128(12, 2)))), sum(coalesce(CAST(cs.#<col> AS Decimal128(12, 2)), CAST(Int32(0) AS Decimal128(12, 2))))]]
                            Filter: CAST(cr.#<col> AS Decimal128(12, 2)) > CAST(Int32(10000) AS Decimal128(12, 2)) AND CAST(cs.#<col> AS Decimal128(12, 2)) > CAST(Int32(1) AS Decimal128(12, 2)) AND CAST(cs.#<col> AS Decimal128(12, 2)) > CAST(Int32(0) AS Decimal128(12, 2)) AND cs.#<col> > CAST(Int32(0) AS Float64) AND cs.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = CAST(Int32(2000) AS Int64) AND date_dim.#<col> = CAST(Int32(12) AS Int64)
                              Cross Join: 
                                Left Join:  Filter: cs.#<col> = cr.#<col> AND cs.#<col> = cr.#<col>
                                  SubqueryAlias: cs
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: catalog_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: cr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: catalog_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?
          Projection: <exprs>
            Filter: store.#<col> <= Int32(10) OR store.#<col> <= Int32(10)
              SubqueryAlias: store
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_store
                        Projection: <exprs>
                          Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, CAST(Int32(0) AS Float64))), sum(coalesce(sts.#<col>, CAST(Int32(0) AS Float64))), sum(coalesce(CAST(sr.#<col> AS Decimal128(12, 2)), CAST(Int32(0) AS Decimal128(12, 2)))), sum(coalesce(CAST(sts.#<col> AS Decimal128(12, 2)), CAST(Int32(0) AS Decimal128(12, 2))))]]
                            Filter: CAST(sr.#<col> AS Decimal128(12, 2)) > CAST(Int32(10000) AS Decimal128(12, 2)) AND CAST(sts.#<col> AS Decimal128(12, 2)) > CAST(Int32(1) AS Decimal128(12, 2)) AND CAST(sts.#<col> AS Decimal128(12, 2)) > CAST(Int32(0) AS Decimal128(12, 2)) AND sts.#<col> > CAST(Int32(0) AS Float64) AND sts.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = CAST(Int32(2000) AS Int64) AND date_dim.#<col> = CAST(Int32(12) AS Int64)
                              Cross Join: 
                                Left Join:  Filter: sts.#<col> = sr.#<col> AND sts.#<col> = sr.#<col>
                                  SubqueryAlias: sts
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: sr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?

logical_plan after simplify_expressions:
Limit: skip=0, fetch=100
  Sort: <exprs>
    Projection: <exprs>
      Distinct:
        Union
          Projection: <exprs>
            Filter: web.#<col> <= Int32(10) OR web.#<col> <= Int32(10)
              SubqueryAlias: web
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_web
                        Projection: <exprs>
                          Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, Float64(0))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>, Float64(0))) AS sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(CAST(wr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(CAST(ws.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(ws.#<col>,Int32(0)))]]
                            Filter: wr.#<col> > Decimal128(Some(1000000),7,2) AND ws.#<col> > Decimal128(Some(100),7,2) AND ws.#<col> > Decimal128(Some(0),7,2) AND ws.#<col> > Float64(0) AND ws.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = Int64(2000) AND date_dim.#<col> = Int64(12)
                              Cross Join: 
                                Left Join:  Filter: ws.#<col> = wr.#<col> AND ws.#<col> = wr.#<col>
                                  SubqueryAlias: ws
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: web_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: wr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: web_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?
          Projection: <exprs>
            Filter: catalog.#<col> <= Int32(10) OR catalog.#<col> <= Int32(10)
              SubqueryAlias: catalog
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_cat
                        Projection: <exprs>
                          Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, Float64(0))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>, Float64(0))) AS sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(CAST(cr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(CAST(cs.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cs.#<col>,Int32(0)))]]
                            Filter: cr.#<col> > Decimal128(Some(1000000),7,2) AND cs.#<col> > Decimal128(Some(100),7,2) AND cs.#<col> > Decimal128(Some(0),7,2) AND cs.#<col> > Float64(0) AND cs.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = Int64(2000) AND date_dim.#<col> = Int64(12)
                              Cross Join: 
                                Left Join:  Filter: cs.#<col> = cr.#<col> AND cs.#<col> = cr.#<col>
                                  SubqueryAlias: cs
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: catalog_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: cr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: catalog_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?
          Projection: <exprs>
            Filter: store.#<col> <= Int32(10) OR store.#<col> <= Int32(10)
              SubqueryAlias: store
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_store
                        Projection: <exprs>
                          Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, Float64(0))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>, Float64(0))) AS sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(CAST(sr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(CAST(sts.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sts.#<col>,Int32(0)))]]
                            Filter: sr.#<col> > Decimal128(Some(1000000),7,2) AND sts.#<col> > Decimal128(Some(100),6,2) AND sts.#<col> > Decimal128(Some(0),7,2) AND sts.#<col> > Float64(0) AND sts.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = Int64(2000) AND date_dim.#<col> = Int64(12)
                              Cross Join: 
                                Left Join:  Filter: sts.#<col> = sr.#<col> AND sts.#<col> = sr.#<col>
                                  SubqueryAlias: sts
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: sr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?

logical_plan after replace_distinct_aggregate:
Limit: skip=0, fetch=100
  Sort: <exprs>
    Projection: <exprs>
      Aggregate: groupBy=[[#<col>, #<col>, #<col>, #<col>, #<col>]], aggr=[[]]
        Union
          Projection: <exprs>
            Filter: web.#<col> <= Int32(10) OR web.#<col> <= Int32(10)
              SubqueryAlias: web
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_web
                        Projection: <exprs>
                          Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, Float64(0))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>, Float64(0))) AS sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(CAST(wr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(CAST(ws.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(ws.#<col>,Int32(0)))]]
                            Filter: wr.#<col> > Decimal128(Some(1000000),7,2) AND ws.#<col> > Decimal128(Some(100),7,2) AND ws.#<col> > Decimal128(Some(0),7,2) AND ws.#<col> > Float64(0) AND ws.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = Int64(2000) AND date_dim.#<col> = Int64(12)
                              Cross Join: 
                                Left Join:  Filter: ws.#<col> = wr.#<col> AND ws.#<col> = wr.#<col>
                                  SubqueryAlias: ws
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: web_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: wr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: web_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?
          Projection: <exprs>
            Filter: catalog.#<col> <= Int32(10) OR catalog.#<col> <= Int32(10)
              SubqueryAlias: catalog
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_cat
                        Projection: <exprs>
                          Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, Float64(0))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>, Float64(0))) AS sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(CAST(cr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(CAST(cs.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cs.#<col>,Int32(0)))]]
                            Filter: cr.#<col> > Decimal128(Some(1000000),7,2) AND cs.#<col> > Decimal128(Some(100),7,2) AND cs.#<col> > Decimal128(Some(0),7,2) AND cs.#<col> > Float64(0) AND cs.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = Int64(2000) AND date_dim.#<col> = Int64(12)
                              Cross Join: 
                                Left Join:  Filter: cs.#<col> = cr.#<col> AND cs.#<col> = cr.#<col>
                                  SubqueryAlias: cs
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: catalog_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: cr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: catalog_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?
          Projection: <exprs>
            Filter: store.#<col> <= Int32(10) OR store.#<col> <= Int32(10)
              SubqueryAlias: store
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_store
                        Projection: <exprs>
                          Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, Float64(0))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>, Float64(0))) AS sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(CAST(sr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(CAST(sts.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sts.#<col>,Int32(0)))]]
                            Filter: sr.#<col> > Decimal128(Some(1000000),7,2) AND sts.#<col> > Decimal128(Some(100),6,2) AND sts.#<col> > Decimal128(Some(0),7,2) AND sts.#<col> > Float64(0) AND sts.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = Int64(2000) AND date_dim.#<col> = Int64(12)
                              Cross Join: 
                                Left Join:  Filter: sts.#<col> = sr.#<col> AND sts.#<col> = sr.#<col>
                                  SubqueryAlias: sts
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: sr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?

logical_plan after eliminate_join:
SAME TEXT AS ABOVE

logical_plan after decorrelate_predicate_subquery:
SAME TEXT AS ABOVE

logical_plan after scalar_subquery_to_join:
SAME TEXT AS ABOVE

logical_plan after decorrelate_lateral_join:
SAME TEXT AS ABOVE

logical_plan after extract_equijoin_predicate:
Limit: skip=0, fetch=100
  Sort: <exprs>
    Projection: <exprs>
      Aggregate: groupBy=[[#<col>, #<col>, #<col>, #<col>, #<col>]], aggr=[[]]
        Union
          Projection: <exprs>
            Filter: web.#<col> <= Int32(10) OR web.#<col> <= Int32(10)
              SubqueryAlias: web
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_web
                        Projection: <exprs>
                          Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, Float64(0))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>, Float64(0))) AS sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(CAST(wr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(CAST(ws.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(ws.#<col>,Int32(0)))]]
                            Filter: wr.#<col> > Decimal128(Some(1000000),7,2) AND ws.#<col> > Decimal128(Some(100),7,2) AND ws.#<col> > Decimal128(Some(0),7,2) AND ws.#<col> > Float64(0) AND ws.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = Int64(2000) AND date_dim.#<col> = Int64(12)
                              Cross Join: 
                                Left Join: ws.#<col> = wr.#<col>, ws.#<col> = wr.#<col>
                                  SubqueryAlias: ws
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: web_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: wr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: web_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?
          Projection: <exprs>
            Filter: catalog.#<col> <= Int32(10) OR catalog.#<col> <= Int32(10)
              SubqueryAlias: catalog
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_cat
                        Projection: <exprs>
                          Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, Float64(0))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>, Float64(0))) AS sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(CAST(cr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(CAST(cs.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cs.#<col>,Int32(0)))]]
                            Filter: cr.#<col> > Decimal128(Some(1000000),7,2) AND cs.#<col> > Decimal128(Some(100),7,2) AND cs.#<col> > Decimal128(Some(0),7,2) AND cs.#<col> > Float64(0) AND cs.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = Int64(2000) AND date_dim.#<col> = Int64(12)
                              Cross Join: 
                                Left Join: cs.#<col> = cr.#<col>, cs.#<col> = cr.#<col>
                                  SubqueryAlias: cs
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: catalog_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: cr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: catalog_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?
          Projection: <exprs>
            Filter: store.#<col> <= Int32(10) OR store.#<col> <= Int32(10)
              SubqueryAlias: store
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_store
                        Projection: <exprs>
                          Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, Float64(0))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>, Float64(0))) AS sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(CAST(sr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(CAST(sts.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sts.#<col>,Int32(0)))]]
                            Filter: sr.#<col> > Decimal128(Some(1000000),7,2) AND sts.#<col> > Decimal128(Some(100),6,2) AND sts.#<col> > Decimal128(Some(0),7,2) AND sts.#<col> > Float64(0) AND sts.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = Int64(2000) AND date_dim.#<col> = Int64(12)
                              Cross Join: 
                                Left Join: sts.#<col> = sr.#<col>, sts.#<col> = sr.#<col>
                                  SubqueryAlias: sts
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: sr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?

logical_plan after eliminate_duplicated_expr:
SAME TEXT AS ABOVE

logical_plan after eliminate_filter:
SAME TEXT AS ABOVE

logical_plan after eliminate_cross_join:
Limit: skip=0, fetch=100
  Sort: <exprs>
    Projection: <exprs>
      Aggregate: groupBy=[[#<col>, #<col>, #<col>, #<col>, #<col>]], aggr=[[]]
        Union
          Projection: <exprs>
            Filter: web.#<col> <= Int32(10) OR web.#<col> <= Int32(10)
              SubqueryAlias: web
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_web
                        Projection: <exprs>
                          Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, Float64(0))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>, Float64(0))) AS sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(CAST(wr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(CAST(ws.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(ws.#<col>,Int32(0)))]]
                            Filter: wr.#<col> > Decimal128(Some(1000000),7,2) AND ws.#<col> > Decimal128(Some(100),7,2) AND ws.#<col> > Decimal128(Some(0),7,2) AND ws.#<col> > Float64(0) AND date_dim.#<col> = Int64(2000) AND date_dim.#<col> = Int64(12)
                              Inner Join: ws.#<col> = CAST(date_dim.#<col> AS Float64)
                                Left Join: ws.#<col> = wr.#<col>, ws.#<col> = wr.#<col>
                                  SubqueryAlias: ws
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: web_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: wr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: web_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?
          Projection: <exprs>
            Filter: catalog.#<col> <= Int32(10) OR catalog.#<col> <= Int32(10)
              SubqueryAlias: catalog
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_cat
                        Projection: <exprs>
                          Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, Float64(0))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>, Float64(0))) AS sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(CAST(cr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(CAST(cs.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cs.#<col>,Int32(0)))]]
                            Filter: cr.#<col> > Decimal128(Some(1000000),7,2) AND cs.#<col> > Decimal128(Some(100),7,2) AND cs.#<col> > Decimal128(Some(0),7,2) AND cs.#<col> > Float64(0) AND date_dim.#<col> = Int64(2000) AND date_dim.#<col> = Int64(12)
                              Inner Join: cs.#<col> = CAST(date_dim.#<col> AS Float64)
                                Left Join: cs.#<col> = cr.#<col>, cs.#<col> = cr.#<col>
                                  SubqueryAlias: cs
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: catalog_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: cr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: catalog_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?
          Projection: <exprs>
            Filter: store.#<col> <= Int32(10) OR store.#<col> <= Int32(10)
              SubqueryAlias: store
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_store
                        Projection: <exprs>
                          Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, Float64(0))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>, Float64(0))) AS sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(CAST(sr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(CAST(sts.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sts.#<col>,Int32(0)))]]
                            Filter: sr.#<col> > Decimal128(Some(1000000),7,2) AND sts.#<col> > Decimal128(Some(100),6,2) AND sts.#<col> > Decimal128(Some(0),7,2) AND sts.#<col> > Float64(0) AND date_dim.#<col> = Int64(2000) AND date_dim.#<col> = Int64(12)
                              Inner Join: sts.#<col> = CAST(date_dim.#<col> AS Float64)
                                Left Join: sts.#<col> = sr.#<col>, sts.#<col> = sr.#<col>
                                  SubqueryAlias: sts
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: sr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?

logical_plan after eliminate_limit:
SAME TEXT AS ABOVE

logical_plan after propagate_empty_relation:
SAME TEXT AS ABOVE

logical_plan after eliminate_one_union:
SAME TEXT AS ABOVE

logical_plan after filter_null_join_keys:
SAME TEXT AS ABOVE

logical_plan after eliminate_outer_join:
SAME TEXT AS ABOVE

logical_plan after push_down_limit:
Limit: skip=0, fetch=100
  Sort: <exprs>
    Projection: <exprs>
      Aggregate: groupBy=[[#<col>, #<col>, #<col>, #<col>, #<col>]], aggr=[[]]
        Union
          Projection: <exprs>
            Filter: web.#<col> <= Int32(10) OR web.#<col> <= Int32(10)
              SubqueryAlias: web
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_web
                        Projection: <exprs>
                          Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, Float64(0))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>, Float64(0))) AS sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(CAST(wr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(CAST(ws.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(ws.#<col>,Int32(0)))]]
                            Filter: wr.#<col> > Decimal128(Some(1000000),7,2) AND ws.#<col> > Decimal128(Some(100),7,2) AND ws.#<col> > Decimal128(Some(0),7,2) AND ws.#<col> > Float64(0) AND date_dim.#<col> = Int64(2000) AND date_dim.#<col> = Int64(12)
                              Inner Join: ws.#<col> = CAST(date_dim.#<col> AS Float64)
                                Left Join: ws.#<col> = wr.#<col>, ws.#<col> = wr.#<col>
                                  SubqueryAlias: ws
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: web_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: wr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: web_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?
          Projection: <exprs>
            Filter: catalog.#<col> <= Int32(10) OR catalog.#<col> <= Int32(10)
              SubqueryAlias: catalog
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_cat
                        Projection: <exprs>
                          Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, Float64(0))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>, Float64(0))) AS sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(CAST(cr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(CAST(cs.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cs.#<col>,Int32(0)))]]
                            Filter: cr.#<col> > Decimal128(Some(1000000),7,2) AND cs.#<col> > Decimal128(Some(100),7,2) AND cs.#<col> > Decimal128(Some(0),7,2) AND cs.#<col> > Float64(0) AND date_dim.#<col> = Int64(2000) AND date_dim.#<col> = Int64(12)
                              Inner Join: cs.#<col> = CAST(date_dim.#<col> AS Float64)
                                Left Join: cs.#<col> = cr.#<col>, cs.#<col> = cr.#<col>
                                  SubqueryAlias: cs
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: catalog_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: cr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: catalog_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?
          Projection: <exprs>
            Filter: store.#<col> <= Int32(10) OR store.#<col> <= Int32(10)
              SubqueryAlias: store
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_store
                        Projection: <exprs>
                          Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, Float64(0))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>, Float64(0))) AS sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(CAST(sr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(CAST(sts.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sts.#<col>,Int32(0)))]]
                            Filter: sr.#<col> > Decimal128(Some(1000000),7,2) AND sts.#<col> > Decimal128(Some(100),6,2) AND sts.#<col> > Decimal128(Some(0),7,2) AND sts.#<col> > Float64(0) AND date_dim.#<col> = Int64(2000) AND date_dim.#<col> = Int64(12)
                              Inner Join: sts.#<col> = CAST(date_dim.#<col> AS Float64)
                                Left Join: sts.#<col> = sr.#<col>, sts.#<col> = sr.#<col>
                                  SubqueryAlias: sts
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                  SubqueryAlias: sr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                Projection: <exprs>
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          TableScan: ?table?

logical_plan after push_down_filter:
Limit: skip=0, fetch=100
  Sort: <exprs>
    Projection: <exprs>
      Aggregate: groupBy=[[#<col>, #<col>, #<col>, #<col>, #<col>]], aggr=[[]]
        Union
          Projection: <exprs>
            SubqueryAlias: web
              Projection: <exprs>
                Filter: CAST(rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW AS Int32) <= Int32(10) OR CAST(rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW AS Int32) <= Int32(10)
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_web
                        Projection: <exprs>
                          Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, Float64(0))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>, Float64(0))) AS sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(CAST(wr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(CAST(ws.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(ws.#<col>,Int32(0)))]]
                            Inner Join: ws.#<col> = CAST(date_dim.#<col> AS Float64)
                              Filter: wr.#<col> > Decimal128(Some(1000000),7,2)
                                Left Join: ws.#<col> = wr.#<col>, ws.#<col> = wr.#<col>
                                  SubqueryAlias: ws
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: web_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                TableScan: ?table?
                                  SubqueryAlias: wr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: web_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                              Projection: <exprs>
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                          TableScan: ?table?
          Projection: <exprs>
            SubqueryAlias: catalog
              Projection: <exprs>
                Filter: CAST(rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW AS Int32) <= Int32(10) OR CAST(rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW AS Int32) <= Int32(10)
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_cat
                        Projection: <exprs>
                          Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, Float64(0))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>, Float64(0))) AS sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(CAST(cr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(CAST(cs.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cs.#<col>,Int32(0)))]]
                            Inner Join: cs.#<col> = CAST(date_dim.#<col> AS Float64)
                              Filter: cr.#<col> > Decimal128(Some(1000000),7,2)
                                Left Join: cs.#<col> = cr.#<col>, cs.#<col> = cr.#<col>
                                  SubqueryAlias: cs
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: catalog_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                TableScan: ?table?
                                  SubqueryAlias: cr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: catalog_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                              Projection: <exprs>
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                          TableScan: ?table?
          Projection: <exprs>
            SubqueryAlias: store
              Projection: <exprs>
                Filter: CAST(rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW AS Int32) <= Int32(10) OR CAST(rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW AS Int32) <= Int32(10)
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_store
                        Projection: <exprs>
                          Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, Float64(0))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>, Float64(0))) AS sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(CAST(sr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(CAST(sts.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sts.#<col>,Int32(0)))]]
                            Inner Join: sts.#<col> = CAST(date_dim.#<col> AS Float64)
                              Filter: sr.#<col> > Decimal128(Some(1000000),7,2)
                                Left Join: sts.#<col> = sr.#<col>, sts.#<col> = sr.#<col>
                                  SubqueryAlias: sts
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_sales
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              Filter: ?table?._22 > Decimal128(Some(100),6,2) AND ?table?._20 > Decimal128(Some(0),7,2) AND ?table?._10 > Float64(0)
                                                TableScan: ?table?
                                  SubqueryAlias: sr
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: store_returns
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                              Projection: <exprs>
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                          TableScan: ?table?

logical_plan after single_distinct_aggregation_to_group_by:
SAME TEXT AS ABOVE

logical_plan after eliminate_group_by_constant:
SAME TEXT AS ABOVE

logical_plan after common_sub_expression_eliminate:
SAME TEXT AS ABOVE

logical_plan after optimize_projections:
Limit: skip=0, fetch=100
  Sort: <exprs>
    Projection: <exprs>
      Aggregate: groupBy=[[#<col>, #<col>, #<col>, #<col>, #<col>]], aggr=[[]]
        Union
          Projection: <exprs>
            SubqueryAlias: web
              Projection: <exprs>
                Filter: CAST(rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW AS Int32) <= Int32(10) OR CAST(rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW AS Int32) <= Int32(10)
                  Projection: <exprs>
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                        SubqueryAlias: in_web
                          Projection: <exprs>
                            Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, Float64(0))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>, Float64(0))) AS sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(CAST(wr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(CAST(ws.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(ws.#<col>,Int32(0)))]]
                              Projection: <exprs>
                                Inner Join: ws.#<col> = CAST(date_dim.#<col> AS Float64)
                                  Filter: wr.#<col> > Decimal128(Some(1000000),7,2)
                                    Projection: <exprs>
                                      Left Join: ws.#<col> = wr.#<col>, ws.#<col> = wr.#<col>
                                        SubqueryAlias: ws
                                          Projection: <exprs>
                                            SubqueryAlias: web_sales
                                              Projection: <exprs>
                                                Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                  TableScan: ?table? projection=[_0, _3, _17, _18, _29, _33]
                                        SubqueryAlias: wr
                                          Projection: <exprs>
                                            SubqueryAlias: web_returns
                                              Projection: <exprs>
                                                TableScan: ?table? projection=[_2, _13, _14, _15]
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                          TableScan: ?table? projection=[_0, _6, _8]
          Projection: <exprs>
            SubqueryAlias: catalog
              Projection: <exprs>
                Filter: CAST(rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW AS Int32) <= Int32(10) OR CAST(rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW AS Int32) <= Int32(10)
                  Projection: <exprs>
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                        SubqueryAlias: in_cat
                          Projection: <exprs>
                            Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, Float64(0))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>, Float64(0))) AS sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(CAST(cr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(CAST(cs.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cs.#<col>,Int32(0)))]]
                              Projection: <exprs>
                                Inner Join: cs.#<col> = CAST(date_dim.#<col> AS Float64)
                                  Filter: cr.#<col> > Decimal128(Some(1000000),7,2)
                                    Projection: <exprs>
                                      Left Join: cs.#<col> = cr.#<col>, cs.#<col> = cr.#<col>
                                        SubqueryAlias: cs
                                          Projection: <exprs>
                                            SubqueryAlias: catalog_sales
                                              Projection: <exprs>
                                                Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                  TableScan: ?table? projection=[_0, _15, _17, _18, _29, _33]
                                        SubqueryAlias: cr
                                          Projection: <exprs>
                                            SubqueryAlias: catalog_returns
                                              Projection: <exprs>
                                                TableScan: ?table? projection=[_2, _16, _17, _18]
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                          TableScan: ?table? projection=[_0, _6, _8]
          Projection: <exprs>
            SubqueryAlias: store
              Projection: <exprs>
                Filter: CAST(rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW AS Int32) <= Int32(10) OR CAST(rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW AS Int32) <= Int32(10)
                  Projection: <exprs>
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                        SubqueryAlias: in_store
                          Projection: <exprs>
                            Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, Float64(0))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>, Float64(0))) AS sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(CAST(sr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(CAST(sts.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sts.#<col>,Int32(0)))]]
                              Projection: <exprs>
                                Inner Join: sts.#<col> = CAST(date_dim.#<col> AS Float64)
                                  Filter: sr.#<col> > Decimal128(Some(1000000),7,2)
                                    Projection: <exprs>
                                      Left Join: sts.#<col> = sr.#<col>, sts.#<col> = sr.#<col>
                                        SubqueryAlias: sts
                                          Projection: <exprs>
                                            SubqueryAlias: store_sales
                                              Projection: <exprs>
                                                Filter: ?table?._22 > Decimal128(Some(100),6,2) AND ?table?._20 > Decimal128(Some(0),7,2) AND ?table?._10 > Float64(0)
                                                  TableScan: ?table? projection=[_0, _2, _9, _10, _20, _22]
                                        SubqueryAlias: sr
                                          Projection: <exprs>
                                            SubqueryAlias: store_returns
                                              Projection: <exprs>
                                                TableScan: ?table? projection=[_2, _9, _10, _11]
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                          TableScan: ?table? projection=[_0, _6, _8]

logical_plan after eliminate_nested_union:
SAME TEXT AS ABOVE

logical_plan after simplify_expressions:
Limit: skip=0, fetch=100
  Sort: <exprs>
    Projection: <exprs>
      Aggregate: groupBy=[[#<col>, #<col>, #<col>, #<col>, #<col>]], aggr=[[]]
        Union
          Projection: <exprs>
            SubqueryAlias: web
              Projection: <exprs>
                Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                  Projection: <exprs>
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                        SubqueryAlias: in_web
                          Projection: <exprs>
                            Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, Float64(0))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>, Float64(0))) AS sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(CAST(wr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(CAST(ws.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(ws.#<col>,Int32(0)))]]
                              Projection: <exprs>
                                Inner Join: ws.#<col> = CAST(date_dim.#<col> AS Float64)
                                  Filter: wr.#<col> > Decimal128(Some(1000000),7,2)
                                    Projection: <exprs>
                                      Left Join: ws.#<col> = wr.#<col>, ws.#<col> = wr.#<col>
                                        SubqueryAlias: ws
                                          Projection: <exprs>
                                            SubqueryAlias: web_sales
                                              Projection: <exprs>
                                                Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                  TableScan: ?table? projection=[_0, _3, _17, _18, _29, _33]
                                        SubqueryAlias: wr
                                          Projection: <exprs>
                                            SubqueryAlias: web_returns
                                              Projection: <exprs>
                                                TableScan: ?table? projection=[_2, _13, _14, _15]
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                          TableScan: ?table? projection=[_0, _6, _8]
          Projection: <exprs>
            SubqueryAlias: catalog
              Projection: <exprs>
                Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                  Projection: <exprs>
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                        SubqueryAlias: in_cat
                          Projection: <exprs>
                            Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, Float64(0))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>, Float64(0))) AS sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(CAST(cr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(CAST(cs.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cs.#<col>,Int32(0)))]]
                              Projection: <exprs>
                                Inner Join: cs.#<col> = CAST(date_dim.#<col> AS Float64)
                                  Filter: cr.#<col> > Decimal128(Some(1000000),7,2)
                                    Projection: <exprs>
                                      Left Join: cs.#<col> = cr.#<col>, cs.#<col> = cr.#<col>
                                        SubqueryAlias: cs
                                          Projection: <exprs>
                                            SubqueryAlias: catalog_sales
                                              Projection: <exprs>
                                                Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                  TableScan: ?table? projection=[_0, _15, _17, _18, _29, _33]
                                        SubqueryAlias: cr
                                          Projection: <exprs>
                                            SubqueryAlias: catalog_returns
                                              Projection: <exprs>
                                                TableScan: ?table? projection=[_2, _16, _17, _18]
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                          TableScan: ?table? projection=[_0, _6, _8]
          Projection: <exprs>
            SubqueryAlias: store
              Projection: <exprs>
                Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                  Projection: <exprs>
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                        SubqueryAlias: in_store
                          Projection: <exprs>
                            Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, Float64(0))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>, Float64(0))) AS sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(CAST(sr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(CAST(sts.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sts.#<col>,Int32(0)))]]
                              Projection: <exprs>
                                Inner Join: sts.#<col> = CAST(date_dim.#<col> AS Float64)
                                  Filter: sr.#<col> > Decimal128(Some(1000000),7,2)
                                    Projection: <exprs>
                                      Left Join: sts.#<col> = sr.#<col>, sts.#<col> = sr.#<col>
                                        SubqueryAlias: sts
                                          Projection: <exprs>
                                            SubqueryAlias: store_sales
                                              Projection: <exprs>
                                                Filter: ?table?._22 > Decimal128(Some(100),6,2) AND ?table?._20 > Decimal128(Some(0),7,2) AND ?table?._10 > Float64(0)
                                                  TableScan: ?table? projection=[_0, _2, _9, _10, _20, _22]
                                        SubqueryAlias: sr
                                          Projection: <exprs>
                                            SubqueryAlias: store_returns
                                              Projection: <exprs>
                                                TableScan: ?table? projection=[_2, _9, _10, _11]
                                  Projection: <exprs>
                                    SubqueryAlias: date_dim
                                      Projection: <exprs>
                                        Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                          TableScan: ?table? projection=[_0, _6, _8]

logical_plan after replace_distinct_aggregate:
SAME TEXT AS ABOVE

logical_plan after eliminate_join:
SAME TEXT AS ABOVE

logical_plan after decorrelate_predicate_subquery:
SAME TEXT AS ABOVE

logical_plan after scalar_subquery_to_join:
SAME TEXT AS ABOVE

logical_plan after decorrelate_lateral_join:
SAME TEXT AS ABOVE

logical_plan after extract_equijoin_predicate:
SAME TEXT AS ABOVE

logical_plan after eliminate_duplicated_expr:
SAME TEXT AS ABOVE

logical_plan after eliminate_filter:
SAME TEXT AS ABOVE

logical_plan after eliminate_cross_join:
SAME TEXT AS ABOVE

logical_plan after eliminate_limit:
SAME TEXT AS ABOVE

logical_plan after propagate_empty_relation:
SAME TEXT AS ABOVE

logical_plan after eliminate_one_union:
SAME TEXT AS ABOVE

logical_plan after filter_null_join_keys:
SAME TEXT AS ABOVE

logical_plan after eliminate_outer_join:
SAME TEXT AS ABOVE

logical_plan after push_down_limit:
Sort: <exprs>
  Projection: <exprs>
    Aggregate: groupBy=[[#<col>, #<col>, #<col>, #<col>, #<col>]], aggr=[[]]
      Union
        Projection: <exprs>
          SubqueryAlias: web
            Projection: <exprs>
              Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_web
                        Projection: <exprs>
                          Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, Float64(0))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>, Float64(0))) AS sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(CAST(wr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(CAST(ws.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(ws.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: ws.#<col> = CAST(date_dim.#<col> AS Float64)
                                Filter: wr.#<col> > Decimal128(Some(1000000),7,2)
                                  Projection: <exprs>
                                    Left Join: ws.#<col> = wr.#<col>, ws.#<col> = wr.#<col>
                                      SubqueryAlias: ws
                                        Projection: <exprs>
                                          SubqueryAlias: web_sales
                                            Projection: <exprs>
                                              Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                TableScan: ?table? projection=[_0, _3, _17, _18, _29, _33]
                                      SubqueryAlias: wr
                                        Projection: <exprs>
                                          SubqueryAlias: web_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _13, _14, _15]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]
        Projection: <exprs>
          SubqueryAlias: catalog
            Projection: <exprs>
              Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_cat
                        Projection: <exprs>
                          Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, Float64(0))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>, Float64(0))) AS sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(CAST(cr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(CAST(cs.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cs.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: cs.#<col> = CAST(date_dim.#<col> AS Float64)
                                Filter: cr.#<col> > Decimal128(Some(1000000),7,2)
                                  Projection: <exprs>
                                    Left Join: cs.#<col> = cr.#<col>, cs.#<col> = cr.#<col>
                                      SubqueryAlias: cs
                                        Projection: <exprs>
                                          SubqueryAlias: catalog_sales
                                            Projection: <exprs>
                                              Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                TableScan: ?table? projection=[_0, _15, _17, _18, _29, _33]
                                      SubqueryAlias: cr
                                        Projection: <exprs>
                                          SubqueryAlias: catalog_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _16, _17, _18]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]
        Projection: <exprs>
          SubqueryAlias: store
            Projection: <exprs>
              Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_store
                        Projection: <exprs>
                          Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, Float64(0))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>, Float64(0))) AS sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(CAST(sr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(CAST(sts.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sts.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: sts.#<col> = CAST(date_dim.#<col> AS Float64)
                                Filter: sr.#<col> > Decimal128(Some(1000000),7,2)
                                  Projection: <exprs>
                                    Left Join: sts.#<col> = sr.#<col>, sts.#<col> = sr.#<col>
                                      SubqueryAlias: sts
                                        Projection: <exprs>
                                          SubqueryAlias: store_sales
                                            Projection: <exprs>
                                              Filter: ?table?._22 > Decimal128(Some(100),6,2) AND ?table?._20 > Decimal128(Some(0),7,2) AND ?table?._10 > Float64(0)
                                                TableScan: ?table? projection=[_0, _2, _9, _10, _20, _22]
                                      SubqueryAlias: sr
                                        Projection: <exprs>
                                          SubqueryAlias: store_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _9, _10, _11]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]

logical_plan after push_down_filter:
Sort: <exprs>
  Projection: <exprs>
    Aggregate: groupBy=[[#<col>, #<col>, #<col>, #<col>, #<col>]], aggr=[[]]
      Union
        Projection: <exprs>
          SubqueryAlias: web
            Projection: <exprs>
              Projection: <exprs>
                Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_web
                        Projection: <exprs>
                          Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, Float64(0))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>, Float64(0))) AS sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(CAST(wr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(CAST(ws.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(ws.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: ws.#<col> = CAST(date_dim.#<col> AS Float64)
                                Projection: <exprs>
                                  Filter: wr.#<col> > Decimal128(Some(1000000),7,2)
                                    Left Join: ws.#<col> = wr.#<col>, ws.#<col> = wr.#<col>
                                      SubqueryAlias: ws
                                        Projection: <exprs>
                                          SubqueryAlias: web_sales
                                            Projection: <exprs>
                                              Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                TableScan: ?table? projection=[_0, _3, _17, _18, _29, _33]
                                      SubqueryAlias: wr
                                        Projection: <exprs>
                                          SubqueryAlias: web_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _13, _14, _15]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]
        Projection: <exprs>
          SubqueryAlias: catalog
            Projection: <exprs>
              Projection: <exprs>
                Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_cat
                        Projection: <exprs>
                          Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, Float64(0))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>, Float64(0))) AS sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(CAST(cr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(CAST(cs.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cs.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: cs.#<col> = CAST(date_dim.#<col> AS Float64)
                                Projection: <exprs>
                                  Filter: cr.#<col> > Decimal128(Some(1000000),7,2)
                                    Left Join: cs.#<col> = cr.#<col>, cs.#<col> = cr.#<col>
                                      SubqueryAlias: cs
                                        Projection: <exprs>
                                          SubqueryAlias: catalog_sales
                                            Projection: <exprs>
                                              Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                TableScan: ?table? projection=[_0, _15, _17, _18, _29, _33]
                                      SubqueryAlias: cr
                                        Projection: <exprs>
                                          SubqueryAlias: catalog_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _16, _17, _18]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]
        Projection: <exprs>
          SubqueryAlias: store
            Projection: <exprs>
              Projection: <exprs>
                Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_store
                        Projection: <exprs>
                          Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, Float64(0))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>, Float64(0))) AS sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(CAST(sr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(CAST(sts.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sts.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: sts.#<col> = CAST(date_dim.#<col> AS Float64)
                                Projection: <exprs>
                                  Filter: sr.#<col> > Decimal128(Some(1000000),7,2)
                                    Left Join: sts.#<col> = sr.#<col>, sts.#<col> = sr.#<col>
                                      SubqueryAlias: sts
                                        Projection: <exprs>
                                          SubqueryAlias: store_sales
                                            Projection: <exprs>
                                              Filter: ?table?._22 > Decimal128(Some(100),6,2) AND ?table?._20 > Decimal128(Some(0),7,2) AND ?table?._10 > Float64(0)
                                                TableScan: ?table? projection=[_0, _2, _9, _10, _20, _22]
                                      SubqueryAlias: sr
                                        Projection: <exprs>
                                          SubqueryAlias: store_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _9, _10, _11]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]

logical_plan after single_distinct_aggregation_to_group_by:
SAME TEXT AS ABOVE

logical_plan after eliminate_group_by_constant:
SAME TEXT AS ABOVE

logical_plan after common_sub_expression_eliminate:
SAME TEXT AS ABOVE

logical_plan after optimize_projections:
Sort: <exprs>
  Projection: <exprs>
    Aggregate: groupBy=[[#<col>, #<col>, #<col>, #<col>, #<col>]], aggr=[[]]
      Union
        Projection: <exprs>
          SubqueryAlias: web
            Projection: <exprs>
              Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_web
                        Projection: <exprs>
                          Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, Float64(0))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>, Float64(0))) AS sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(CAST(wr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(CAST(ws.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(ws.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: ws.#<col> = CAST(date_dim.#<col> AS Float64)
                                Filter: wr.#<col> > Decimal128(Some(1000000),7,2)
                                  Projection: <exprs>
                                    Left Join: ws.#<col> = wr.#<col>, ws.#<col> = wr.#<col>
                                      SubqueryAlias: ws
                                        Projection: <exprs>
                                          SubqueryAlias: web_sales
                                            Projection: <exprs>
                                              Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                TableScan: ?table? projection=[_0, _3, _17, _18, _29, _33]
                                      SubqueryAlias: wr
                                        Projection: <exprs>
                                          SubqueryAlias: web_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _13, _14, _15]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]
        Projection: <exprs>
          SubqueryAlias: catalog
            Projection: <exprs>
              Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_cat
                        Projection: <exprs>
                          Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, Float64(0))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>, Float64(0))) AS sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(CAST(cr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(CAST(cs.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cs.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: cs.#<col> = CAST(date_dim.#<col> AS Float64)
                                Filter: cr.#<col> > Decimal128(Some(1000000),7,2)
                                  Projection: <exprs>
                                    Left Join: cs.#<col> = cr.#<col>, cs.#<col> = cr.#<col>
                                      SubqueryAlias: cs
                                        Projection: <exprs>
                                          SubqueryAlias: catalog_sales
                                            Projection: <exprs>
                                              Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                TableScan: ?table? projection=[_0, _15, _17, _18, _29, _33]
                                      SubqueryAlias: cr
                                        Projection: <exprs>
                                          SubqueryAlias: catalog_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _16, _17, _18]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]
        Projection: <exprs>
          SubqueryAlias: store
            Projection: <exprs>
              Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_store
                        Projection: <exprs>
                          Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, Float64(0))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>, Float64(0))) AS sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(CAST(sr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(CAST(sts.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sts.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: sts.#<col> = CAST(date_dim.#<col> AS Float64)
                                Filter: sr.#<col> > Decimal128(Some(1000000),7,2)
                                  Projection: <exprs>
                                    Left Join: sts.#<col> = sr.#<col>, sts.#<col> = sr.#<col>
                                      SubqueryAlias: sts
                                        Projection: <exprs>
                                          SubqueryAlias: store_sales
                                            Projection: <exprs>
                                              Filter: ?table?._22 > Decimal128(Some(100),6,2) AND ?table?._20 > Decimal128(Some(0),7,2) AND ?table?._10 > Float64(0)
                                                TableScan: ?table? projection=[_0, _2, _9, _10, _20, _22]
                                      SubqueryAlias: sr
                                        Projection: <exprs>
                                          SubqueryAlias: store_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _9, _10, _11]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]

logical_plan after eliminate_nested_union:
SAME TEXT AS ABOVE

logical_plan after simplify_expressions:
SAME TEXT AS ABOVE

logical_plan after replace_distinct_aggregate:
SAME TEXT AS ABOVE

logical_plan after eliminate_join:
SAME TEXT AS ABOVE

logical_plan after decorrelate_predicate_subquery:
SAME TEXT AS ABOVE

logical_plan after scalar_subquery_to_join:
SAME TEXT AS ABOVE

logical_plan after decorrelate_lateral_join:
SAME TEXT AS ABOVE

logical_plan after extract_equijoin_predicate:
SAME TEXT AS ABOVE

logical_plan after eliminate_duplicated_expr:
SAME TEXT AS ABOVE

logical_plan after eliminate_filter:
SAME TEXT AS ABOVE

logical_plan after eliminate_cross_join:
SAME TEXT AS ABOVE

logical_plan after eliminate_limit:
SAME TEXT AS ABOVE

logical_plan after propagate_empty_relation:
SAME TEXT AS ABOVE

logical_plan after eliminate_one_union:
SAME TEXT AS ABOVE

logical_plan after filter_null_join_keys:
SAME TEXT AS ABOVE

logical_plan after eliminate_outer_join:
SAME TEXT AS ABOVE

logical_plan after push_down_limit:
SAME TEXT AS ABOVE

logical_plan after push_down_filter:
Sort: <exprs>
  Projection: <exprs>
    Aggregate: groupBy=[[#<col>, #<col>, #<col>, #<col>, #<col>]], aggr=[[]]
      Union
        Projection: <exprs>
          SubqueryAlias: web
            Projection: <exprs>
              Projection: <exprs>
                Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_web
                        Projection: <exprs>
                          Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, Float64(0))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>, Float64(0))) AS sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(CAST(wr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(CAST(ws.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(ws.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: ws.#<col> = CAST(date_dim.#<col> AS Float64)
                                Projection: <exprs>
                                  Filter: wr.#<col> > Decimal128(Some(1000000),7,2)
                                    Left Join: ws.#<col> = wr.#<col>, ws.#<col> = wr.#<col>
                                      SubqueryAlias: ws
                                        Projection: <exprs>
                                          SubqueryAlias: web_sales
                                            Projection: <exprs>
                                              Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                TableScan: ?table? projection=[_0, _3, _17, _18, _29, _33]
                                      SubqueryAlias: wr
                                        Projection: <exprs>
                                          SubqueryAlias: web_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _13, _14, _15]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]
        Projection: <exprs>
          SubqueryAlias: catalog
            Projection: <exprs>
              Projection: <exprs>
                Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_cat
                        Projection: <exprs>
                          Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, Float64(0))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>, Float64(0))) AS sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(CAST(cr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(CAST(cs.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cs.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: cs.#<col> = CAST(date_dim.#<col> AS Float64)
                                Projection: <exprs>
                                  Filter: cr.#<col> > Decimal128(Some(1000000),7,2)
                                    Left Join: cs.#<col> = cr.#<col>, cs.#<col> = cr.#<col>
                                      SubqueryAlias: cs
                                        Projection: <exprs>
                                          SubqueryAlias: catalog_sales
                                            Projection: <exprs>
                                              Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                TableScan: ?table? projection=[_0, _15, _17, _18, _29, _33]
                                      SubqueryAlias: cr
                                        Projection: <exprs>
                                          SubqueryAlias: catalog_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _16, _17, _18]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]
        Projection: <exprs>
          SubqueryAlias: store
            Projection: <exprs>
              Projection: <exprs>
                Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_store
                        Projection: <exprs>
                          Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, Float64(0))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>, Float64(0))) AS sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(CAST(sr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(CAST(sts.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sts.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: sts.#<col> = CAST(date_dim.#<col> AS Float64)
                                Projection: <exprs>
                                  Filter: sr.#<col> > Decimal128(Some(1000000),7,2)
                                    Left Join: sts.#<col> = sr.#<col>, sts.#<col> = sr.#<col>
                                      SubqueryAlias: sts
                                        Projection: <exprs>
                                          SubqueryAlias: store_sales
                                            Projection: <exprs>
                                              Filter: ?table?._22 > Decimal128(Some(100),6,2) AND ?table?._20 > Decimal128(Some(0),7,2) AND ?table?._10 > Float64(0)
                                                TableScan: ?table? projection=[_0, _2, _9, _10, _20, _22]
                                      SubqueryAlias: sr
                                        Projection: <exprs>
                                          SubqueryAlias: store_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _9, _10, _11]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]

logical_plan after single_distinct_aggregation_to_group_by:
SAME TEXT AS ABOVE

logical_plan after eliminate_group_by_constant:
SAME TEXT AS ABOVE

logical_plan after common_sub_expression_eliminate:
SAME TEXT AS ABOVE

logical_plan after optimize_projections:
Sort: <exprs>
  Projection: <exprs>
    Aggregate: groupBy=[[#<col>, #<col>, #<col>, #<col>, #<col>]], aggr=[[]]
      Union
        Projection: <exprs>
          SubqueryAlias: web
            Projection: <exprs>
              Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_web
                        Projection: <exprs>
                          Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, Float64(0))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>, Float64(0))) AS sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(CAST(wr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(CAST(ws.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(ws.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: ws.#<col> = CAST(date_dim.#<col> AS Float64)
                                Filter: wr.#<col> > Decimal128(Some(1000000),7,2)
                                  Projection: <exprs>
                                    Left Join: ws.#<col> = wr.#<col>, ws.#<col> = wr.#<col>
                                      SubqueryAlias: ws
                                        Projection: <exprs>
                                          SubqueryAlias: web_sales
                                            Projection: <exprs>
                                              Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                TableScan: ?table? projection=[_0, _3, _17, _18, _29, _33]
                                      SubqueryAlias: wr
                                        Projection: <exprs>
                                          SubqueryAlias: web_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _13, _14, _15]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]
        Projection: <exprs>
          SubqueryAlias: catalog
            Projection: <exprs>
              Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_cat
                        Projection: <exprs>
                          Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, Float64(0))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>, Float64(0))) AS sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(CAST(cr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(CAST(cs.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cs.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: cs.#<col> = CAST(date_dim.#<col> AS Float64)
                                Filter: cr.#<col> > Decimal128(Some(1000000),7,2)
                                  Projection: <exprs>
                                    Left Join: cs.#<col> = cr.#<col>, cs.#<col> = cr.#<col>
                                      SubqueryAlias: cs
                                        Projection: <exprs>
                                          SubqueryAlias: catalog_sales
                                            Projection: <exprs>
                                              Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                TableScan: ?table? projection=[_0, _15, _17, _18, _29, _33]
                                      SubqueryAlias: cr
                                        Projection: <exprs>
                                          SubqueryAlias: catalog_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _16, _17, _18]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]
        Projection: <exprs>
          SubqueryAlias: store
            Projection: <exprs>
              Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_store
                        Projection: <exprs>
                          Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, Float64(0))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>, Float64(0))) AS sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(CAST(sr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(CAST(sts.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sts.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: sts.#<col> = CAST(date_dim.#<col> AS Float64)
                                Filter: sr.#<col> > Decimal128(Some(1000000),7,2)
                                  Projection: <exprs>
                                    Left Join: sts.#<col> = sr.#<col>, sts.#<col> = sr.#<col>
                                      SubqueryAlias: sts
                                        Projection: <exprs>
                                          SubqueryAlias: store_sales
                                            Projection: <exprs>
                                              Filter: ?table?._22 > Decimal128(Some(100),6,2) AND ?table?._20 > Decimal128(Some(0),7,2) AND ?table?._10 > Float64(0)
                                                TableScan: ?table? projection=[_0, _2, _9, _10, _20, _22]
                                      SubqueryAlias: sr
                                        Projection: <exprs>
                                          SubqueryAlias: store_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _9, _10, _11]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]

logical_plan:
Sort: <exprs>
  Projection: <exprs>
    Aggregate: groupBy=[[#<col>, #<col>, #<col>, #<col>, #<col>]], aggr=[[]]
      Union
        Projection: <exprs>
          SubqueryAlias: web
            Projection: <exprs>
              Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_web
                        Projection: <exprs>
                          Aggregate: groupBy=[[ws.#<col>]], aggr=[[sum(coalesce(wr.#<col>, Float64(0))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>, Float64(0))) AS sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(CAST(wr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(CAST(ws.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(ws.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: ws.#<col> = CAST(date_dim.#<col> AS Float64)
                                Filter: wr.#<col> > Decimal128(Some(1000000),7,2)
                                  Projection: <exprs>
                                    Left Join: ws.#<col> = wr.#<col>, ws.#<col> = wr.#<col>
                                      SubqueryAlias: ws
                                        Projection: <exprs>
                                          SubqueryAlias: web_sales
                                            Projection: <exprs>
                                              Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                TableScan: ?table? projection=[_0, _3, _17, _18, _29, _33]
                                      SubqueryAlias: wr
                                        Projection: <exprs>
                                          SubqueryAlias: web_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _13, _14, _15]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]
        Projection: <exprs>
          SubqueryAlias: catalog
            Projection: <exprs>
              Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_cat
                        Projection: <exprs>
                          Aggregate: groupBy=[[cs.#<col>]], aggr=[[sum(coalesce(cr.#<col>, Float64(0))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>, Float64(0))) AS sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(CAST(cr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(CAST(cs.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(cs.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: cs.#<col> = CAST(date_dim.#<col> AS Float64)
                                Filter: cr.#<col> > Decimal128(Some(1000000),7,2)
                                  Projection: <exprs>
                                    Left Join: cs.#<col> = cr.#<col>, cs.#<col> = cr.#<col>
                                      SubqueryAlias: cs
                                        Projection: <exprs>
                                          SubqueryAlias: catalog_sales
                                            Projection: <exprs>
                                              Filter: ?table?._33 > Decimal128(Some(100),7,2) AND ?table?._29 > Decimal128(Some(0),7,2) AND ?table?._18 > Float64(0)
                                                TableScan: ?table? projection=[_0, _15, _17, _18, _29, _33]
                                      SubqueryAlias: cr
                                        Projection: <exprs>
                                          SubqueryAlias: catalog_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _16, _17, _18]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]
        Projection: <exprs>
          SubqueryAlias: store
            Projection: <exprs>
              Filter: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10) OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW <= UInt64(10)
                Projection: <exprs>
                  WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                    WindowAggr: windowExpr=[[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW]]
                      SubqueryAlias: in_store
                        Projection: <exprs>
                          Aggregate: groupBy=[[sts.#<col>]], aggr=[[sum(coalesce(sr.#<col>, Float64(0))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>, Float64(0))) AS sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(CAST(sr.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(CAST(sts.#<col> AS Decimal128(12, 2)), Decimal128(Some(0),12,2))) AS sum(coalesce(sts.#<col>,Int32(0)))]]
                            Projection: <exprs>
                              Inner Join: sts.#<col> = CAST(date_dim.#<col> AS Float64)
                                Filter: sr.#<col> > Decimal128(Some(1000000),7,2)
                                  Projection: <exprs>
                                    Left Join: sts.#<col> = sr.#<col>, sts.#<col> = sr.#<col>
                                      SubqueryAlias: sts
                                        Projection: <exprs>
                                          SubqueryAlias: store_sales
                                            Projection: <exprs>
                                              Filter: ?table?._22 > Decimal128(Some(100),6,2) AND ?table?._20 > Decimal128(Some(0),7,2) AND ?table?._10 > Float64(0)
                                                TableScan: ?table? projection=[_0, _2, _9, _10, _20, _22]
                                      SubqueryAlias: sr
                                        Projection: <exprs>
                                          SubqueryAlias: store_returns
                                            Projection: <exprs>
                                              TableScan: ?table? projection=[_2, _9, _10, _11]
                                Projection: <exprs>
                                  SubqueryAlias: date_dim
                                    Projection: <exprs>
                                      Filter: ?table?._6 = Int64(2000) AND ?table?._8 = Int64(12)
                                        TableScan: ?table? projection=[_0, _6, _8]

initial_physical_plan:
SortExec: [<sort_exprs>], fetch=100
  SortExec: expr=[<exprs>]
    ProjectionExec: expr=[<exprs>]
      AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[]
        CoalesceBatchesExec: target_batch_size=8192
          RepartitionExec: partitioning=Hash([#<col>, #<col>, #<col>, #<col>, #<col>], <partitions>), input_partitions=<partitions>
            AggregateExec: mode=Partial, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[], ordering_mode=PartiallySorted([0, 4])
              UnionExec
                ProjectionExec: expr=[<exprs>]
                  ProjectionExec: expr=[<exprs>]
                    CoalesceBatchesExec: target_batch_size=8192
                      FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                          ProjectionExec: expr=[<exprs>]
                            BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                              SortExec: expr=[<exprs>]
                                BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                  SortExec: [<sort_exprs>]
                                    SortExec: expr=[<exprs>]
                                      ProjectionExec: expr=[<exprs>]
                                        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))]
                                          CoalesceBatchesExec: target_batch_size=8192
                                            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                              AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))]
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                    CoalescePartitionsExec
                                                      CoalesceBatchesExec: target_batch_size=8192
                                                        FilterExec: #<col> > Some(1000000),7,2
                                                          ProjectionExec: expr=[<exprs>]
                                                            CoalesceBatchesExec: target_batch_size=8192
                                                              HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                ProjectionExec: expr=[<exprs>]
                                                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                  ProjectionExec: expr=[<exprs>]
                                                                    CoalesceBatchesExec: target_batch_size=8192
                                                                      FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _3@<id>, _17@<id>, _18@<id>, _29@<id>]
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                    ProjectionExec: expr=[<exprs>]
                                                      CoalesceBatchesExec: target_batch_size=8192
                                                        FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                            DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                ProjectionExec: expr=[<exprs>]
                  ProjectionExec: expr=[<exprs>]
                    CoalesceBatchesExec: target_batch_size=8192
                      FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                          ProjectionExec: expr=[<exprs>]
                            BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                              SortExec: expr=[<exprs>]
                                BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                  SortExec: [<sort_exprs>]
                                    SortExec: expr=[<exprs>]
                                      ProjectionExec: expr=[<exprs>]
                                        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))]
                                          CoalesceBatchesExec: target_batch_size=8192
                                            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                              AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))]
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                    CoalescePartitionsExec
                                                      CoalesceBatchesExec: target_batch_size=8192
                                                        FilterExec: #<col> > Some(1000000),7,2
                                                          ProjectionExec: expr=[<exprs>]
                                                            CoalesceBatchesExec: target_batch_size=8192
                                                              HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                ProjectionExec: expr=[<exprs>]
                                                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                ProjectionExec: expr=[<exprs>]
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _15@<id>, _17@<id>, _18@<id>, _29@<id>]
                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                    ProjectionExec: expr=[<exprs>]
                                                      CoalesceBatchesExec: target_batch_size=8192
                                                        FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                            DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                ProjectionExec: expr=[<exprs>]
                  ProjectionExec: expr=[<exprs>]
                    CoalesceBatchesExec: target_batch_size=8192
                      FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                          ProjectionExec: expr=[<exprs>]
                            BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                              SortExec: expr=[<exprs>]
                                BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                  SortExec: [<sort_exprs>]
                                    SortExec: expr=[<exprs>]
                                      ProjectionExec: expr=[<exprs>]
                                        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))]
                                          CoalesceBatchesExec: target_batch_size=8192
                                            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                              AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))]
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                    CoalescePartitionsExec
                                                      CoalesceBatchesExec: target_batch_size=8192
                                                        FilterExec: #<col> > Some(1000000),7,2
                                                          ProjectionExec: expr=[<exprs>]
                                                            CoalesceBatchesExec: target_batch_size=8192
                                                              HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                ProjectionExec: expr=[<exprs>]
                                                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                ProjectionExec: expr=[<exprs>]
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: _22@<id> > Some(100),6,2 AND _20@<id> > Some(0),7,2 AND _10@<id> > 0, projection=[_0@<id>, _2@<id>, _9@<id>, _10@<id>, _20@<id>]
                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                    ProjectionExec: expr=[<exprs>]
                                                      CoalesceBatchesExec: target_batch_size=8192
                                                        FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                            DataSourceExec: partitions=1, partition_sizes=[<sizes>]


initial_physical_plan_with_stats:
SortExec: [<sort_exprs>]
  SortExec: expr=[<exprs>]
    ProjectionExec: expr=[<exprs>]
      AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[], statistics=[Rows=Inexact(404), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
        CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(404), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
          RepartitionExec: partitioning=Hash([#<col>, #<col>, #<col>, #<col>, #<col>], <partitions>), input_partitions=<partitions>, statistics=[Rows=Inexact(404), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
            AggregateExec: mode=Partial, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[], ordering_mode=PartiallySorted([0, 4]), statistics=[Rows=Inexact(404), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
              UnionExec, statistics=[Rows=Inexact(404), Bytes=Inexact(<bytes>), [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
                ProjectionExec: expr=[<exprs>]
                  ProjectionExec: expr=[<exprs>]
                    CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(58), Bytes=Inexact(<bytes>), [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:)]]
                      FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10, statistics=[Rows=Inexact(58), Bytes=Inexact(<bytes>), [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:)]]
                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, statistics=[Rows=Inexact(289), Bytes=Inexact(<bytes>), [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:)]]
                          ProjectionExec: expr=[<exprs>]
                            BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted], statistics=[Rows=Inexact(289), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
                              SortExec: expr=[<exprs>]
                                BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted], statistics=[Rows=Inexact(289), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:)]]
                                  SortExec: [<sort_exprs>]
                                    SortExec: expr=[<exprs>]
                                      ProjectionExec: expr=[<exprs>]
                                        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))], statistics=[Rows=Inexact(289), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
                                          CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(289), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
                                            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>, statistics=[Rows=Inexact(289), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
                                              AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))], statistics=[Rows=Inexact(289), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
                                                CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(289), Bytes=Absent, [(Col[0]: Null=Inexact(0)),(Col[1]: Null=Inexact(3)),(Col[2]: Null=Inexact(4)),(Col[3]: Null=Inexact(29)),(Col[4]: Null=Inexact(35))]]
                                                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>], statistics=[Rows=Inexact(289), Bytes=Absent, [(Col[0]: Null=Inexact(0)),(Col[1]: Null=Inexact(3)),(Col[2]: Null=Inexact(4)),(Col[3]: Null=Inexact(29)),(Col[4]: Null=Inexact(35))]]
                                                    CoalescePartitionsExec, statistics=[Rows=Inexact(289), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(4)),(Col[1]: Null=Inexact(0)),(Col[2]: Null=Inexact(3)),(Col[3]: Null=Inexact(4)),(Col[4]: Null=Inexact(29)),(Col[5]: Null=Inexact(35))]]
                                                      CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(289), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(4)),(Col[1]: Null=Inexact(0)),(Col[2]: Null=Inexact(3)),(Col[3]: Null=Inexact(4)),(Col[4]: Null=Inexact(29)),(Col[5]: Null=Inexact(35))]]
                                                        FilterExec: #<col> > Some(1000000),7,2, statistics=[Rows=Inexact(289), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(4)),(Col[1]: Null=Inexact(0)),(Col[2]: Null=Inexact(3)),(Col[3]: Null=Inexact(4)),(Col[4]: Null=Inexact(29)),(Col[5]: Null=Inexact(35))]]
                                                          ProjectionExec: expr=[<exprs>]
                                                            CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(1443), Bytes=Absent, [(Col[0]: Null=Exact(29)),(Col[1]: Null=Exact(35)),(Col[2]: Null=Inexact(4)),(Col[3]: Null=Inexact(0)),(Col[4]: Null=Inexact(3)),(Col[5]: Null=Inexact(4))]]
                                                              HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>], statistics=[Rows=Inexact(1443), Bytes=Absent, [(Col[0]: Null=Exact(29)),(Col[1]: Null=Exact(35)),(Col[2]: Null=Inexact(4)),(Col[3]: Null=Inexact(0)),(Col[4]: Null=Inexact(3)),(Col[5]: Null=Inexact(4))]]
                                                                ProjectionExec: expr=[<exprs>]
                                                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>], statistics=[Rows=Exact(679), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(0)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(29)),(Col[3]: Null=Exact(35))]]
                                                                RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, statistics=[Rows=Inexact(1443), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(4)),(Col[1]: Null=Inexact(0)),(Col[2]: Null=Inexact(0)),(Col[3]: Null=Inexact(3)),(Col[4]: Null=Inexact(4))]]
                                                                  ProjectionExec: expr=[<exprs>]
                                                                    CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(1443), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(4)),(Col[1]: Null=Inexact(0)),(Col[2]: Null=Inexact(0)),(Col[3]: Null=Inexact(3)),(Col[4]: Null=Inexact(4))]]
                                                                      FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _3@<id>, _17@<id>, _18@<id>, _29@<id>], statistics=[Rows=Inexact(1443), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(4)),(Col[1]: Null=Inexact(0)),(Col[2]: Null=Inexact(0)),(Col[3]: Null=Inexact(3)),(Col[4]: Null=Inexact(4))]]
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>], statistics=[Rows=Exact(7212), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(4)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(0)),(Col[3]: Null=Exact(3)),(Col[4]: Null=Exact(4)),(Col[5]: Null=Exact(0))]]
                                                    ProjectionExec: expr=[<exprs>]
                                                      CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(14610), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(0))]]
                                                        FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>], statistics=[Rows=Inexact(14610), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(0))]]
                                                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, statistics=[Rows=Exact(73049), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(0)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(0))]]
                                                            DataSourceExec: partitions=1, partition_sizes=[<sizes>], statistics=[Rows=Exact(73049), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(0)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(0))]]
                ProjectionExec: expr=[<exprs>]
                  ProjectionExec: expr=[<exprs>]
                    CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(115), Bytes=Inexact(<bytes>), [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:)]]
                      FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10, statistics=[Rows=Inexact(115), Bytes=Inexact(<bytes>), [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:)]]
                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, statistics=[Rows=Inexact(573), Bytes=Inexact(<bytes>), [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:)]]
                          ProjectionExec: expr=[<exprs>]
                            BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted], statistics=[Rows=Inexact(573), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
                              SortExec: expr=[<exprs>]
                                BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted], statistics=[Rows=Inexact(573), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:)]]
                                  SortExec: [<sort_exprs>]
                                    SortExec: expr=[<exprs>]
                                      ProjectionExec: expr=[<exprs>]
                                        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))], statistics=[Rows=Inexact(573), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
                                          CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(573), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
                                            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>, statistics=[Rows=Inexact(573), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
                                              AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))], statistics=[Rows=Inexact(573), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
                                                CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(573), Bytes=Absent, [(Col[0]: Null=Inexact(0)),(Col[1]: Null=Inexact(72)),(Col[2]: Null=Inexact(95)),(Col[3]: Null=Inexact(33)),(Col[4]: Null=Inexact(28))]]
                                                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>], statistics=[Rows=Inexact(573), Bytes=Absent, [(Col[0]: Null=Inexact(0)),(Col[1]: Null=Inexact(72)),(Col[2]: Null=Inexact(95)),(Col[3]: Null=Inexact(33)),(Col[4]: Null=Inexact(28))]]
                                                    CoalescePartitionsExec, statistics=[Rows=Inexact(573), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(81)),(Col[1]: Null=Inexact(0)),(Col[2]: Null=Inexact(72)),(Col[3]: Null=Inexact(95)),(Col[4]: Null=Inexact(33)),(Col[5]: Null=Inexact(28))]]
                                                      CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(573), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(81)),(Col[1]: Null=Inexact(0)),(Col[2]: Null=Inexact(72)),(Col[3]: Null=Inexact(95)),(Col[4]: Null=Inexact(33)),(Col[5]: Null=Inexact(28))]]
                                                        FilterExec: #<col> > Some(1000000),7,2, statistics=[Rows=Inexact(573), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(81)),(Col[1]: Null=Inexact(0)),(Col[2]: Null=Inexact(72)),(Col[3]: Null=Inexact(95)),(Col[4]: Null=Inexact(33)),(Col[5]: Null=Inexact(28))]]
                                                          ProjectionExec: expr=[<exprs>]
                                                            CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(2863), Bytes=Absent, [(Col[0]: Null=Exact(33)),(Col[1]: Null=Exact(28)),(Col[2]: Null=Inexact(81)),(Col[3]: Null=Inexact(0)),(Col[4]: Null=Inexact(72)),(Col[5]: Null=Inexact(95))]]
                                                              HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>], statistics=[Rows=Inexact(2863), Bytes=Absent, [(Col[0]: Null=Exact(33)),(Col[1]: Null=Exact(28)),(Col[2]: Null=Inexact(81)),(Col[3]: Null=Inexact(0)),(Col[4]: Null=Inexact(72)),(Col[5]: Null=Inexact(95))]]
                                                                ProjectionExec: expr=[<exprs>]
                                                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>], statistics=[Rows=Exact(1358), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(0)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(33)),(Col[3]: Null=Exact(28))]]
                                                                ProjectionExec: expr=[<exprs>]
                                                                  CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(2863), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(81)),(Col[1]: Null=Inexact(0)),(Col[2]: Null=Inexact(0)),(Col[3]: Null=Inexact(72)),(Col[4]: Null=Inexact(95))]]
                                                                    FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _15@<id>, _17@<id>, _18@<id>, _29@<id>], statistics=[Rows=Inexact(2863), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(81)),(Col[1]: Null=Inexact(0)),(Col[2]: Null=Inexact(0)),(Col[3]: Null=Inexact(72)),(Col[4]: Null=Inexact(95))]]
                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, statistics=[Rows=Exact(14313), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(81)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(0)),(Col[3]: Null=Exact(72)),(Col[4]: Null=Exact(95)),(Col[5]: Null=Exact(0))]]
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>], statistics=[Rows=Exact(14313), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(81)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(0)),(Col[3]: Null=Exact(72)),(Col[4]: Null=Exact(95)),(Col[5]: Null=Exact(0))]]
                                                    ProjectionExec: expr=[<exprs>]
                                                      CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(14610), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(0))]]
                                                        FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>], statistics=[Rows=Inexact(14610), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(0))]]
                                                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, statistics=[Rows=Exact(73049), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(0)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(0))]]
                                                            DataSourceExec: partitions=1, partition_sizes=[<sizes>], statistics=[Rows=Exact(73049), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(0)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(0))]]
                ProjectionExec: expr=[<exprs>]
                  ProjectionExec: expr=[<exprs>]
                    CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(231), Bytes=Inexact(<bytes>), [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:)]]
                      FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10, statistics=[Rows=Inexact(231), Bytes=Inexact(<bytes>), [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:)]]
                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, statistics=[Rows=Inexact(1153), Bytes=Inexact(<bytes>), [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:)]]
                          ProjectionExec: expr=[<exprs>]
                            BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted], statistics=[Rows=Inexact(1153), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
                              SortExec: expr=[<exprs>]
                                BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted], statistics=[Rows=Inexact(1153), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:)]]
                                  SortExec: [<sort_exprs>]
                                    SortExec: expr=[<exprs>]
                                      ProjectionExec: expr=[<exprs>]
                                        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))], statistics=[Rows=Inexact(1153), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
                                          CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(1153), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
                                            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>, statistics=[Rows=Inexact(1153), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
                                              AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))], statistics=[Rows=Inexact(1153), Bytes=Absent, [(Col[0]:),(Col[1]:),(Col[2]:),(Col[3]:),(Col[4]:)]]
                                                CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(1153), Bytes=Absent, [(Col[0]: Null=Inexact(0)),(Col[1]: Null=Inexact(1283)),(Col[2]: Null=Inexact(1267)),(Col[3]: Null=Inexact(111)),(Col[4]: Null=Inexact(104))]]
                                                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>], statistics=[Rows=Inexact(1153), Bytes=Absent, [(Col[0]: Null=Inexact(0)),(Col[1]: Null=Inexact(1283)),(Col[2]: Null=Inexact(1267)),(Col[3]: Null=Inexact(111)),(Col[4]: Null=Inexact(104))]]
                                                    CoalescePartitionsExec, statistics=[Rows=Inexact(1153), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(1208)),(Col[1]: Null=Inexact(0)),(Col[2]: Null=Inexact(1283)),(Col[3]: Null=Inexact(1267)),(Col[4]: Null=Inexact(111)),(Col[5]: Null=Inexact(104))]]
                                                      CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(1153), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(1208)),(Col[1]: Null=Inexact(0)),(Col[2]: Null=Inexact(1283)),(Col[3]: Null=Inexact(1267)),(Col[4]: Null=Inexact(111)),(Col[5]: Null=Inexact(104))]]
                                                        FilterExec: #<col> > Some(1000000),7,2, statistics=[Rows=Inexact(1153), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(1208)),(Col[1]: Null=Inexact(0)),(Col[2]: Null=Inexact(1283)),(Col[3]: Null=Inexact(1267)),(Col[4]: Null=Inexact(111)),(Col[5]: Null=Inexact(104))]]
                                                          ProjectionExec: expr=[<exprs>]
                                                            CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(5762), Bytes=Absent, [(Col[0]: Null=Exact(111)),(Col[1]: Null=Exact(104)),(Col[2]: Null=Inexact(1208)),(Col[3]: Null=Inexact(0)),(Col[4]: Null=Inexact(1283)),(Col[5]: Null=Inexact(1267))]]
                                                              HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>], statistics=[Rows=Inexact(5762), Bytes=Absent, [(Col[0]: Null=Exact(111)),(Col[1]: Null=Exact(104)),(Col[2]: Null=Inexact(1208)),(Col[3]: Null=Inexact(0)),(Col[4]: Null=Inexact(1283)),(Col[5]: Null=Inexact(1267))]]
                                                                ProjectionExec: expr=[<exprs>]
                                                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>], statistics=[Rows=Exact(2810), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(0)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(111)),(Col[3]: Null=Exact(104))]]
                                                                ProjectionExec: expr=[<exprs>]
                                                                  CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(5762), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(1208)),(Col[1]: Null=Inexact(0)),(Col[2]: Null=Inexact(0)),(Col[3]: Null=Inexact(1283)),(Col[4]: Null=Inexact(1267))]]
                                                                    FilterExec: _22@<id> > Some(100),6,2 AND _20@<id> > Some(0),7,2 AND _10@<id> > 0, projection=[_0@<id>, _2@<id>, _9@<id>, _10@<id>, _20@<id>], statistics=[Rows=Inexact(5762), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(1208)),(Col[1]: Null=Inexact(0)),(Col[2]: Null=Inexact(0)),(Col[3]: Null=Inexact(1283)),(Col[4]: Null=Inexact(1267))]]
                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, statistics=[Rows=Exact(28810), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(1208)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(0)),(Col[3]: Null=Exact(1283)),(Col[4]: Null=Exact(1267)),(Col[5]: Null=Exact(1260))]]
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>], statistics=[Rows=Exact(28810), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(1208)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(0)),(Col[3]: Null=Exact(1283)),(Col[4]: Null=Exact(1267)),(Col[5]: Null=Exact(1260))]]
                                                    ProjectionExec: expr=[<exprs>]
                                                      CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(14610), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(0))]]
                                                        FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>], statistics=[Rows=Inexact(14610), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(0))]]
                                                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, statistics=[Rows=Exact(73049), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(0)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(0))]]
                                                            DataSourceExec: partitions=1, partition_sizes=[<sizes>], statistics=[Rows=Exact(73049), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(0)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(0))]]


initial_physical_plan_with_schema:
SortExec: [<sort_exprs>]
  SortExec: expr=[<exprs>]
    ProjectionExec: expr=[<exprs>]
      AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[], schema=[#<col>:Utf8, #<col>:Int64;N, #<col>:Decimal128(23, 8);N, #<col>:Int32, #<col>:Int32]
        CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Utf8, #<col>:Int64;N, #<col>:Decimal128(23, 8);N, #<col>:Int32, #<col>:Int32]
          RepartitionExec: partitioning=Hash([#<col>, #<col>, #<col>, #<col>, #<col>], <partitions>), input_partitions=<partitions>, schema=[#<col>:Utf8, #<col>:Int64;N, #<col>:Decimal128(23, 8);N, #<col>:Int32, #<col>:Int32]
            AggregateExec: mode=Partial, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[], ordering_mode=PartiallySorted([0, 4]), schema=[#<col>:Utf8, #<col>:Int64;N, #<col>:Decimal128(23, 8);N, #<col>:Int32, #<col>:Int32]
              UnionExec, schema=[#<col>:Utf8, #<col>:Int64;N, #<col>:Decimal128(23, 8);N, #<col>:Int32, #<col>:Int32]
                ProjectionExec: expr=[<exprs>]
                  ProjectionExec: expr=[<exprs>]
                    CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Int64;N, #<col>:Decimal128(23, 8);N, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64]
                      FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10, schema=[#<col>:Int64;N, #<col>:Decimal128(23, 8);N, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64]
                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, schema=[#<col>:Int64;N, #<col>:Decimal128(23, 8);N, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64]
                          ProjectionExec: expr=[<exprs>]
                            BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted], schema=[#<col>:Int64;N, #<col>:Decimal128(23, 8);N, #<col>:Decimal128(23, 8);N, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64]
                              SortExec: expr=[<exprs>]
                                BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted], schema=[#<col>:Int64;N, #<col>:Decimal128(23, 8);N, #<col>:Decimal128(23, 8);N, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64]
                                  SortExec: [<sort_exprs>]
                                    SortExec: expr=[<exprs>]
                                      ProjectionExec: expr=[<exprs>]
                                        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))], schema=[#<col>:Int64;N, sum(coalesce(wr.#<col>,Int32(0))):Float64;N, sum(coalesce(ws.#<col>,Int32(0))):Float64;N, sum(coalesce(wr.#<col>,Int32(0))):Decimal128(22, 2);N, sum(coalesce(ws.#<col>,Int32(0))):Decimal128(22, 2);N]
                                          CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Int64;N, sum(coalesce(wr.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(ws.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(wr.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N, sum(coalesce(ws.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N]
                                            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>, schema=[#<col>:Int64;N, sum(coalesce(wr.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(ws.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(wr.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N, sum(coalesce(ws.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N]
                                              AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))], schema=[#<col>:Int64;N, sum(coalesce(wr.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(ws.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(wr.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N, sum(coalesce(ws.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N]
                                                CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>], schema=[#<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                    CoalescePartitionsExec, schema=[#<col>:Float64;N, #<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                      CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Float64;N, #<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                        FilterExec: #<col> > Some(1000000),7,2, schema=[#<col>:Float64;N, #<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                          ProjectionExec: expr=[<exprs>]
                                                            CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                              HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>], schema=[#<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                                ProjectionExec: expr=[<exprs>]
                                                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>], schema=[_2:Int64;N, _13:Int64;N, _14:Float64;N, _15:Decimal128(7, 2);N]
                                                                RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, schema=[#<col>:Float64;N, #<col>:Int64;N, #<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                                  ProjectionExec: expr=[<exprs>]
                                                                    CoalesceBatchesExec: target_batch_size=8192, schema=[_0:Float64;N, _3:Int64;N, _17:Int64;N, _18:Float64;N, _29:Decimal128(7, 2);N]
                                                                      FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _3@<id>, _17@<id>, _18@<id>, _29@<id>], schema=[_0:Float64;N, _3:Int64;N, _17:Int64;N, _18:Float64;N, _29:Decimal128(7, 2);N]
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>], schema=[_0:Float64;N, _3:Int64;N, _17:Int64;N, _18:Float64;N, _29:Decimal128(7, 2);N, _33:Decimal128(7, 2);N]
                                                    ProjectionExec: expr=[<exprs>]
                                                      CoalesceBatchesExec: target_batch_size=8192, schema=[_0:Int64;N]
                                                        FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>], schema=[_0:Int64;N]
                                                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, schema=[_0:Int64;N, _6:Int64;N, _8:Int64;N]
                                                            DataSourceExec: partitions=1, partition_sizes=[<sizes>], schema=[_0:Int64;N, _6:Int64;N, _8:Int64;N]
                ProjectionExec: expr=[<exprs>]
                  ProjectionExec: expr=[<exprs>]
                    CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Int64;N, #<col>:Decimal128(23, 8);N, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64]
                      FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10, schema=[#<col>:Int64;N, #<col>:Decimal128(23, 8);N, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64]
                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, schema=[#<col>:Int64;N, #<col>:Decimal128(23, 8);N, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64]
                          ProjectionExec: expr=[<exprs>]
                            BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted], schema=[#<col>:Int64;N, #<col>:Decimal128(23, 8);N, #<col>:Decimal128(23, 8);N, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64]
                              SortExec: expr=[<exprs>]
                                BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted], schema=[#<col>:Int64;N, #<col>:Decimal128(23, 8);N, #<col>:Decimal128(23, 8);N, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64]
                                  SortExec: [<sort_exprs>]
                                    SortExec: expr=[<exprs>]
                                      ProjectionExec: expr=[<exprs>]
                                        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))], schema=[#<col>:Int64;N, sum(coalesce(cr.#<col>,Int32(0))):Float64;N, sum(coalesce(cs.#<col>,Int32(0))):Float64;N, sum(coalesce(cr.#<col>,Int32(0))):Decimal128(22, 2);N, sum(coalesce(cs.#<col>,Int32(0))):Decimal128(22, 2);N]
                                          CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Int64;N, sum(coalesce(cr.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(cs.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(cr.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N, sum(coalesce(cs.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N]
                                            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>, schema=[#<col>:Int64;N, sum(coalesce(cr.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(cs.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(cr.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N, sum(coalesce(cs.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N]
                                              AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))], schema=[#<col>:Int64;N, sum(coalesce(cr.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(cs.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(cr.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N, sum(coalesce(cs.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N]
                                                CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>], schema=[#<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                    CoalescePartitionsExec, schema=[#<col>:Float64;N, #<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                      CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Float64;N, #<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                        FilterExec: #<col> > Some(1000000),7,2, schema=[#<col>:Float64;N, #<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                          ProjectionExec: expr=[<exprs>]
                                                            CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                              HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>], schema=[#<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                                ProjectionExec: expr=[<exprs>]
                                                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>], schema=[_2:Int64;N, _16:Int64;N, _17:Float64;N, _18:Decimal128(7, 2);N]
                                                                ProjectionExec: expr=[<exprs>]
                                                                  CoalesceBatchesExec: target_batch_size=8192, schema=[_0:Float64;N, _15:Int64;N, _17:Int64;N, _18:Float64;N, _29:Decimal128(7, 2);N]
                                                                    FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _15@<id>, _17@<id>, _18@<id>, _29@<id>], schema=[_0:Float64;N, _15:Int64;N, _17:Int64;N, _18:Float64;N, _29:Decimal128(7, 2);N]
                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, schema=[_0:Float64;N, _15:Int64;N, _17:Int64;N, _18:Float64;N, _29:Decimal128(7, 2);N, _33:Decimal128(7, 2);N]
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>], schema=[_0:Float64;N, _15:Int64;N, _17:Int64;N, _18:Float64;N, _29:Decimal128(7, 2);N, _33:Decimal128(7, 2);N]
                                                    ProjectionExec: expr=[<exprs>]
                                                      CoalesceBatchesExec: target_batch_size=8192, schema=[_0:Int64;N]
                                                        FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>], schema=[_0:Int64;N]
                                                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, schema=[_0:Int64;N, _6:Int64;N, _8:Int64;N]
                                                            DataSourceExec: partitions=1, partition_sizes=[<sizes>], schema=[_0:Int64;N, _6:Int64;N, _8:Int64;N]
                ProjectionExec: expr=[<exprs>]
                  ProjectionExec: expr=[<exprs>]
                    CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Int64;N, #<col>:Decimal128(23, 8);N, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64]
                      FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10, schema=[#<col>:Int64;N, #<col>:Decimal128(23, 8);N, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64]
                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, schema=[#<col>:Int64;N, #<col>:Decimal128(23, 8);N, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64]
                          ProjectionExec: expr=[<exprs>]
                            BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted], schema=[#<col>:Int64;N, #<col>:Decimal128(23, 8);N, #<col>:Decimal128(23, 8);N, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64]
                              SortExec: expr=[<exprs>]
                                BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted], schema=[#<col>:Int64;N, #<col>:Decimal128(23, 8);N, #<col>:Decimal128(23, 8);N, rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW:UInt64]
                                  SortExec: [<sort_exprs>]
                                    SortExec: expr=[<exprs>]
                                      ProjectionExec: expr=[<exprs>]
                                        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))], schema=[#<col>:Int64;N, sum(coalesce(sr.#<col>,Int32(0))):Float64;N, sum(coalesce(sts.#<col>,Int32(0))):Float64;N, sum(coalesce(sr.#<col>,Int32(0))):Decimal128(22, 2);N, sum(coalesce(sts.#<col>,Int32(0))):Decimal128(22, 2);N]
                                          CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Int64;N, sum(coalesce(sr.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(sts.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(sr.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N, sum(coalesce(sts.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N]
                                            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>, schema=[#<col>:Int64;N, sum(coalesce(sr.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(sts.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(sr.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N, sum(coalesce(sts.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N]
                                              AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))], schema=[#<col>:Int64;N, sum(coalesce(sr.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(sts.#<col>,Int32(0)))[sum]:Float64;N, sum(coalesce(sr.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N, sum(coalesce(sts.#<col>,Int32(0)))[sum]:Decimal128(22, 2);N]
                                                CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>], schema=[#<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                    CoalescePartitionsExec, schema=[#<col>:Float64;N, #<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                      CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Float64;N, #<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                        FilterExec: #<col> > Some(1000000),7,2, schema=[#<col>:Float64;N, #<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                          ProjectionExec: expr=[<exprs>]
                                                            CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                              HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>], schema=[#<col>:Float64;N, #<col>:Decimal128(7, 2);N, #<col>:Float64;N, #<col>:Int64;N, #<col>:Float64;N, #<col>:Decimal128(7, 2);N]
                                                                ProjectionExec: expr=[<exprs>]
                                                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>], schema=[_2:Int64;N, _9:Int64;N, _10:Float64;N, _11:Decimal128(7, 2);N]
                                                                ProjectionExec: expr=[<exprs>]
                                                                  CoalesceBatchesExec: target_batch_size=8192, schema=[_0:Float64;N, _2:Int64;N, _9:Int64;N, _10:Float64;N, _20:Decimal128(7, 2);N]
                                                                    FilterExec: _22@<id> > Some(100),6,2 AND _20@<id> > Some(0),7,2 AND _10@<id> > 0, projection=[_0@<id>, _2@<id>, _9@<id>, _10@<id>, _20@<id>], schema=[_0:Float64;N, _2:Int64;N, _9:Int64;N, _10:Float64;N, _20:Decimal128(7, 2);N]
                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, schema=[_0:Float64;N, _2:Int64;N, _9:Int64;N, _10:Float64;N, _20:Decimal128(7, 2);N, _22:Decimal128(6, 2);N]
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>], schema=[_0:Float64;N, _2:Int64;N, _9:Int64;N, _10:Float64;N, _20:Decimal128(7, 2);N, _22:Decimal128(6, 2);N]
                                                    ProjectionExec: expr=[<exprs>]
                                                      CoalesceBatchesExec: target_batch_size=8192, schema=[_0:Int64;N]
                                                        FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>], schema=[_0:Int64;N]
                                                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, schema=[_0:Int64;N, _6:Int64;N, _8:Int64;N]
                                                            DataSourceExec: partitions=1, partition_sizes=[<sizes>], schema=[_0:Int64;N, _6:Int64;N, _8:Int64;N]


physical_plan after OutputRequirements:
OutputRequirementExec: order_by=[(#<col>, asc), (#<col>, asc), (#<col>, asc), (#<col>, asc)], dist_by=SinglePartition
  SortExec: [<sort_exprs>], fetch=100
    SortExec: expr=[<exprs>]
      ProjectionExec: expr=[<exprs>]
        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[]
          CoalesceBatchesExec: target_batch_size=8192
            RepartitionExec: partitioning=Hash([#<col>, #<col>, #<col>, #<col>, #<col>], <partitions>), input_partitions=<partitions>
              AggregateExec: mode=Partial, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[], ordering_mode=PartiallySorted([0, 4])
                UnionExec
                  ProjectionExec: expr=[<exprs>]
                    ProjectionExec: expr=[<exprs>]
                      CoalesceBatchesExec: target_batch_size=8192
                        FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                            ProjectionExec: expr=[<exprs>]
                              BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                SortExec: expr=[<exprs>]
                                  BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                    SortExec: [<sort_exprs>]
                                      SortExec: expr=[<exprs>]
                                        ProjectionExec: expr=[<exprs>]
                                          AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))]
                                            CoalesceBatchesExec: target_batch_size=8192
                                              RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))]
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                      CoalescePartitionsExec
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          FilterExec: #<col> > Some(1000000),7,2
                                                            ProjectionExec: expr=[<exprs>]
                                                              CoalesceBatchesExec: target_batch_size=8192
                                                                HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                  ProjectionExec: expr=[<exprs>]
                                                                    DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                  RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                    ProjectionExec: expr=[<exprs>]
                                                                      CoalesceBatchesExec: target_batch_size=8192
                                                                        FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _3@<id>, _17@<id>, _18@<id>, _29@<id>]
                                                                          DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                      ProjectionExec: expr=[<exprs>]
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                  ProjectionExec: expr=[<exprs>]
                    ProjectionExec: expr=[<exprs>]
                      CoalesceBatchesExec: target_batch_size=8192
                        FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                            ProjectionExec: expr=[<exprs>]
                              BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                SortExec: expr=[<exprs>]
                                  BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                    SortExec: [<sort_exprs>]
                                      SortExec: expr=[<exprs>]
                                        ProjectionExec: expr=[<exprs>]
                                          AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))]
                                            CoalesceBatchesExec: target_batch_size=8192
                                              RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))]
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                      CoalescePartitionsExec
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          FilterExec: #<col> > Some(1000000),7,2
                                                            ProjectionExec: expr=[<exprs>]
                                                              CoalesceBatchesExec: target_batch_size=8192
                                                                HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                  ProjectionExec: expr=[<exprs>]
                                                                    DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                  ProjectionExec: expr=[<exprs>]
                                                                    CoalesceBatchesExec: target_batch_size=8192
                                                                      FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _15@<id>, _17@<id>, _18@<id>, _29@<id>]
                                                                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                          DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                      ProjectionExec: expr=[<exprs>]
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                  ProjectionExec: expr=[<exprs>]
                    ProjectionExec: expr=[<exprs>]
                      CoalesceBatchesExec: target_batch_size=8192
                        FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                            ProjectionExec: expr=[<exprs>]
                              BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                SortExec: expr=[<exprs>]
                                  BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                    SortExec: [<sort_exprs>]
                                      SortExec: expr=[<exprs>]
                                        ProjectionExec: expr=[<exprs>]
                                          AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))]
                                            CoalesceBatchesExec: target_batch_size=8192
                                              RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))]
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                      CoalescePartitionsExec
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          FilterExec: #<col> > Some(1000000),7,2
                                                            ProjectionExec: expr=[<exprs>]
                                                              CoalesceBatchesExec: target_batch_size=8192
                                                                HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                  ProjectionExec: expr=[<exprs>]
                                                                    DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                  ProjectionExec: expr=[<exprs>]
                                                                    CoalesceBatchesExec: target_batch_size=8192
                                                                      FilterExec: _22@<id> > Some(100),6,2 AND _20@<id> > Some(0),7,2 AND _10@<id> > 0, projection=[_0@<id>, _2@<id>, _9@<id>, _10@<id>, _20@<id>]
                                                                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                          DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                      ProjectionExec: expr=[<exprs>]
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]


physical_plan after aggregate_statistics:
SAME TEXT AS ABOVE

physical_plan after join_selection:
SAME TEXT AS ABOVE

physical_plan after LimitedDistinctAggregation:
SAME TEXT AS ABOVE

physical_plan after FilterPushdown:
SAME TEXT AS ABOVE

physical_plan after EnforceDistribution:
OutputRequirementExec: order_by=[(#<col>, asc), (#<col>, asc), (#<col>, asc), (#<col>, asc)], dist_by=SinglePartition
  SortExec: expr=[<exprs>]
    CoalescePartitionsExec
      SortExec: expr=[<exprs>]
        ProjectionExec: expr=[<exprs>]
          AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[]
            RepartitionExec: partitioning=Hash([#<col>, #<col>, #<col>, #<col>, #<col>], <partitions>), input_partitions=<partitions>
              CoalesceBatchesExec: target_batch_size=8192
                AggregateExec: mode=Partial, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[], ordering_mode=PartiallySorted([0, 4])
                  UnionExec
                    ProjectionExec: expr=[<exprs>]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192
                          FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                              ProjectionExec: expr=[<exprs>]
                                BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                  SortExec: expr=[<exprs>]
                                    BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                      SortExec: expr=[<exprs>]
                                        CoalescePartitionsExec
                                          SortExec: expr=[<exprs>]
                                            ProjectionExec: expr=[<exprs>]
                                              AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))]
                                                RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))]
                                                      CoalesceBatchesExec: target_batch_size=8192
                                                        HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                          CoalescePartitionsExec
                                                            CoalesceBatchesExec: target_batch_size=8192
                                                              FilterExec: #<col> > Some(1000000),7,2
                                                                ProjectionExec: expr=[<exprs>]
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                      ProjectionExec: expr=[<exprs>]
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                        ProjectionExec: expr=[<exprs>]
                                                                          CoalesceBatchesExec: target_batch_size=8192
                                                                            FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _3@<id>, _17@<id>, _18@<id>, _29@<id>]
                                                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                          ProjectionExec: expr=[<exprs>]
                                                            CoalesceBatchesExec: target_batch_size=8192
                                                              FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                                RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                    ProjectionExec: expr=[<exprs>]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192
                          FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                              ProjectionExec: expr=[<exprs>]
                                BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                  SortExec: expr=[<exprs>]
                                    BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                      SortExec: expr=[<exprs>]
                                        CoalescePartitionsExec
                                          SortExec: expr=[<exprs>]
                                            ProjectionExec: expr=[<exprs>]
                                              AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))]
                                                RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))]
                                                      CoalesceBatchesExec: target_batch_size=8192
                                                        HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                          CoalescePartitionsExec
                                                            CoalesceBatchesExec: target_batch_size=8192
                                                              FilterExec: #<col> > Some(1000000),7,2
                                                                ProjectionExec: expr=[<exprs>]
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                      ProjectionExec: expr=[<exprs>]
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                      ProjectionExec: expr=[<exprs>]
                                                                        CoalesceBatchesExec: target_batch_size=8192
                                                                          FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _15@<id>, _17@<id>, _18@<id>, _29@<id>]
                                                                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                          ProjectionExec: expr=[<exprs>]
                                                            CoalesceBatchesExec: target_batch_size=8192
                                                              FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                                RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                    ProjectionExec: expr=[<exprs>]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192
                          FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                              ProjectionExec: expr=[<exprs>]
                                BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                  SortExec: expr=[<exprs>]
                                    BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                      SortExec: expr=[<exprs>]
                                        CoalescePartitionsExec
                                          SortExec: expr=[<exprs>]
                                            ProjectionExec: expr=[<exprs>]
                                              AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))]
                                                RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))]
                                                      CoalesceBatchesExec: target_batch_size=8192
                                                        HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                          CoalescePartitionsExec
                                                            CoalesceBatchesExec: target_batch_size=8192
                                                              FilterExec: #<col> > Some(1000000),7,2
                                                                ProjectionExec: expr=[<exprs>]
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                      ProjectionExec: expr=[<exprs>]
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                      ProjectionExec: expr=[<exprs>]
                                                                        CoalesceBatchesExec: target_batch_size=8192
                                                                          FilterExec: _22@<id> > Some(100),6,2 AND _20@<id> > Some(0),7,2 AND _10@<id> > 0, projection=[_0@<id>, _2@<id>, _9@<id>, _10@<id>, _20@<id>]
                                                                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                          ProjectionExec: expr=[<exprs>]
                                                            CoalesceBatchesExec: target_batch_size=8192
                                                              FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                                RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>]


physical_plan after CombinePartialFinalAggregate:
SAME TEXT AS ABOVE

physical_plan after EnforceSorting:
OutputRequirementExec: order_by=[(#<col>, asc), (#<col>, asc), (#<col>, asc), (#<col>, asc)], dist_by=SinglePartition
  SortExec: [<sort_exprs>], fetch=100
    SortExec: expr=[<exprs>]
      ProjectionExec: expr=[<exprs>]
        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[]
          RepartitionExec: partitioning=Hash([#<col>, #<col>, #<col>, #<col>, #<col>], <partitions>), input_partitions=<partitions>
            CoalesceBatchesExec: target_batch_size=8192
              AggregateExec: mode=Partial, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[], ordering_mode=PartiallySorted([0, 4])
                UnionExec
                  ProjectionExec: expr=[<exprs>]
                    ProjectionExec: expr=[<exprs>]
                      CoalesceBatchesExec: target_batch_size=8192
                        FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                            ProjectionExec: expr=[<exprs>]
                              BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                SortExec: expr=[<exprs>]
                                  BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                    SortExec: [<sort_exprs>]
                                      SortExec: expr=[<exprs>]
                                        ProjectionExec: expr=[<exprs>]
                                          AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))]
                                            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                              CoalesceBatchesExec: target_batch_size=8192
                                                AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))]
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                      CoalescePartitionsExec
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          FilterExec: #<col> > Some(1000000),7,2
                                                            ProjectionExec: expr=[<exprs>]
                                                              CoalesceBatchesExec: target_batch_size=8192
                                                                HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                  ProjectionExec: expr=[<exprs>]
                                                                    DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                  RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                    ProjectionExec: expr=[<exprs>]
                                                                      CoalesceBatchesExec: target_batch_size=8192
                                                                        FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _3@<id>, _17@<id>, _18@<id>, _29@<id>]
                                                                          DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                      ProjectionExec: expr=[<exprs>]
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                  ProjectionExec: expr=[<exprs>]
                    ProjectionExec: expr=[<exprs>]
                      CoalesceBatchesExec: target_batch_size=8192
                        FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                            ProjectionExec: expr=[<exprs>]
                              BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                SortExec: expr=[<exprs>]
                                  BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                    SortExec: [<sort_exprs>]
                                      SortExec: expr=[<exprs>]
                                        ProjectionExec: expr=[<exprs>]
                                          AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))]
                                            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                              CoalesceBatchesExec: target_batch_size=8192
                                                AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))]
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                      CoalescePartitionsExec
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          FilterExec: #<col> > Some(1000000),7,2
                                                            ProjectionExec: expr=[<exprs>]
                                                              CoalesceBatchesExec: target_batch_size=8192
                                                                HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                  ProjectionExec: expr=[<exprs>]
                                                                    DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                  ProjectionExec: expr=[<exprs>]
                                                                    CoalesceBatchesExec: target_batch_size=8192
                                                                      FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _15@<id>, _17@<id>, _18@<id>, _29@<id>]
                                                                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                          DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                      ProjectionExec: expr=[<exprs>]
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                  ProjectionExec: expr=[<exprs>]
                    ProjectionExec: expr=[<exprs>]
                      CoalesceBatchesExec: target_batch_size=8192
                        FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                            ProjectionExec: expr=[<exprs>]
                              BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                SortExec: expr=[<exprs>]
                                  BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                    SortExec: [<sort_exprs>]
                                      SortExec: expr=[<exprs>]
                                        ProjectionExec: expr=[<exprs>]
                                          AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))]
                                            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                              CoalesceBatchesExec: target_batch_size=8192
                                                AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))]
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                      CoalescePartitionsExec
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          FilterExec: #<col> > Some(1000000),7,2
                                                            ProjectionExec: expr=[<exprs>]
                                                              CoalesceBatchesExec: target_batch_size=8192
                                                                HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                  ProjectionExec: expr=[<exprs>]
                                                                    DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                  ProjectionExec: expr=[<exprs>]
                                                                    CoalesceBatchesExec: target_batch_size=8192
                                                                      FilterExec: _22@<id> > Some(100),6,2 AND _20@<id> > Some(0),7,2 AND _10@<id> > 0, projection=[_0@<id>, _2@<id>, _9@<id>, _10@<id>, _20@<id>]
                                                                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                          DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                      ProjectionExec: expr=[<exprs>]
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]


physical_plan after OptimizeAggregateOrder:
SAME TEXT AS ABOVE

physical_plan after ProjectionPushdown:
SAME TEXT AS ABOVE

physical_plan after coalesce_batches:
OutputRequirementExec: order_by=[(#<col>, asc), (#<col>, asc), (#<col>, asc), (#<col>, asc)], dist_by=SinglePartition
  SortExec: [<sort_exprs>], fetch=100
    SortExec: expr=[<exprs>]
      ProjectionExec: expr=[<exprs>]
        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[]
          CoalesceBatchesExec: target_batch_size=8192
            RepartitionExec: partitioning=Hash([#<col>, #<col>, #<col>, #<col>, #<col>], <partitions>), input_partitions=<partitions>
              CoalesceBatchesExec: target_batch_size=8192
                AggregateExec: mode=Partial, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[], ordering_mode=PartiallySorted([0, 4])
                  UnionExec
                    ProjectionExec: expr=[<exprs>]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192
                          CoalesceBatchesExec: target_batch_size=8192
                            FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                ProjectionExec: expr=[<exprs>]
                                  BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                    SortExec: expr=[<exprs>]
                                      BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                        SortExec: [<sort_exprs>]
                                          SortExec: expr=[<exprs>]
                                            ProjectionExec: expr=[<exprs>]
                                              AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))]
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                    CoalesceBatchesExec: target_batch_size=8192
                                                      AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))]
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          CoalesceBatchesExec: target_batch_size=8192
                                                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                              CoalescePartitionsExec
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: #<col> > Some(1000000),7,2
                                                                      ProjectionExec: expr=[<exprs>]
                                                                        CoalesceBatchesExec: target_batch_size=8192
                                                                          CoalesceBatchesExec: target_batch_size=8192
                                                                            HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                              ProjectionExec: expr=[<exprs>]
                                                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                                ProjectionExec: expr=[<exprs>]
                                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                                    CoalesceBatchesExec: target_batch_size=8192
                                                                                      FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _3@<id>, _17@<id>, _18@<id>, _29@<id>]
                                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                              ProjectionExec: expr=[<exprs>]
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                    ProjectionExec: expr=[<exprs>]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192
                          CoalesceBatchesExec: target_batch_size=8192
                            FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                ProjectionExec: expr=[<exprs>]
                                  BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                    SortExec: expr=[<exprs>]
                                      BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                        SortExec: [<sort_exprs>]
                                          SortExec: expr=[<exprs>]
                                            ProjectionExec: expr=[<exprs>]
                                              AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))]
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                    CoalesceBatchesExec: target_batch_size=8192
                                                      AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))]
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          CoalesceBatchesExec: target_batch_size=8192
                                                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                              CoalescePartitionsExec
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: #<col> > Some(1000000),7,2
                                                                      ProjectionExec: expr=[<exprs>]
                                                                        CoalesceBatchesExec: target_batch_size=8192
                                                                          CoalesceBatchesExec: target_batch_size=8192
                                                                            HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                              ProjectionExec: expr=[<exprs>]
                                                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                              ProjectionExec: expr=[<exprs>]
                                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                                    FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _15@<id>, _17@<id>, _18@<id>, _29@<id>]
                                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                              ProjectionExec: expr=[<exprs>]
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                    ProjectionExec: expr=[<exprs>]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192
                          CoalesceBatchesExec: target_batch_size=8192
                            FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                ProjectionExec: expr=[<exprs>]
                                  BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                    SortExec: expr=[<exprs>]
                                      BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                        SortExec: [<sort_exprs>]
                                          SortExec: expr=[<exprs>]
                                            ProjectionExec: expr=[<exprs>]
                                              AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))]
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                    CoalesceBatchesExec: target_batch_size=8192
                                                      AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))]
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          CoalesceBatchesExec: target_batch_size=8192
                                                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                              CoalescePartitionsExec
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: #<col> > Some(1000000),7,2
                                                                      ProjectionExec: expr=[<exprs>]
                                                                        CoalesceBatchesExec: target_batch_size=8192
                                                                          CoalesceBatchesExec: target_batch_size=8192
                                                                            HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                              ProjectionExec: expr=[<exprs>]
                                                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                              ProjectionExec: expr=[<exprs>]
                                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                                    FilterExec: _22@<id> > Some(100),6,2 AND _20@<id> > Some(0),7,2 AND _10@<id> > 0, projection=[_0@<id>, _2@<id>, _9@<id>, _10@<id>, _20@<id>]
                                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                              ProjectionExec: expr=[<exprs>]
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]


physical_plan after coalesce_async_exec_input:
SAME TEXT AS ABOVE

physical_plan after OutputRequirements:
SortExec: [<sort_exprs>], fetch=100
  SortExec: expr=[<exprs>]
    ProjectionExec: expr=[<exprs>]
      AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[]
        CoalesceBatchesExec: target_batch_size=8192
          RepartitionExec: partitioning=Hash([#<col>, #<col>, #<col>, #<col>, #<col>], <partitions>), input_partitions=<partitions>
            CoalesceBatchesExec: target_batch_size=8192
              AggregateExec: mode=Partial, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[], ordering_mode=PartiallySorted([0, 4])
                UnionExec
                  ProjectionExec: expr=[<exprs>]
                    ProjectionExec: expr=[<exprs>]
                      CoalesceBatchesExec: target_batch_size=8192
                        CoalesceBatchesExec: target_batch_size=8192
                          FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                              ProjectionExec: expr=[<exprs>]
                                BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                  SortExec: expr=[<exprs>]
                                    BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                      SortExec: [<sort_exprs>]
                                        SortExec: expr=[<exprs>]
                                          ProjectionExec: expr=[<exprs>]
                                            AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))]
                                              CoalesceBatchesExec: target_batch_size=8192
                                                RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))]
                                                      CoalesceBatchesExec: target_batch_size=8192
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                            CoalescePartitionsExec
                                                              CoalesceBatchesExec: target_batch_size=8192
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  FilterExec: #<col> > Some(1000000),7,2
                                                                    ProjectionExec: expr=[<exprs>]
                                                                      CoalesceBatchesExec: target_batch_size=8192
                                                                        CoalesceBatchesExec: target_batch_size=8192
                                                                          HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                            ProjectionExec: expr=[<exprs>]
                                                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                              ProjectionExec: expr=[<exprs>]
                                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                                    FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _3@<id>, _17@<id>, _18@<id>, _29@<id>]
                                                                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                            ProjectionExec: expr=[<exprs>]
                                                              CoalesceBatchesExec: target_batch_size=8192
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                                    RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                  ProjectionExec: expr=[<exprs>]
                    ProjectionExec: expr=[<exprs>]
                      CoalesceBatchesExec: target_batch_size=8192
                        CoalesceBatchesExec: target_batch_size=8192
                          FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                              ProjectionExec: expr=[<exprs>]
                                BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                  SortExec: expr=[<exprs>]
                                    BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                      SortExec: [<sort_exprs>]
                                        SortExec: expr=[<exprs>]
                                          ProjectionExec: expr=[<exprs>]
                                            AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))]
                                              CoalesceBatchesExec: target_batch_size=8192
                                                RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))]
                                                      CoalesceBatchesExec: target_batch_size=8192
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                            CoalescePartitionsExec
                                                              CoalesceBatchesExec: target_batch_size=8192
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  FilterExec: #<col> > Some(1000000),7,2
                                                                    ProjectionExec: expr=[<exprs>]
                                                                      CoalesceBatchesExec: target_batch_size=8192
                                                                        CoalesceBatchesExec: target_batch_size=8192
                                                                          HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                            ProjectionExec: expr=[<exprs>]
                                                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                            ProjectionExec: expr=[<exprs>]
                                                                              CoalesceBatchesExec: target_batch_size=8192
                                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                                  FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _15@<id>, _17@<id>, _18@<id>, _29@<id>]
                                                                                    RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                            ProjectionExec: expr=[<exprs>]
                                                              CoalesceBatchesExec: target_batch_size=8192
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                                    RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                  ProjectionExec: expr=[<exprs>]
                    ProjectionExec: expr=[<exprs>]
                      CoalesceBatchesExec: target_batch_size=8192
                        CoalesceBatchesExec: target_batch_size=8192
                          FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                              ProjectionExec: expr=[<exprs>]
                                BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                  SortExec: expr=[<exprs>]
                                    BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                      SortExec: [<sort_exprs>]
                                        SortExec: expr=[<exprs>]
                                          ProjectionExec: expr=[<exprs>]
                                            AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))]
                                              CoalesceBatchesExec: target_batch_size=8192
                                                RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))]
                                                      CoalesceBatchesExec: target_batch_size=8192
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                            CoalescePartitionsExec
                                                              CoalesceBatchesExec: target_batch_size=8192
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  FilterExec: #<col> > Some(1000000),7,2
                                                                    ProjectionExec: expr=[<exprs>]
                                                                      CoalesceBatchesExec: target_batch_size=8192
                                                                        CoalesceBatchesExec: target_batch_size=8192
                                                                          HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                            ProjectionExec: expr=[<exprs>]
                                                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                            ProjectionExec: expr=[<exprs>]
                                                                              CoalesceBatchesExec: target_batch_size=8192
                                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                                  FilterExec: _22@<id> > Some(100),6,2 AND _20@<id> > Some(0),7,2 AND _10@<id> > 0, projection=[_0@<id>, _2@<id>, _9@<id>, _10@<id>, _20@<id>]
                                                                                    RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                            ProjectionExec: expr=[<exprs>]
                                                              CoalesceBatchesExec: target_batch_size=8192
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                                    RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]


physical_plan after LimitAggregation:
SAME TEXT AS ABOVE

physical_plan after LimitPushPastWindows:
SAME TEXT AS ABOVE

physical_plan after LimitPushdown:
SAME TEXT AS ABOVE

physical_plan after ProjectionPushdown:
SAME TEXT AS ABOVE

physical_plan after EnsureCooperative:
SAME TEXT AS ABOVE

physical_plan after FilterPushdown(Post):
SAME TEXT AS ABOVE

physical_plan after RewriteExplicitRepartition:
SAME TEXT AS ABOVE

physical_plan after SanityCheckPlan:
SAME TEXT AS ABOVE

physical_plan:
ProjectionExec: expr=[<exprs>]
  SortExec: [<sort_exprs>], fetch=100
    SortExec: expr=[<exprs>]
      ProjectionExec: expr=[<exprs>]
        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[]
          CoalesceBatchesExec: target_batch_size=8192
            RepartitionExec: partitioning=Hash([#<col>, #<col>, #<col>, #<col>, #<col>], <partitions>), input_partitions=<partitions>
              CoalesceBatchesExec: target_batch_size=8192
                AggregateExec: mode=Partial, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[], ordering_mode=PartiallySorted([0, 4])
                  UnionExec
                    ProjectionExec: expr=[<exprs>]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192
                          CoalesceBatchesExec: target_batch_size=8192
                            FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                ProjectionExec: expr=[<exprs>]
                                  BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                    SortExec: expr=[<exprs>]
                                      BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                        SortExec: [<sort_exprs>]
                                          SortExec: expr=[<exprs>]
                                            ProjectionExec: expr=[<exprs>]
                                              AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))]
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                    CoalesceBatchesExec: target_batch_size=8192
                                                      AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))]
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          CoalesceBatchesExec: target_batch_size=8192
                                                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                              CoalescePartitionsExec
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: #<col> > Some(1000000),7,2
                                                                      ProjectionExec: expr=[<exprs>]
                                                                        CoalesceBatchesExec: target_batch_size=8192
                                                                          CoalesceBatchesExec: target_batch_size=8192
                                                                            HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                              ProjectionExec: expr=[<exprs>]
                                                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                                ProjectionExec: expr=[<exprs>]
                                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                                    CoalesceBatchesExec: target_batch_size=8192
                                                                                      FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _3@<id>, _17@<id>, _18@<id>, _29@<id>]
                                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                              ProjectionExec: expr=[<exprs>]
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                    ProjectionExec: expr=[<exprs>]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192
                          CoalesceBatchesExec: target_batch_size=8192
                            FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                ProjectionExec: expr=[<exprs>]
                                  BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                    SortExec: expr=[<exprs>]
                                      BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                        SortExec: [<sort_exprs>]
                                          SortExec: expr=[<exprs>]
                                            ProjectionExec: expr=[<exprs>]
                                              AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))]
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                    CoalesceBatchesExec: target_batch_size=8192
                                                      AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))]
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          CoalesceBatchesExec: target_batch_size=8192
                                                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                              CoalescePartitionsExec
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: #<col> > Some(1000000),7,2
                                                                      ProjectionExec: expr=[<exprs>]
                                                                        CoalesceBatchesExec: target_batch_size=8192
                                                                          CoalesceBatchesExec: target_batch_size=8192
                                                                            HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                              ProjectionExec: expr=[<exprs>]
                                                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                              ProjectionExec: expr=[<exprs>]
                                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                                    FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _15@<id>, _17@<id>, _18@<id>, _29@<id>]
                                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                              ProjectionExec: expr=[<exprs>]
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                    ProjectionExec: expr=[<exprs>]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192
                          CoalesceBatchesExec: target_batch_size=8192
                            FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                ProjectionExec: expr=[<exprs>]
                                  BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                    SortExec: expr=[<exprs>]
                                      BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                        SortExec: [<sort_exprs>]
                                          SortExec: expr=[<exprs>]
                                            ProjectionExec: expr=[<exprs>]
                                              AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))]
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                    CoalesceBatchesExec: target_batch_size=8192
                                                      AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))]
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          CoalesceBatchesExec: target_batch_size=8192
                                                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                              CoalescePartitionsExec
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: #<col> > Some(1000000),7,2
                                                                      ProjectionExec: expr=[<exprs>]
                                                                        CoalesceBatchesExec: target_batch_size=8192
                                                                          CoalesceBatchesExec: target_batch_size=8192
                                                                            HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                              ProjectionExec: expr=[<exprs>]
                                                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                              ProjectionExec: expr=[<exprs>]
                                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                                    FilterExec: _22@<id> > Some(100),6,2 AND _20@<id> > Some(0),7,2 AND _10@<id> > 0, projection=[_0@<id>, _2@<id>, _9@<id>, _10@<id>, _20@<id>]
                                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                              ProjectionExec: expr=[<exprs>]
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]


== Physical Plan ==
ProjectionExec: expr=[<exprs>]
  SortExec: [<sort_exprs>], fetch=100
    SortExec: expr=[<exprs>]
      ProjectionExec: expr=[<exprs>]
        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[]
          CoalesceBatchesExec: target_batch_size=8192
            RepartitionExec: partitioning=Hash([#<col>, #<col>, #<col>, #<col>, #<col>], <partitions>), input_partitions=<partitions>
              CoalesceBatchesExec: target_batch_size=8192
                AggregateExec: mode=Partial, gby=[#<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>, #<col> as #<col>], aggr=[], ordering_mode=PartiallySorted([0, 4])
                  UnionExec
                    ProjectionExec: expr=[<exprs>]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192
                          CoalesceBatchesExec: target_batch_size=8192
                            FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                ProjectionExec: expr=[<exprs>]
                                  BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                    SortExec: expr=[<exprs>]
                                      BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                        SortExec: [<sort_exprs>]
                                          SortExec: expr=[<exprs>]
                                            ProjectionExec: expr=[<exprs>]
                                              AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))]
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                    CoalesceBatchesExec: target_batch_size=8192
                                                      AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0))), sum(coalesce(wr.#<col>,Int32(0))), sum(coalesce(ws.#<col>,Int32(0)))]
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          CoalesceBatchesExec: target_batch_size=8192
                                                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                              CoalescePartitionsExec
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: #<col> > Some(1000000),7,2
                                                                      ProjectionExec: expr=[<exprs>]
                                                                        CoalesceBatchesExec: target_batch_size=8192
                                                                          CoalesceBatchesExec: target_batch_size=8192
                                                                            HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                              ProjectionExec: expr=[<exprs>]
                                                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                                ProjectionExec: expr=[<exprs>]
                                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                                    CoalesceBatchesExec: target_batch_size=8192
                                                                                      FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _3@<id>, _17@<id>, _18@<id>, _29@<id>]
                                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                              ProjectionExec: expr=[<exprs>]
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                    ProjectionExec: expr=[<exprs>]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192
                          CoalesceBatchesExec: target_batch_size=8192
                            FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                ProjectionExec: expr=[<exprs>]
                                  BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                    SortExec: expr=[<exprs>]
                                      BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                        SortExec: [<sort_exprs>]
                                          SortExec: expr=[<exprs>]
                                            ProjectionExec: expr=[<exprs>]
                                              AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))]
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                    CoalesceBatchesExec: target_batch_size=8192
                                                      AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0))), sum(coalesce(cr.#<col>,Int32(0))), sum(coalesce(cs.#<col>,Int32(0)))]
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          CoalesceBatchesExec: target_batch_size=8192
                                                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                              CoalescePartitionsExec
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: #<col> > Some(1000000),7,2
                                                                      ProjectionExec: expr=[<exprs>]
                                                                        CoalesceBatchesExec: target_batch_size=8192
                                                                          CoalesceBatchesExec: target_batch_size=8192
                                                                            HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                              ProjectionExec: expr=[<exprs>]
                                                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                              ProjectionExec: expr=[<exprs>]
                                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                                    FilterExec: _33@<id> > Some(100),7,2 AND _29@<id> > Some(0),7,2 AND _18@<id> > 0, projection=[_0@<id>, _15@<id>, _17@<id>, _18@<id>, _29@<id>]
                                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                              ProjectionExec: expr=[<exprs>]
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                    ProjectionExec: expr=[<exprs>]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192
                          CoalesceBatchesExec: target_batch_size=8192
                            FilterExec: rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10 OR rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW@<id> <= 10
                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                ProjectionExec: expr=[<exprs>]
                                  BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                    SortExec: expr=[<exprs>]
                                      BoundedWindowAggExec: wdw=[rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW: Field { "rank() ORDER BY [<cols>] RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW": UInt64 }, frame: RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW], mode=[Sorted]
                                        SortExec: [<sort_exprs>]
                                          SortExec: expr=[<exprs>]
                                            ProjectionExec: expr=[<exprs>]
                                              AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))]
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                    CoalesceBatchesExec: target_batch_size=8192
                                                      AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0))), sum(coalesce(sr.#<col>,Int32(0))), sum(coalesce(sts.#<col>,Int32(0)))]
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          CoalesceBatchesExec: target_batch_size=8192
                                                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>]
                                                              CoalescePartitionsExec
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: #<col> > Some(1000000),7,2
                                                                      ProjectionExec: expr=[<exprs>]
                                                                        CoalesceBatchesExec: target_batch_size=8192
                                                                          CoalesceBatchesExec: target_batch_size=8192
                                                                            HashJoinExec: mode=CollectLeft, join_type=Right, on=[(#<col>, #<col>), (#<col>, #<col>)], projection=[#<col>, #<col>, #<col>, #<col>, #<col>, #<col>]
                                                                              ProjectionExec: expr=[<exprs>]
                                                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                                              ProjectionExec: expr=[<exprs>]
                                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                                    FilterExec: _22@<id> > Some(100),6,2 AND _20@<id> > Some(0),7,2 AND _10@<id> > 0, projection=[_0@<id>, _2@<id>, _9@<id>, _10@<id>, _20@<id>]
                                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                              ProjectionExec: expr=[<exprs>]
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: _6@<id> = 2000 AND _8@<id> = 12, projection=[_0@<id>]
                                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]