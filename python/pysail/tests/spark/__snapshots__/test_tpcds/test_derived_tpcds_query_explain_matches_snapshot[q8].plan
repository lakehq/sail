== Codegen ==
Whole-stage codegen is not supported; showing physical plan instead.

== Plan Steps ==
initial_logical_plan:
Limit: skip=0, fetch=Int32(100)
  Projection: <exprs>
    Sort: <exprs>
      Projection: <exprs>
        Aggregate: groupBy=[[store.#<col>]], aggr=[[sum(store_sales.#<col>)]]
          Filter: store_sales.#<col> = store.#<col> AND store_sales.#<col> = date_dim.#<col> AND date_dim.#<col> = Int32(1) AND date_dim.#<col> = Int32(2000) AND CAST(substr(CAST(store.#<col> AS Utf8), Int32(1), Int32(2)) AS Utf8) = CAST(substr(CAST(V1.#<col> AS Utf8), Int32(1), Int32(2)) AS Utf8)
            Cross Join: 
              Cross Join: 
                Cross Join: 
                  Projection: <exprs>
                    Projection: <exprs>
                      SubqueryAlias: store_sales
                        Projection: <exprs>
                          Projection: <exprs>
                            TableScan: ?table?
                  Projection: <exprs>
                    Projection: <exprs>
                      SubqueryAlias: date_dim
                        Projection: <exprs>
                          Projection: <exprs>
                            TableScan: ?table?
                Projection: <exprs>
                  Projection: <exprs>
                    SubqueryAlias: store
                      Projection: <exprs>
                        Projection: <exprs>
                          TableScan: ?table?
              SubqueryAlias: V1
                Projection: <exprs>
                  SubqueryAlias: A2
                    LeftSemi Join: #<col> = #<col>
                      Distinct:
                        Projection: <exprs>
                          Filter: CAST(substr(CAST(customer_address.#<col> AS Utf8), Int32(1), Int32(5)) AS Utf8) IN ([Utf8("19100"), Utf8("41548"), Utf8("51640"), Utf8("49699"), Utf8("88329"), Utf8("55986"), Utf8("85119"), Utf8("19510"), Utf8("61020"), Utf8("95452"), Utf8("26235"), Utf8("51102"), Utf8("16733"), Utf8("42819"), Utf8("27823"), Utf8("90192"), Utf8("31905"), Utf8("28865"), Utf8("62197"), Utf8("23750"), Utf8("81398"), Utf8("95288"), Utf8("45114"), Utf8("82060"), Utf8("12313"), Utf8("25218"), Utf8("64386"), Utf8("46400"), Utf8("77230"), Utf8("69271"), Utf8("43672"), Utf8("36521"), Utf8("34217"), Utf8("13017"), Utf8("27936"), Utf8("42766"), Utf8("59233"), Utf8("26060"), Utf8("27477"), Utf8("39981"), Utf8("93402"), Utf8("74270"), Utf8("13932"), Utf8("51731"), Utf8("71642"), Utf8("17710"), Utf8("85156"), Utf8("21679"), Utf8("70840"), Utf8("67191"), Utf8("39214"), Utf8("35273"), Utf8("27293"), Utf8("17128"), Utf8("15458"), Utf8("31615"), Utf8("60706"), Utf8("67657"), Utf8("54092"), Utf8("32775"), Utf8("14683"), Utf8("32206"), Utf8("62543"), Utf8("43053"), Utf8("11297"), Utf8("58216"), Utf8("49410"), Utf8("14710"), Utf8("24501"), Utf8("79057"), Utf8("77038"), Utf8("91286"), Utf8("32334"), Utf8("46298"), Utf8("18326"), Utf8("67213"), Utf8("65382"), Utf8("40315"), Utf8("56115"), Utf8("80162"), Utf8("55956"), Utf8("81583"), Utf8("73588"), Utf8("32513"), Utf8("62880"), Utf8("12201"), Utf8("11592"), Utf8("17014"), Utf8("83832"), Utf8("61796"), Utf8("57872"), Utf8("78829"), Utf8("69912"), Utf8("48524"), Utf8("22016"), Utf8("26905"), Utf8("48511"), Utf8("92168"), Utf8("63051"), Utf8("25748"), Utf8("89786"), Utf8("98827"), Utf8("86404"), Utf8("53029"), Utf8("37524"), Utf8("14039"), Utf8("50078"), Utf8("34487"), Utf8("70142"), Utf8("18697"), Utf8("40129"), Utf8("60642"), Utf8("42810"), Utf8("62667"), Utf8("57183"), Utf8("46414"), Utf8("58463"), Utf8("71211"), Utf8("46364"), Utf8("34851"), Utf8("54884"), Utf8("25382"), Utf8("25239"), Utf8("74126"), Utf8("21568"), Utf8("84204"), Utf8("13607"), Utf8("82518"), Utf8("32982"), Utf8("36953"), Utf8("86001"), Utf8("79278"), Utf8("21745"), Utf8("64444"), Utf8("35199"), Utf8("83181"), Utf8("73255"), Utf8("86177"), Utf8("98043"), Utf8("90392"), Utf8("13882"), Utf8("47084"), Utf8("17859"), Utf8("89526"), Utf8("42072"), Utf8("20233"), Utf8("52745"), Utf8("75000"), Utf8("22044"), Utf8("77013"), Utf8("24182"), Utf8("52554"), Utf8("56138"), Utf8("43440"), Utf8("86100"), Utf8("48791"), Utf8("21883"), Utf8("17096"), Utf8("15965"), Utf8("31196"), Utf8("74903"), Utf8("19810"), Utf8("35763"), Utf8("92020"), Utf8("55176"), Utf8("54433"), Utf8("68063"), Utf8("71919"), Utf8("44384"), Utf8("16612"), Utf8("32109"), Utf8("28207"), Utf8("14762"), Utf8("89933"), Utf8("10930"), Utf8("27616"), Utf8("56809"), Utf8("14244"), Utf8("22733"), Utf8("33177"), Utf8("29784"), Utf8("74968"), Utf8("37887"), Utf8("11299"), Utf8("34692"), Utf8("85843"), Utf8("83663"), Utf8("95421"), Utf8("19323"), Utf8("17406"), Utf8("69264"), Utf8("28341"), Utf8("50150"), Utf8("79121"), Utf8("73974"), Utf8("92917"), Utf8("21229"), Utf8("32254"), Utf8("97408"), Utf8("46011"), Utf8("37169"), Utf8("18146"), Utf8("27296"), Utf8("62927"), Utf8("68812"), Utf8("47734"), Utf8("86572"), Utf8("12620"), Utf8("80252"), Utf8("50173"), Utf8("27261"), Utf8("29534"), Utf8("23488"), Utf8("42184"), Utf8("23695"), Utf8("45868"), Utf8("12910"), Utf8("23429"), Utf8("29052"), Utf8("63228"), Utf8("30731"), Utf8("15747"), Utf8("25827"), Utf8("22332"), Utf8("62349"), Utf8("56661"), Utf8("44652"), Utf8("51862"), Utf8("57007"), Utf8("22773"), Utf8("40361"), Utf8("65238"), Utf8("19327"), Utf8("17282"), Utf8("44708"), Utf8("35484"), Utf8("34064"), Utf8("11148"), Utf8("92729"), Utf8("22995"), Utf8("18833"), Utf8("77528"), Utf8("48917"), Utf8("17256"), Utf8("93166"), Utf8("68576"), Utf8("71096"), Utf8("56499"), Utf8("35096"), Utf8("80551"), Utf8("82424"), Utf8("17700"), Utf8("32748"), Utf8("78969"), Utf8("46820"), Utf8("57725"), Utf8("46179"), Utf8("54677"), Utf8("98097"), Utf8("62869"), Utf8("83959"), Utf8("66728"), Utf8("19716"), Utf8("48326"), Utf8("27420"), Utf8("53458"), Utf8("69056"), Utf8("84216"), Utf8("36688"), Utf8("63957"), Utf8("41469"), Utf8("66843"), Utf8("18024"), Utf8("81950"), Utf8("21911"), Utf8("58387"), Utf8("58103"), Utf8("19813"), Utf8("34581"), Utf8("55347"), Utf8("17171"), Utf8("35914"), Utf8("75043"), Utf8("75088"), Utf8("80541"), Utf8("26802"), Utf8("28849"), Utf8("22356"), Utf8("57721"), Utf8("77084"), Utf8("46385"), Utf8("59255"), Utf8("29308"), Utf8("65885"), Utf8("70673"), Utf8("13306"), Utf8("68788"), Utf8("87335"), Utf8("40987"), Utf8("31654"), Utf8("67560"), Utf8("92309"), Utf8("78116"), Utf8("65961"), Utf8("45018"), Utf8("16548"), Utf8("67092"), Utf8("21818"), Utf8("33716"), Utf8("49449"), Utf8("86150"), Utf8("12156"), Utf8("27574"), Utf8("43201"), Utf8("50977"), Utf8("52839"), Utf8("33234"), Utf8("86611"), Utf8("71494"), Utf8("17823"), Utf8("57172"), Utf8("59869"), Utf8("34086"), Utf8("51052"), Utf8("11320"), Utf8("39717"), Utf8("79604"), Utf8("24672"), Utf8("70555"), Utf8("38378"), Utf8("91135"), Utf8("15567"), Utf8("21606"), Utf8("74994"), Utf8("77168"), Utf8("38607"), Utf8("27384"), Utf8("68328"), Utf8("88944"), Utf8("40203"), Utf8("37893"), Utf8("42726"), Utf8("83549"), Utf8("48739"), Utf8("55652"), Utf8("27543"), Utf8("23109"), Utf8("98908"), Utf8("28831"), Utf8("45011"), Utf8("47525"), Utf8("43870"), Utf8("79404"), Utf8("35780"), Utf8("42136"), Utf8("49317"), Utf8("14574"), Utf8("99586"), Utf8("21107"), Utf8("14302"), Utf8("83882"), Utf8("81272"), Utf8("92552"), Utf8("14916"), Utf8("87533"), Utf8("86518"), Utf8("17862"), Utf8("30741"), Utf8("96288"), Utf8("57886"), Utf8("30304"), Utf8("24201"), Utf8("79457"), Utf8("36728"), Utf8("49833"), Utf8("35182"), Utf8("20108"), Utf8("39858"), Utf8("10804"), Utf8("47042"), Utf8("20439"), Utf8("54708"), Utf8("59027"), Utf8("82499"), Utf8("75311"), Utf8("26548"), Utf8("53406"), Utf8("92060"), Utf8("41152"), Utf8("60446"), Utf8("33129"), Utf8("43979"), Utf8("16903"), Utf8("60319"), Utf8("35550"), Utf8("33887"), Utf8("25463"), Utf8("40343"), Utf8("20726"), Utf8("44429")])
                            Projection: <exprs>
                              Projection: <exprs>
                                SubqueryAlias: customer_address
                                  Projection: <exprs>
                                    Projection: <exprs>
                                      TableScan: ?table?
                      Projection: <exprs>
                        SubqueryAlias: A1
                          Projection: <exprs>
                            Filter: count(Int64(1)) > Int32(10)
                              Aggregate: groupBy=[[customer_address.#<col>]], aggr=[[count(Int64(1))]]
                                Filter: customer_address.#<col> = customer.#<col> AND customer.#<col> = Utf8("Y")
                                  Cross Join: 
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: customer_address
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: customer
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?

logical_plan after resolve_grouping_function:
SAME TEXT AS ABOVE

logical_plan after type_coercion:
Limit: skip=0, fetch=CAST(Int32(100) AS Int64)
  Projection: <exprs>
    Sort: <exprs>
      Projection: <exprs>
        Aggregate: groupBy=[[store.#<col>]], aggr=[[sum(store_sales.#<col>)]]
          Filter: store_sales.#<col> = CAST(store.#<col> AS Float64) AND store_sales.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = CAST(Int32(1) AS Int64) AND date_dim.#<col> = CAST(Int32(2000) AS Int64) AND CAST(substr(CAST(store.#<col> AS Utf8), CAST(Int32(1) AS Int64), CAST(Int32(2) AS Int64)) AS Utf8) = CAST(substr(CAST(V1.#<col> AS Utf8), CAST(Int32(1) AS Int64), CAST(Int32(2) AS Int64)) AS Utf8)
            Cross Join: 
              Cross Join: 
                Cross Join: 
                  Projection: <exprs>
                    Projection: <exprs>
                      SubqueryAlias: store_sales
                        Projection: <exprs>
                          Projection: <exprs>
                            TableScan: ?table?
                  Projection: <exprs>
                    Projection: <exprs>
                      SubqueryAlias: date_dim
                        Projection: <exprs>
                          Projection: <exprs>
                            TableScan: ?table?
                Projection: <exprs>
                  Projection: <exprs>
                    SubqueryAlias: store
                      Projection: <exprs>
                        Projection: <exprs>
                          TableScan: ?table?
              SubqueryAlias: V1
                Projection: <exprs>
                  SubqueryAlias: A2
                    LeftSemi Join: #<col> = #<col>
                      Distinct:
                        Projection: <exprs>
                          Filter: CAST(substr(CAST(customer_address.#<col> AS Utf8), CAST(Int32(1) AS Int64), CAST(Int32(5) AS Int64)) AS Utf8) IN ([Utf8("19100"), Utf8("41548"), Utf8("51640"), Utf8("49699"), Utf8("88329"), Utf8("55986"), Utf8("85119"), Utf8("19510"), Utf8("61020"), Utf8("95452"), Utf8("26235"), Utf8("51102"), Utf8("16733"), Utf8("42819"), Utf8("27823"), Utf8("90192"), Utf8("31905"), Utf8("28865"), Utf8("62197"), Utf8("23750"), Utf8("81398"), Utf8("95288"), Utf8("45114"), Utf8("82060"), Utf8("12313"), Utf8("25218"), Utf8("64386"), Utf8("46400"), Utf8("77230"), Utf8("69271"), Utf8("43672"), Utf8("36521"), Utf8("34217"), Utf8("13017"), Utf8("27936"), Utf8("42766"), Utf8("59233"), Utf8("26060"), Utf8("27477"), Utf8("39981"), Utf8("93402"), Utf8("74270"), Utf8("13932"), Utf8("51731"), Utf8("71642"), Utf8("17710"), Utf8("85156"), Utf8("21679"), Utf8("70840"), Utf8("67191"), Utf8("39214"), Utf8("35273"), Utf8("27293"), Utf8("17128"), Utf8("15458"), Utf8("31615"), Utf8("60706"), Utf8("67657"), Utf8("54092"), Utf8("32775"), Utf8("14683"), Utf8("32206"), Utf8("62543"), Utf8("43053"), Utf8("11297"), Utf8("58216"), Utf8("49410"), Utf8("14710"), Utf8("24501"), Utf8("79057"), Utf8("77038"), Utf8("91286"), Utf8("32334"), Utf8("46298"), Utf8("18326"), Utf8("67213"), Utf8("65382"), Utf8("40315"), Utf8("56115"), Utf8("80162"), Utf8("55956"), Utf8("81583"), Utf8("73588"), Utf8("32513"), Utf8("62880"), Utf8("12201"), Utf8("11592"), Utf8("17014"), Utf8("83832"), Utf8("61796"), Utf8("57872"), Utf8("78829"), Utf8("69912"), Utf8("48524"), Utf8("22016"), Utf8("26905"), Utf8("48511"), Utf8("92168"), Utf8("63051"), Utf8("25748"), Utf8("89786"), Utf8("98827"), Utf8("86404"), Utf8("53029"), Utf8("37524"), Utf8("14039"), Utf8("50078"), Utf8("34487"), Utf8("70142"), Utf8("18697"), Utf8("40129"), Utf8("60642"), Utf8("42810"), Utf8("62667"), Utf8("57183"), Utf8("46414"), Utf8("58463"), Utf8("71211"), Utf8("46364"), Utf8("34851"), Utf8("54884"), Utf8("25382"), Utf8("25239"), Utf8("74126"), Utf8("21568"), Utf8("84204"), Utf8("13607"), Utf8("82518"), Utf8("32982"), Utf8("36953"), Utf8("86001"), Utf8("79278"), Utf8("21745"), Utf8("64444"), Utf8("35199"), Utf8("83181"), Utf8("73255"), Utf8("86177"), Utf8("98043"), Utf8("90392"), Utf8("13882"), Utf8("47084"), Utf8("17859"), Utf8("89526"), Utf8("42072"), Utf8("20233"), Utf8("52745"), Utf8("75000"), Utf8("22044"), Utf8("77013"), Utf8("24182"), Utf8("52554"), Utf8("56138"), Utf8("43440"), Utf8("86100"), Utf8("48791"), Utf8("21883"), Utf8("17096"), Utf8("15965"), Utf8("31196"), Utf8("74903"), Utf8("19810"), Utf8("35763"), Utf8("92020"), Utf8("55176"), Utf8("54433"), Utf8("68063"), Utf8("71919"), Utf8("44384"), Utf8("16612"), Utf8("32109"), Utf8("28207"), Utf8("14762"), Utf8("89933"), Utf8("10930"), Utf8("27616"), Utf8("56809"), Utf8("14244"), Utf8("22733"), Utf8("33177"), Utf8("29784"), Utf8("74968"), Utf8("37887"), Utf8("11299"), Utf8("34692"), Utf8("85843"), Utf8("83663"), Utf8("95421"), Utf8("19323"), Utf8("17406"), Utf8("69264"), Utf8("28341"), Utf8("50150"), Utf8("79121"), Utf8("73974"), Utf8("92917"), Utf8("21229"), Utf8("32254"), Utf8("97408"), Utf8("46011"), Utf8("37169"), Utf8("18146"), Utf8("27296"), Utf8("62927"), Utf8("68812"), Utf8("47734"), Utf8("86572"), Utf8("12620"), Utf8("80252"), Utf8("50173"), Utf8("27261"), Utf8("29534"), Utf8("23488"), Utf8("42184"), Utf8("23695"), Utf8("45868"), Utf8("12910"), Utf8("23429"), Utf8("29052"), Utf8("63228"), Utf8("30731"), Utf8("15747"), Utf8("25827"), Utf8("22332"), Utf8("62349"), Utf8("56661"), Utf8("44652"), Utf8("51862"), Utf8("57007"), Utf8("22773"), Utf8("40361"), Utf8("65238"), Utf8("19327"), Utf8("17282"), Utf8("44708"), Utf8("35484"), Utf8("34064"), Utf8("11148"), Utf8("92729"), Utf8("22995"), Utf8("18833"), Utf8("77528"), Utf8("48917"), Utf8("17256"), Utf8("93166"), Utf8("68576"), Utf8("71096"), Utf8("56499"), Utf8("35096"), Utf8("80551"), Utf8("82424"), Utf8("17700"), Utf8("32748"), Utf8("78969"), Utf8("46820"), Utf8("57725"), Utf8("46179"), Utf8("54677"), Utf8("98097"), Utf8("62869"), Utf8("83959"), Utf8("66728"), Utf8("19716"), Utf8("48326"), Utf8("27420"), Utf8("53458"), Utf8("69056"), Utf8("84216"), Utf8("36688"), Utf8("63957"), Utf8("41469"), Utf8("66843"), Utf8("18024"), Utf8("81950"), Utf8("21911"), Utf8("58387"), Utf8("58103"), Utf8("19813"), Utf8("34581"), Utf8("55347"), Utf8("17171"), Utf8("35914"), Utf8("75043"), Utf8("75088"), Utf8("80541"), Utf8("26802"), Utf8("28849"), Utf8("22356"), Utf8("57721"), Utf8("77084"), Utf8("46385"), Utf8("59255"), Utf8("29308"), Utf8("65885"), Utf8("70673"), Utf8("13306"), Utf8("68788"), Utf8("87335"), Utf8("40987"), Utf8("31654"), Utf8("67560"), Utf8("92309"), Utf8("78116"), Utf8("65961"), Utf8("45018"), Utf8("16548"), Utf8("67092"), Utf8("21818"), Utf8("33716"), Utf8("49449"), Utf8("86150"), Utf8("12156"), Utf8("27574"), Utf8("43201"), Utf8("50977"), Utf8("52839"), Utf8("33234"), Utf8("86611"), Utf8("71494"), Utf8("17823"), Utf8("57172"), Utf8("59869"), Utf8("34086"), Utf8("51052"), Utf8("11320"), Utf8("39717"), Utf8("79604"), Utf8("24672"), Utf8("70555"), Utf8("38378"), Utf8("91135"), Utf8("15567"), Utf8("21606"), Utf8("74994"), Utf8("77168"), Utf8("38607"), Utf8("27384"), Utf8("68328"), Utf8("88944"), Utf8("40203"), Utf8("37893"), Utf8("42726"), Utf8("83549"), Utf8("48739"), Utf8("55652"), Utf8("27543"), Utf8("23109"), Utf8("98908"), Utf8("28831"), Utf8("45011"), Utf8("47525"), Utf8("43870"), Utf8("79404"), Utf8("35780"), Utf8("42136"), Utf8("49317"), Utf8("14574"), Utf8("99586"), Utf8("21107"), Utf8("14302"), Utf8("83882"), Utf8("81272"), Utf8("92552"), Utf8("14916"), Utf8("87533"), Utf8("86518"), Utf8("17862"), Utf8("30741"), Utf8("96288"), Utf8("57886"), Utf8("30304"), Utf8("24201"), Utf8("79457"), Utf8("36728"), Utf8("49833"), Utf8("35182"), Utf8("20108"), Utf8("39858"), Utf8("10804"), Utf8("47042"), Utf8("20439"), Utf8("54708"), Utf8("59027"), Utf8("82499"), Utf8("75311"), Utf8("26548"), Utf8("53406"), Utf8("92060"), Utf8("41152"), Utf8("60446"), Utf8("33129"), Utf8("43979"), Utf8("16903"), Utf8("60319"), Utf8("35550"), Utf8("33887"), Utf8("25463"), Utf8("40343"), Utf8("20726"), Utf8("44429")])
                            Projection: <exprs>
                              Projection: <exprs>
                                SubqueryAlias: customer_address
                                  Projection: <exprs>
                                    Projection: <exprs>
                                      TableScan: ?table?
                      Projection: <exprs>
                        SubqueryAlias: A1
                          Projection: <exprs>
                            Filter: count(Int64(1)) > CAST(Int32(10) AS Int64)
                              Aggregate: groupBy=[[customer_address.#<col>]], aggr=[[count(Int64(1))]]
                                Filter: customer_address.#<col> = customer.#<col> AND customer.#<col> = Utf8("Y")
                                  Cross Join: 
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: customer_address
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: customer
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?

analyzed_logical_plan:
SAME TEXT AS ABOVE

logical_plan after eliminate_nested_union:
SAME TEXT AS ABOVE

logical_plan after simplify_expressions:
Limit: skip=0, fetch=100
  Projection: <exprs>
    Sort: <exprs>
      Projection: <exprs>
        Aggregate: groupBy=[[store.#<col>]], aggr=[[sum(store_sales.#<col>)]]
          Filter: store_sales.#<col> = CAST(store.#<col> AS Float64) AND store_sales.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = Int64(1) AND date_dim.#<col> = Int64(2000) AND CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8) = CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)
            Cross Join: 
              Cross Join: 
                Cross Join: 
                  Projection: <exprs>
                    Projection: <exprs>
                      SubqueryAlias: store_sales
                        Projection: <exprs>
                          Projection: <exprs>
                            TableScan: ?table?
                  Projection: <exprs>
                    Projection: <exprs>
                      SubqueryAlias: date_dim
                        Projection: <exprs>
                          Projection: <exprs>
                            TableScan: ?table?
                Projection: <exprs>
                  Projection: <exprs>
                    SubqueryAlias: store
                      Projection: <exprs>
                        Projection: <exprs>
                          TableScan: ?table?
              SubqueryAlias: V1
                Projection: <exprs>
                  SubqueryAlias: A2
                    LeftSemi Join: #<col> = #<col>
                      Distinct:
                        Projection: <exprs>
                          Filter: substr(CAST(customer_address.#<col> AS Utf8), Int64(1), Int64(5)) IN ([Utf8View("19100"), Utf8View("41548"), Utf8View("51640"), Utf8View("49699"), Utf8View("88329"), Utf8View("55986"), Utf8View("85119"), Utf8View("19510"), Utf8View("61020"), Utf8View("95452"), Utf8View("26235"), Utf8View("51102"), Utf8View("16733"), Utf8View("42819"), Utf8View("27823"), Utf8View("90192"), Utf8View("31905"), Utf8View("28865"), Utf8View("62197"), Utf8View("23750"), Utf8View("81398"), Utf8View("95288"), Utf8View("45114"), Utf8View("82060"), Utf8View("12313"), Utf8View("25218"), Utf8View("64386"), Utf8View("46400"), Utf8View("77230"), Utf8View("69271"), Utf8View("43672"), Utf8View("36521"), Utf8View("34217"), Utf8View("13017"), Utf8View("27936"), Utf8View("42766"), Utf8View("59233"), Utf8View("26060"), Utf8View("27477"), Utf8View("39981"), Utf8View("93402"), Utf8View("74270"), Utf8View("13932"), Utf8View("51731"), Utf8View("71642"), Utf8View("17710"), Utf8View("85156"), Utf8View("21679"), Utf8View("70840"), Utf8View("67191"), Utf8View("39214"), Utf8View("35273"), Utf8View("27293"), Utf8View("17128"), Utf8View("15458"), Utf8View("31615"), Utf8View("60706"), Utf8View("67657"), Utf8View("54092"), Utf8View("32775"), Utf8View("14683"), Utf8View("32206"), Utf8View("62543"), Utf8View("43053"), Utf8View("11297"), Utf8View("58216"), Utf8View("49410"), Utf8View("14710"), Utf8View("24501"), Utf8View("79057"), Utf8View("77038"), Utf8View("91286"), Utf8View("32334"), Utf8View("46298"), Utf8View("18326"), Utf8View("67213"), Utf8View("65382"), Utf8View("40315"), Utf8View("56115"), Utf8View("80162"), Utf8View("55956"), Utf8View("81583"), Utf8View("73588"), Utf8View("32513"), Utf8View("62880"), Utf8View("12201"), Utf8View("11592"), Utf8View("17014"), Utf8View("83832"), Utf8View("61796"), Utf8View("57872"), Utf8View("78829"), Utf8View("69912"), Utf8View("48524"), Utf8View("22016"), Utf8View("26905"), Utf8View("48511"), Utf8View("92168"), Utf8View("63051"), Utf8View("25748"), Utf8View("89786"), Utf8View("98827"), Utf8View("86404"), Utf8View("53029"), Utf8View("37524"), Utf8View("14039"), Utf8View("50078"), Utf8View("34487"), Utf8View("70142"), Utf8View("18697"), Utf8View("40129"), Utf8View("60642"), Utf8View("42810"), Utf8View("62667"), Utf8View("57183"), Utf8View("46414"), Utf8View("58463"), Utf8View("71211"), Utf8View("46364"), Utf8View("34851"), Utf8View("54884"), Utf8View("25382"), Utf8View("25239"), Utf8View("74126"), Utf8View("21568"), Utf8View("84204"), Utf8View("13607"), Utf8View("82518"), Utf8View("32982"), Utf8View("36953"), Utf8View("86001"), Utf8View("79278"), Utf8View("21745"), Utf8View("64444"), Utf8View("35199"), Utf8View("83181"), Utf8View("73255"), Utf8View("86177"), Utf8View("98043"), Utf8View("90392"), Utf8View("13882"), Utf8View("47084"), Utf8View("17859"), Utf8View("89526"), Utf8View("42072"), Utf8View("20233"), Utf8View("52745"), Utf8View("75000"), Utf8View("22044"), Utf8View("77013"), Utf8View("24182"), Utf8View("52554"), Utf8View("56138"), Utf8View("43440"), Utf8View("86100"), Utf8View("48791"), Utf8View("21883"), Utf8View("17096"), Utf8View("15965"), Utf8View("31196"), Utf8View("74903"), Utf8View("19810"), Utf8View("35763"), Utf8View("92020"), Utf8View("55176"), Utf8View("54433"), Utf8View("68063"), Utf8View("71919"), Utf8View("44384"), Utf8View("16612"), Utf8View("32109"), Utf8View("28207"), Utf8View("14762"), Utf8View("89933"), Utf8View("10930"), Utf8View("27616"), Utf8View("56809"), Utf8View("14244"), Utf8View("22733"), Utf8View("33177"), Utf8View("29784"), Utf8View("74968"), Utf8View("37887"), Utf8View("11299"), Utf8View("34692"), Utf8View("85843"), Utf8View("83663"), Utf8View("95421"), Utf8View("19323"), Utf8View("17406"), Utf8View("69264"), Utf8View("28341"), Utf8View("50150"), Utf8View("79121"), Utf8View("73974"), Utf8View("92917"), Utf8View("21229"), Utf8View("32254"), Utf8View("97408"), Utf8View("46011"), Utf8View("37169"), Utf8View("18146"), Utf8View("27296"), Utf8View("62927"), Utf8View("68812"), Utf8View("47734"), Utf8View("86572"), Utf8View("12620"), Utf8View("80252"), Utf8View("50173"), Utf8View("27261"), Utf8View("29534"), Utf8View("23488"), Utf8View("42184"), Utf8View("23695"), Utf8View("45868"), Utf8View("12910"), Utf8View("23429"), Utf8View("29052"), Utf8View("63228"), Utf8View("30731"), Utf8View("15747"), Utf8View("25827"), Utf8View("22332"), Utf8View("62349"), Utf8View("56661"), Utf8View("44652"), Utf8View("51862"), Utf8View("57007"), Utf8View("22773"), Utf8View("40361"), Utf8View("65238"), Utf8View("19327"), Utf8View("17282"), Utf8View("44708"), Utf8View("35484"), Utf8View("34064"), Utf8View("11148"), Utf8View("92729"), Utf8View("22995"), Utf8View("18833"), Utf8View("77528"), Utf8View("48917"), Utf8View("17256"), Utf8View("93166"), Utf8View("68576"), Utf8View("71096"), Utf8View("56499"), Utf8View("35096"), Utf8View("80551"), Utf8View("82424"), Utf8View("17700"), Utf8View("32748"), Utf8View("78969"), Utf8View("46820"), Utf8View("57725"), Utf8View("46179"), Utf8View("54677"), Utf8View("98097"), Utf8View("62869"), Utf8View("83959"), Utf8View("66728"), Utf8View("19716"), Utf8View("48326"), Utf8View("27420"), Utf8View("53458"), Utf8View("69056"), Utf8View("84216"), Utf8View("36688"), Utf8View("63957"), Utf8View("41469"), Utf8View("66843"), Utf8View("18024"), Utf8View("81950"), Utf8View("21911"), Utf8View("58387"), Utf8View("58103"), Utf8View("19813"), Utf8View("34581"), Utf8View("55347"), Utf8View("17171"), Utf8View("35914"), Utf8View("75043"), Utf8View("75088"), Utf8View("80541"), Utf8View("26802"), Utf8View("28849"), Utf8View("22356"), Utf8View("57721"), Utf8View("77084"), Utf8View("46385"), Utf8View("59255"), Utf8View("29308"), Utf8View("65885"), Utf8View("70673"), Utf8View("13306"), Utf8View("68788"), Utf8View("87335"), Utf8View("40987"), Utf8View("31654"), Utf8View("67560"), Utf8View("92309"), Utf8View("78116"), Utf8View("65961"), Utf8View("45018"), Utf8View("16548"), Utf8View("67092"), Utf8View("21818"), Utf8View("33716"), Utf8View("49449"), Utf8View("86150"), Utf8View("12156"), Utf8View("27574"), Utf8View("43201"), Utf8View("50977"), Utf8View("52839"), Utf8View("33234"), Utf8View("86611"), Utf8View("71494"), Utf8View("17823"), Utf8View("57172"), Utf8View("59869"), Utf8View("34086"), Utf8View("51052"), Utf8View("11320"), Utf8View("39717"), Utf8View("79604"), Utf8View("24672"), Utf8View("70555"), Utf8View("38378"), Utf8View("91135"), Utf8View("15567"), Utf8View("21606"), Utf8View("74994"), Utf8View("77168"), Utf8View("38607"), Utf8View("27384"), Utf8View("68328"), Utf8View("88944"), Utf8View("40203"), Utf8View("37893"), Utf8View("42726"), Utf8View("83549"), Utf8View("48739"), Utf8View("55652"), Utf8View("27543"), Utf8View("23109"), Utf8View("98908"), Utf8View("28831"), Utf8View("45011"), Utf8View("47525"), Utf8View("43870"), Utf8View("79404"), Utf8View("35780"), Utf8View("42136"), Utf8View("49317"), Utf8View("14574"), Utf8View("99586"), Utf8View("21107"), Utf8View("14302"), Utf8View("83882"), Utf8View("81272"), Utf8View("92552"), Utf8View("14916"), Utf8View("87533"), Utf8View("86518"), Utf8View("17862"), Utf8View("30741"), Utf8View("96288"), Utf8View("57886"), Utf8View("30304"), Utf8View("24201"), Utf8View("79457"), Utf8View("36728"), Utf8View("49833"), Utf8View("35182"), Utf8View("20108"), Utf8View("39858"), Utf8View("10804"), Utf8View("47042"), Utf8View("20439"), Utf8View("54708"), Utf8View("59027"), Utf8View("82499"), Utf8View("75311"), Utf8View("26548"), Utf8View("53406"), Utf8View("92060"), Utf8View("41152"), Utf8View("60446"), Utf8View("33129"), Utf8View("43979"), Utf8View("16903"), Utf8View("60319"), Utf8View("35550"), Utf8View("33887"), Utf8View("25463"), Utf8View("40343"), Utf8View("20726"), Utf8View("44429")])
                            Projection: <exprs>
                              Projection: <exprs>
                                SubqueryAlias: customer_address
                                  Projection: <exprs>
                                    Projection: <exprs>
                                      TableScan: ?table?
                      Projection: <exprs>
                        SubqueryAlias: A1
                          Projection: <exprs>
                            Filter: count(Int64(1)) > Int64(10)
                              Aggregate: groupBy=[[customer_address.#<col>]], aggr=[[count(Int64(1))]]
                                Filter: customer_address.#<col> = customer.#<col> AND customer.#<col> = Utf8("Y")
                                  Cross Join: 
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: customer_address
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: customer
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?

logical_plan after replace_distinct_aggregate:
Limit: skip=0, fetch=100
  Projection: <exprs>
    Sort: <exprs>
      Projection: <exprs>
        Aggregate: groupBy=[[store.#<col>]], aggr=[[sum(store_sales.#<col>)]]
          Filter: store_sales.#<col> = CAST(store.#<col> AS Float64) AND store_sales.#<col> = CAST(date_dim.#<col> AS Float64) AND date_dim.#<col> = Int64(1) AND date_dim.#<col> = Int64(2000) AND CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8) = CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)
            Cross Join: 
              Cross Join: 
                Cross Join: 
                  Projection: <exprs>
                    Projection: <exprs>
                      SubqueryAlias: store_sales
                        Projection: <exprs>
                          Projection: <exprs>
                            TableScan: ?table?
                  Projection: <exprs>
                    Projection: <exprs>
                      SubqueryAlias: date_dim
                        Projection: <exprs>
                          Projection: <exprs>
                            TableScan: ?table?
                Projection: <exprs>
                  Projection: <exprs>
                    SubqueryAlias: store
                      Projection: <exprs>
                        Projection: <exprs>
                          TableScan: ?table?
              SubqueryAlias: V1
                Projection: <exprs>
                  SubqueryAlias: A2
                    LeftSemi Join: #<col> = #<col>
                      Aggregate: groupBy=[[#<col>]], aggr=[[]]
                        Projection: <exprs>
                          Filter: substr(CAST(customer_address.#<col> AS Utf8), Int64(1), Int64(5)) IN ([Utf8View("19100"), Utf8View("41548"), Utf8View("51640"), Utf8View("49699"), Utf8View("88329"), Utf8View("55986"), Utf8View("85119"), Utf8View("19510"), Utf8View("61020"), Utf8View("95452"), Utf8View("26235"), Utf8View("51102"), Utf8View("16733"), Utf8View("42819"), Utf8View("27823"), Utf8View("90192"), Utf8View("31905"), Utf8View("28865"), Utf8View("62197"), Utf8View("23750"), Utf8View("81398"), Utf8View("95288"), Utf8View("45114"), Utf8View("82060"), Utf8View("12313"), Utf8View("25218"), Utf8View("64386"), Utf8View("46400"), Utf8View("77230"), Utf8View("69271"), Utf8View("43672"), Utf8View("36521"), Utf8View("34217"), Utf8View("13017"), Utf8View("27936"), Utf8View("42766"), Utf8View("59233"), Utf8View("26060"), Utf8View("27477"), Utf8View("39981"), Utf8View("93402"), Utf8View("74270"), Utf8View("13932"), Utf8View("51731"), Utf8View("71642"), Utf8View("17710"), Utf8View("85156"), Utf8View("21679"), Utf8View("70840"), Utf8View("67191"), Utf8View("39214"), Utf8View("35273"), Utf8View("27293"), Utf8View("17128"), Utf8View("15458"), Utf8View("31615"), Utf8View("60706"), Utf8View("67657"), Utf8View("54092"), Utf8View("32775"), Utf8View("14683"), Utf8View("32206"), Utf8View("62543"), Utf8View("43053"), Utf8View("11297"), Utf8View("58216"), Utf8View("49410"), Utf8View("14710"), Utf8View("24501"), Utf8View("79057"), Utf8View("77038"), Utf8View("91286"), Utf8View("32334"), Utf8View("46298"), Utf8View("18326"), Utf8View("67213"), Utf8View("65382"), Utf8View("40315"), Utf8View("56115"), Utf8View("80162"), Utf8View("55956"), Utf8View("81583"), Utf8View("73588"), Utf8View("32513"), Utf8View("62880"), Utf8View("12201"), Utf8View("11592"), Utf8View("17014"), Utf8View("83832"), Utf8View("61796"), Utf8View("57872"), Utf8View("78829"), Utf8View("69912"), Utf8View("48524"), Utf8View("22016"), Utf8View("26905"), Utf8View("48511"), Utf8View("92168"), Utf8View("63051"), Utf8View("25748"), Utf8View("89786"), Utf8View("98827"), Utf8View("86404"), Utf8View("53029"), Utf8View("37524"), Utf8View("14039"), Utf8View("50078"), Utf8View("34487"), Utf8View("70142"), Utf8View("18697"), Utf8View("40129"), Utf8View("60642"), Utf8View("42810"), Utf8View("62667"), Utf8View("57183"), Utf8View("46414"), Utf8View("58463"), Utf8View("71211"), Utf8View("46364"), Utf8View("34851"), Utf8View("54884"), Utf8View("25382"), Utf8View("25239"), Utf8View("74126"), Utf8View("21568"), Utf8View("84204"), Utf8View("13607"), Utf8View("82518"), Utf8View("32982"), Utf8View("36953"), Utf8View("86001"), Utf8View("79278"), Utf8View("21745"), Utf8View("64444"), Utf8View("35199"), Utf8View("83181"), Utf8View("73255"), Utf8View("86177"), Utf8View("98043"), Utf8View("90392"), Utf8View("13882"), Utf8View("47084"), Utf8View("17859"), Utf8View("89526"), Utf8View("42072"), Utf8View("20233"), Utf8View("52745"), Utf8View("75000"), Utf8View("22044"), Utf8View("77013"), Utf8View("24182"), Utf8View("52554"), Utf8View("56138"), Utf8View("43440"), Utf8View("86100"), Utf8View("48791"), Utf8View("21883"), Utf8View("17096"), Utf8View("15965"), Utf8View("31196"), Utf8View("74903"), Utf8View("19810"), Utf8View("35763"), Utf8View("92020"), Utf8View("55176"), Utf8View("54433"), Utf8View("68063"), Utf8View("71919"), Utf8View("44384"), Utf8View("16612"), Utf8View("32109"), Utf8View("28207"), Utf8View("14762"), Utf8View("89933"), Utf8View("10930"), Utf8View("27616"), Utf8View("56809"), Utf8View("14244"), Utf8View("22733"), Utf8View("33177"), Utf8View("29784"), Utf8View("74968"), Utf8View("37887"), Utf8View("11299"), Utf8View("34692"), Utf8View("85843"), Utf8View("83663"), Utf8View("95421"), Utf8View("19323"), Utf8View("17406"), Utf8View("69264"), Utf8View("28341"), Utf8View("50150"), Utf8View("79121"), Utf8View("73974"), Utf8View("92917"), Utf8View("21229"), Utf8View("32254"), Utf8View("97408"), Utf8View("46011"), Utf8View("37169"), Utf8View("18146"), Utf8View("27296"), Utf8View("62927"), Utf8View("68812"), Utf8View("47734"), Utf8View("86572"), Utf8View("12620"), Utf8View("80252"), Utf8View("50173"), Utf8View("27261"), Utf8View("29534"), Utf8View("23488"), Utf8View("42184"), Utf8View("23695"), Utf8View("45868"), Utf8View("12910"), Utf8View("23429"), Utf8View("29052"), Utf8View("63228"), Utf8View("30731"), Utf8View("15747"), Utf8View("25827"), Utf8View("22332"), Utf8View("62349"), Utf8View("56661"), Utf8View("44652"), Utf8View("51862"), Utf8View("57007"), Utf8View("22773"), Utf8View("40361"), Utf8View("65238"), Utf8View("19327"), Utf8View("17282"), Utf8View("44708"), Utf8View("35484"), Utf8View("34064"), Utf8View("11148"), Utf8View("92729"), Utf8View("22995"), Utf8View("18833"), Utf8View("77528"), Utf8View("48917"), Utf8View("17256"), Utf8View("93166"), Utf8View("68576"), Utf8View("71096"), Utf8View("56499"), Utf8View("35096"), Utf8View("80551"), Utf8View("82424"), Utf8View("17700"), Utf8View("32748"), Utf8View("78969"), Utf8View("46820"), Utf8View("57725"), Utf8View("46179"), Utf8View("54677"), Utf8View("98097"), Utf8View("62869"), Utf8View("83959"), Utf8View("66728"), Utf8View("19716"), Utf8View("48326"), Utf8View("27420"), Utf8View("53458"), Utf8View("69056"), Utf8View("84216"), Utf8View("36688"), Utf8View("63957"), Utf8View("41469"), Utf8View("66843"), Utf8View("18024"), Utf8View("81950"), Utf8View("21911"), Utf8View("58387"), Utf8View("58103"), Utf8View("19813"), Utf8View("34581"), Utf8View("55347"), Utf8View("17171"), Utf8View("35914"), Utf8View("75043"), Utf8View("75088"), Utf8View("80541"), Utf8View("26802"), Utf8View("28849"), Utf8View("22356"), Utf8View("57721"), Utf8View("77084"), Utf8View("46385"), Utf8View("59255"), Utf8View("29308"), Utf8View("65885"), Utf8View("70673"), Utf8View("13306"), Utf8View("68788"), Utf8View("87335"), Utf8View("40987"), Utf8View("31654"), Utf8View("67560"), Utf8View("92309"), Utf8View("78116"), Utf8View("65961"), Utf8View("45018"), Utf8View("16548"), Utf8View("67092"), Utf8View("21818"), Utf8View("33716"), Utf8View("49449"), Utf8View("86150"), Utf8View("12156"), Utf8View("27574"), Utf8View("43201"), Utf8View("50977"), Utf8View("52839"), Utf8View("33234"), Utf8View("86611"), Utf8View("71494"), Utf8View("17823"), Utf8View("57172"), Utf8View("59869"), Utf8View("34086"), Utf8View("51052"), Utf8View("11320"), Utf8View("39717"), Utf8View("79604"), Utf8View("24672"), Utf8View("70555"), Utf8View("38378"), Utf8View("91135"), Utf8View("15567"), Utf8View("21606"), Utf8View("74994"), Utf8View("77168"), Utf8View("38607"), Utf8View("27384"), Utf8View("68328"), Utf8View("88944"), Utf8View("40203"), Utf8View("37893"), Utf8View("42726"), Utf8View("83549"), Utf8View("48739"), Utf8View("55652"), Utf8View("27543"), Utf8View("23109"), Utf8View("98908"), Utf8View("28831"), Utf8View("45011"), Utf8View("47525"), Utf8View("43870"), Utf8View("79404"), Utf8View("35780"), Utf8View("42136"), Utf8View("49317"), Utf8View("14574"), Utf8View("99586"), Utf8View("21107"), Utf8View("14302"), Utf8View("83882"), Utf8View("81272"), Utf8View("92552"), Utf8View("14916"), Utf8View("87533"), Utf8View("86518"), Utf8View("17862"), Utf8View("30741"), Utf8View("96288"), Utf8View("57886"), Utf8View("30304"), Utf8View("24201"), Utf8View("79457"), Utf8View("36728"), Utf8View("49833"), Utf8View("35182"), Utf8View("20108"), Utf8View("39858"), Utf8View("10804"), Utf8View("47042"), Utf8View("20439"), Utf8View("54708"), Utf8View("59027"), Utf8View("82499"), Utf8View("75311"), Utf8View("26548"), Utf8View("53406"), Utf8View("92060"), Utf8View("41152"), Utf8View("60446"), Utf8View("33129"), Utf8View("43979"), Utf8View("16903"), Utf8View("60319"), Utf8View("35550"), Utf8View("33887"), Utf8View("25463"), Utf8View("40343"), Utf8View("20726"), Utf8View("44429")])
                            Projection: <exprs>
                              Projection: <exprs>
                                SubqueryAlias: customer_address
                                  Projection: <exprs>
                                    Projection: <exprs>
                                      TableScan: ?table?
                      Projection: <exprs>
                        SubqueryAlias: A1
                          Projection: <exprs>
                            Filter: count(Int64(1)) > Int64(10)
                              Aggregate: groupBy=[[customer_address.#<col>]], aggr=[[count(Int64(1))]]
                                Filter: customer_address.#<col> = customer.#<col> AND customer.#<col> = Utf8("Y")
                                  Cross Join: 
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: customer_address
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        SubqueryAlias: customer
                                          Projection: <exprs>
                                            Projection: <exprs>
                                              TableScan: ?table?

logical_plan after eliminate_join:
SAME TEXT AS ABOVE

logical_plan after decorrelate_predicate_subquery:
SAME TEXT AS ABOVE

logical_plan after scalar_subquery_to_join:
SAME TEXT AS ABOVE

logical_plan after decorrelate_lateral_join:
SAME TEXT AS ABOVE

logical_plan after extract_equijoin_predicate:
SAME TEXT AS ABOVE

logical_plan after eliminate_duplicated_expr:
SAME TEXT AS ABOVE

logical_plan after eliminate_filter:
SAME TEXT AS ABOVE

logical_plan after eliminate_cross_join:
Limit: skip=0, fetch=100
  Projection: <exprs>
    Sort: <exprs>
      Projection: <exprs>
        Aggregate: groupBy=[[store.#<col>]], aggr=[[sum(store_sales.#<col>)]]
          Filter: date_dim.#<col> = Int64(1) AND date_dim.#<col> = Int64(2000)
            Projection: <exprs>
              Inner Join: CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8) = CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)
                Inner Join: store_sales.#<col> = CAST(store.#<col> AS Float64)
                  Inner Join: store_sales.#<col> = CAST(date_dim.#<col> AS Float64)
                    Projection: <exprs>
                      Projection: <exprs>
                        SubqueryAlias: store_sales
                          Projection: <exprs>
                            Projection: <exprs>
                              TableScan: ?table?
                    Projection: <exprs>
                      Projection: <exprs>
                        SubqueryAlias: date_dim
                          Projection: <exprs>
                            Projection: <exprs>
                              TableScan: ?table?
                  Projection: <exprs>
                    Projection: <exprs>
                      SubqueryAlias: store
                        Projection: <exprs>
                          Projection: <exprs>
                            TableScan: ?table?
                SubqueryAlias: V1
                  Projection: <exprs>
                    SubqueryAlias: A2
                      LeftSemi Join: #<col> = #<col>
                        Aggregate: groupBy=[[#<col>]], aggr=[[]]
                          Projection: <exprs>
                            Filter: substr(CAST(customer_address.#<col> AS Utf8), Int64(1), Int64(5)) IN ([Utf8View("19100"), Utf8View("41548"), Utf8View("51640"), Utf8View("49699"), Utf8View("88329"), Utf8View("55986"), Utf8View("85119"), Utf8View("19510"), Utf8View("61020"), Utf8View("95452"), Utf8View("26235"), Utf8View("51102"), Utf8View("16733"), Utf8View("42819"), Utf8View("27823"), Utf8View("90192"), Utf8View("31905"), Utf8View("28865"), Utf8View("62197"), Utf8View("23750"), Utf8View("81398"), Utf8View("95288"), Utf8View("45114"), Utf8View("82060"), Utf8View("12313"), Utf8View("25218"), Utf8View("64386"), Utf8View("46400"), Utf8View("77230"), Utf8View("69271"), Utf8View("43672"), Utf8View("36521"), Utf8View("34217"), Utf8View("13017"), Utf8View("27936"), Utf8View("42766"), Utf8View("59233"), Utf8View("26060"), Utf8View("27477"), Utf8View("39981"), Utf8View("93402"), Utf8View("74270"), Utf8View("13932"), Utf8View("51731"), Utf8View("71642"), Utf8View("17710"), Utf8View("85156"), Utf8View("21679"), Utf8View("70840"), Utf8View("67191"), Utf8View("39214"), Utf8View("35273"), Utf8View("27293"), Utf8View("17128"), Utf8View("15458"), Utf8View("31615"), Utf8View("60706"), Utf8View("67657"), Utf8View("54092"), Utf8View("32775"), Utf8View("14683"), Utf8View("32206"), Utf8View("62543"), Utf8View("43053"), Utf8View("11297"), Utf8View("58216"), Utf8View("49410"), Utf8View("14710"), Utf8View("24501"), Utf8View("79057"), Utf8View("77038"), Utf8View("91286"), Utf8View("32334"), Utf8View("46298"), Utf8View("18326"), Utf8View("67213"), Utf8View("65382"), Utf8View("40315"), Utf8View("56115"), Utf8View("80162"), Utf8View("55956"), Utf8View("81583"), Utf8View("73588"), Utf8View("32513"), Utf8View("62880"), Utf8View("12201"), Utf8View("11592"), Utf8View("17014"), Utf8View("83832"), Utf8View("61796"), Utf8View("57872"), Utf8View("78829"), Utf8View("69912"), Utf8View("48524"), Utf8View("22016"), Utf8View("26905"), Utf8View("48511"), Utf8View("92168"), Utf8View("63051"), Utf8View("25748"), Utf8View("89786"), Utf8View("98827"), Utf8View("86404"), Utf8View("53029"), Utf8View("37524"), Utf8View("14039"), Utf8View("50078"), Utf8View("34487"), Utf8View("70142"), Utf8View("18697"), Utf8View("40129"), Utf8View("60642"), Utf8View("42810"), Utf8View("62667"), Utf8View("57183"), Utf8View("46414"), Utf8View("58463"), Utf8View("71211"), Utf8View("46364"), Utf8View("34851"), Utf8View("54884"), Utf8View("25382"), Utf8View("25239"), Utf8View("74126"), Utf8View("21568"), Utf8View("84204"), Utf8View("13607"), Utf8View("82518"), Utf8View("32982"), Utf8View("36953"), Utf8View("86001"), Utf8View("79278"), Utf8View("21745"), Utf8View("64444"), Utf8View("35199"), Utf8View("83181"), Utf8View("73255"), Utf8View("86177"), Utf8View("98043"), Utf8View("90392"), Utf8View("13882"), Utf8View("47084"), Utf8View("17859"), Utf8View("89526"), Utf8View("42072"), Utf8View("20233"), Utf8View("52745"), Utf8View("75000"), Utf8View("22044"), Utf8View("77013"), Utf8View("24182"), Utf8View("52554"), Utf8View("56138"), Utf8View("43440"), Utf8View("86100"), Utf8View("48791"), Utf8View("21883"), Utf8View("17096"), Utf8View("15965"), Utf8View("31196"), Utf8View("74903"), Utf8View("19810"), Utf8View("35763"), Utf8View("92020"), Utf8View("55176"), Utf8View("54433"), Utf8View("68063"), Utf8View("71919"), Utf8View("44384"), Utf8View("16612"), Utf8View("32109"), Utf8View("28207"), Utf8View("14762"), Utf8View("89933"), Utf8View("10930"), Utf8View("27616"), Utf8View("56809"), Utf8View("14244"), Utf8View("22733"), Utf8View("33177"), Utf8View("29784"), Utf8View("74968"), Utf8View("37887"), Utf8View("11299"), Utf8View("34692"), Utf8View("85843"), Utf8View("83663"), Utf8View("95421"), Utf8View("19323"), Utf8View("17406"), Utf8View("69264"), Utf8View("28341"), Utf8View("50150"), Utf8View("79121"), Utf8View("73974"), Utf8View("92917"), Utf8View("21229"), Utf8View("32254"), Utf8View("97408"), Utf8View("46011"), Utf8View("37169"), Utf8View("18146"), Utf8View("27296"), Utf8View("62927"), Utf8View("68812"), Utf8View("47734"), Utf8View("86572"), Utf8View("12620"), Utf8View("80252"), Utf8View("50173"), Utf8View("27261"), Utf8View("29534"), Utf8View("23488"), Utf8View("42184"), Utf8View("23695"), Utf8View("45868"), Utf8View("12910"), Utf8View("23429"), Utf8View("29052"), Utf8View("63228"), Utf8View("30731"), Utf8View("15747"), Utf8View("25827"), Utf8View("22332"), Utf8View("62349"), Utf8View("56661"), Utf8View("44652"), Utf8View("51862"), Utf8View("57007"), Utf8View("22773"), Utf8View("40361"), Utf8View("65238"), Utf8View("19327"), Utf8View("17282"), Utf8View("44708"), Utf8View("35484"), Utf8View("34064"), Utf8View("11148"), Utf8View("92729"), Utf8View("22995"), Utf8View("18833"), Utf8View("77528"), Utf8View("48917"), Utf8View("17256"), Utf8View("93166"), Utf8View("68576"), Utf8View("71096"), Utf8View("56499"), Utf8View("35096"), Utf8View("80551"), Utf8View("82424"), Utf8View("17700"), Utf8View("32748"), Utf8View("78969"), Utf8View("46820"), Utf8View("57725"), Utf8View("46179"), Utf8View("54677"), Utf8View("98097"), Utf8View("62869"), Utf8View("83959"), Utf8View("66728"), Utf8View("19716"), Utf8View("48326"), Utf8View("27420"), Utf8View("53458"), Utf8View("69056"), Utf8View("84216"), Utf8View("36688"), Utf8View("63957"), Utf8View("41469"), Utf8View("66843"), Utf8View("18024"), Utf8View("81950"), Utf8View("21911"), Utf8View("58387"), Utf8View("58103"), Utf8View("19813"), Utf8View("34581"), Utf8View("55347"), Utf8View("17171"), Utf8View("35914"), Utf8View("75043"), Utf8View("75088"), Utf8View("80541"), Utf8View("26802"), Utf8View("28849"), Utf8View("22356"), Utf8View("57721"), Utf8View("77084"), Utf8View("46385"), Utf8View("59255"), Utf8View("29308"), Utf8View("65885"), Utf8View("70673"), Utf8View("13306"), Utf8View("68788"), Utf8View("87335"), Utf8View("40987"), Utf8View("31654"), Utf8View("67560"), Utf8View("92309"), Utf8View("78116"), Utf8View("65961"), Utf8View("45018"), Utf8View("16548"), Utf8View("67092"), Utf8View("21818"), Utf8View("33716"), Utf8View("49449"), Utf8View("86150"), Utf8View("12156"), Utf8View("27574"), Utf8View("43201"), Utf8View("50977"), Utf8View("52839"), Utf8View("33234"), Utf8View("86611"), Utf8View("71494"), Utf8View("17823"), Utf8View("57172"), Utf8View("59869"), Utf8View("34086"), Utf8View("51052"), Utf8View("11320"), Utf8View("39717"), Utf8View("79604"), Utf8View("24672"), Utf8View("70555"), Utf8View("38378"), Utf8View("91135"), Utf8View("15567"), Utf8View("21606"), Utf8View("74994"), Utf8View("77168"), Utf8View("38607"), Utf8View("27384"), Utf8View("68328"), Utf8View("88944"), Utf8View("40203"), Utf8View("37893"), Utf8View("42726"), Utf8View("83549"), Utf8View("48739"), Utf8View("55652"), Utf8View("27543"), Utf8View("23109"), Utf8View("98908"), Utf8View("28831"), Utf8View("45011"), Utf8View("47525"), Utf8View("43870"), Utf8View("79404"), Utf8View("35780"), Utf8View("42136"), Utf8View("49317"), Utf8View("14574"), Utf8View("99586"), Utf8View("21107"), Utf8View("14302"), Utf8View("83882"), Utf8View("81272"), Utf8View("92552"), Utf8View("14916"), Utf8View("87533"), Utf8View("86518"), Utf8View("17862"), Utf8View("30741"), Utf8View("96288"), Utf8View("57886"), Utf8View("30304"), Utf8View("24201"), Utf8View("79457"), Utf8View("36728"), Utf8View("49833"), Utf8View("35182"), Utf8View("20108"), Utf8View("39858"), Utf8View("10804"), Utf8View("47042"), Utf8View("20439"), Utf8View("54708"), Utf8View("59027"), Utf8View("82499"), Utf8View("75311"), Utf8View("26548"), Utf8View("53406"), Utf8View("92060"), Utf8View("41152"), Utf8View("60446"), Utf8View("33129"), Utf8View("43979"), Utf8View("16903"), Utf8View("60319"), Utf8View("35550"), Utf8View("33887"), Utf8View("25463"), Utf8View("40343"), Utf8View("20726"), Utf8View("44429")])
                              Projection: <exprs>
                                Projection: <exprs>
                                  SubqueryAlias: customer_address
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        TableScan: ?table?
                        Projection: <exprs>
                          SubqueryAlias: A1
                            Projection: <exprs>
                              Filter: count(Int64(1)) > Int64(10)
                                Aggregate: groupBy=[[customer_address.#<col>]], aggr=[[count(Int64(1))]]
                                  Filter: customer.#<col> = Utf8("Y")
                                    Inner Join: customer_address.#<col> = customer.#<col>
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          SubqueryAlias: customer_address
                                            Projection: <exprs>
                                              Projection: <exprs>
                                                TableScan: ?table?
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          SubqueryAlias: customer
                                            Projection: <exprs>
                                              Projection: <exprs>
                                                TableScan: ?table?

logical_plan after eliminate_limit:
SAME TEXT AS ABOVE

logical_plan after propagate_empty_relation:
SAME TEXT AS ABOVE

logical_plan after eliminate_one_union:
SAME TEXT AS ABOVE

logical_plan after filter_null_join_keys:
SAME TEXT AS ABOVE

logical_plan after eliminate_outer_join:
SAME TEXT AS ABOVE

logical_plan after push_down_limit:
Projection: <exprs>
  Limit: skip=0, fetch=100
    Sort: <exprs>
      Projection: <exprs>
        Aggregate: groupBy=[[store.#<col>]], aggr=[[sum(store_sales.#<col>)]]
          Filter: date_dim.#<col> = Int64(1) AND date_dim.#<col> = Int64(2000)
            Projection: <exprs>
              Inner Join: CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8) = CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)
                Inner Join: store_sales.#<col> = CAST(store.#<col> AS Float64)
                  Inner Join: store_sales.#<col> = CAST(date_dim.#<col> AS Float64)
                    Projection: <exprs>
                      Projection: <exprs>
                        SubqueryAlias: store_sales
                          Projection: <exprs>
                            Projection: <exprs>
                              TableScan: ?table?
                    Projection: <exprs>
                      Projection: <exprs>
                        SubqueryAlias: date_dim
                          Projection: <exprs>
                            Projection: <exprs>
                              TableScan: ?table?
                  Projection: <exprs>
                    Projection: <exprs>
                      SubqueryAlias: store
                        Projection: <exprs>
                          Projection: <exprs>
                            TableScan: ?table?
                SubqueryAlias: V1
                  Projection: <exprs>
                    SubqueryAlias: A2
                      LeftSemi Join: #<col> = #<col>
                        Aggregate: groupBy=[[#<col>]], aggr=[[]]
                          Projection: <exprs>
                            Filter: substr(CAST(customer_address.#<col> AS Utf8), Int64(1), Int64(5)) IN ([Utf8View("19100"), Utf8View("41548"), Utf8View("51640"), Utf8View("49699"), Utf8View("88329"), Utf8View("55986"), Utf8View("85119"), Utf8View("19510"), Utf8View("61020"), Utf8View("95452"), Utf8View("26235"), Utf8View("51102"), Utf8View("16733"), Utf8View("42819"), Utf8View("27823"), Utf8View("90192"), Utf8View("31905"), Utf8View("28865"), Utf8View("62197"), Utf8View("23750"), Utf8View("81398"), Utf8View("95288"), Utf8View("45114"), Utf8View("82060"), Utf8View("12313"), Utf8View("25218"), Utf8View("64386"), Utf8View("46400"), Utf8View("77230"), Utf8View("69271"), Utf8View("43672"), Utf8View("36521"), Utf8View("34217"), Utf8View("13017"), Utf8View("27936"), Utf8View("42766"), Utf8View("59233"), Utf8View("26060"), Utf8View("27477"), Utf8View("39981"), Utf8View("93402"), Utf8View("74270"), Utf8View("13932"), Utf8View("51731"), Utf8View("71642"), Utf8View("17710"), Utf8View("85156"), Utf8View("21679"), Utf8View("70840"), Utf8View("67191"), Utf8View("39214"), Utf8View("35273"), Utf8View("27293"), Utf8View("17128"), Utf8View("15458"), Utf8View("31615"), Utf8View("60706"), Utf8View("67657"), Utf8View("54092"), Utf8View("32775"), Utf8View("14683"), Utf8View("32206"), Utf8View("62543"), Utf8View("43053"), Utf8View("11297"), Utf8View("58216"), Utf8View("49410"), Utf8View("14710"), Utf8View("24501"), Utf8View("79057"), Utf8View("77038"), Utf8View("91286"), Utf8View("32334"), Utf8View("46298"), Utf8View("18326"), Utf8View("67213"), Utf8View("65382"), Utf8View("40315"), Utf8View("56115"), Utf8View("80162"), Utf8View("55956"), Utf8View("81583"), Utf8View("73588"), Utf8View("32513"), Utf8View("62880"), Utf8View("12201"), Utf8View("11592"), Utf8View("17014"), Utf8View("83832"), Utf8View("61796"), Utf8View("57872"), Utf8View("78829"), Utf8View("69912"), Utf8View("48524"), Utf8View("22016"), Utf8View("26905"), Utf8View("48511"), Utf8View("92168"), Utf8View("63051"), Utf8View("25748"), Utf8View("89786"), Utf8View("98827"), Utf8View("86404"), Utf8View("53029"), Utf8View("37524"), Utf8View("14039"), Utf8View("50078"), Utf8View("34487"), Utf8View("70142"), Utf8View("18697"), Utf8View("40129"), Utf8View("60642"), Utf8View("42810"), Utf8View("62667"), Utf8View("57183"), Utf8View("46414"), Utf8View("58463"), Utf8View("71211"), Utf8View("46364"), Utf8View("34851"), Utf8View("54884"), Utf8View("25382"), Utf8View("25239"), Utf8View("74126"), Utf8View("21568"), Utf8View("84204"), Utf8View("13607"), Utf8View("82518"), Utf8View("32982"), Utf8View("36953"), Utf8View("86001"), Utf8View("79278"), Utf8View("21745"), Utf8View("64444"), Utf8View("35199"), Utf8View("83181"), Utf8View("73255"), Utf8View("86177"), Utf8View("98043"), Utf8View("90392"), Utf8View("13882"), Utf8View("47084"), Utf8View("17859"), Utf8View("89526"), Utf8View("42072"), Utf8View("20233"), Utf8View("52745"), Utf8View("75000"), Utf8View("22044"), Utf8View("77013"), Utf8View("24182"), Utf8View("52554"), Utf8View("56138"), Utf8View("43440"), Utf8View("86100"), Utf8View("48791"), Utf8View("21883"), Utf8View("17096"), Utf8View("15965"), Utf8View("31196"), Utf8View("74903"), Utf8View("19810"), Utf8View("35763"), Utf8View("92020"), Utf8View("55176"), Utf8View("54433"), Utf8View("68063"), Utf8View("71919"), Utf8View("44384"), Utf8View("16612"), Utf8View("32109"), Utf8View("28207"), Utf8View("14762"), Utf8View("89933"), Utf8View("10930"), Utf8View("27616"), Utf8View("56809"), Utf8View("14244"), Utf8View("22733"), Utf8View("33177"), Utf8View("29784"), Utf8View("74968"), Utf8View("37887"), Utf8View("11299"), Utf8View("34692"), Utf8View("85843"), Utf8View("83663"), Utf8View("95421"), Utf8View("19323"), Utf8View("17406"), Utf8View("69264"), Utf8View("28341"), Utf8View("50150"), Utf8View("79121"), Utf8View("73974"), Utf8View("92917"), Utf8View("21229"), Utf8View("32254"), Utf8View("97408"), Utf8View("46011"), Utf8View("37169"), Utf8View("18146"), Utf8View("27296"), Utf8View("62927"), Utf8View("68812"), Utf8View("47734"), Utf8View("86572"), Utf8View("12620"), Utf8View("80252"), Utf8View("50173"), Utf8View("27261"), Utf8View("29534"), Utf8View("23488"), Utf8View("42184"), Utf8View("23695"), Utf8View("45868"), Utf8View("12910"), Utf8View("23429"), Utf8View("29052"), Utf8View("63228"), Utf8View("30731"), Utf8View("15747"), Utf8View("25827"), Utf8View("22332"), Utf8View("62349"), Utf8View("56661"), Utf8View("44652"), Utf8View("51862"), Utf8View("57007"), Utf8View("22773"), Utf8View("40361"), Utf8View("65238"), Utf8View("19327"), Utf8View("17282"), Utf8View("44708"), Utf8View("35484"), Utf8View("34064"), Utf8View("11148"), Utf8View("92729"), Utf8View("22995"), Utf8View("18833"), Utf8View("77528"), Utf8View("48917"), Utf8View("17256"), Utf8View("93166"), Utf8View("68576"), Utf8View("71096"), Utf8View("56499"), Utf8View("35096"), Utf8View("80551"), Utf8View("82424"), Utf8View("17700"), Utf8View("32748"), Utf8View("78969"), Utf8View("46820"), Utf8View("57725"), Utf8View("46179"), Utf8View("54677"), Utf8View("98097"), Utf8View("62869"), Utf8View("83959"), Utf8View("66728"), Utf8View("19716"), Utf8View("48326"), Utf8View("27420"), Utf8View("53458"), Utf8View("69056"), Utf8View("84216"), Utf8View("36688"), Utf8View("63957"), Utf8View("41469"), Utf8View("66843"), Utf8View("18024"), Utf8View("81950"), Utf8View("21911"), Utf8View("58387"), Utf8View("58103"), Utf8View("19813"), Utf8View("34581"), Utf8View("55347"), Utf8View("17171"), Utf8View("35914"), Utf8View("75043"), Utf8View("75088"), Utf8View("80541"), Utf8View("26802"), Utf8View("28849"), Utf8View("22356"), Utf8View("57721"), Utf8View("77084"), Utf8View("46385"), Utf8View("59255"), Utf8View("29308"), Utf8View("65885"), Utf8View("70673"), Utf8View("13306"), Utf8View("68788"), Utf8View("87335"), Utf8View("40987"), Utf8View("31654"), Utf8View("67560"), Utf8View("92309"), Utf8View("78116"), Utf8View("65961"), Utf8View("45018"), Utf8View("16548"), Utf8View("67092"), Utf8View("21818"), Utf8View("33716"), Utf8View("49449"), Utf8View("86150"), Utf8View("12156"), Utf8View("27574"), Utf8View("43201"), Utf8View("50977"), Utf8View("52839"), Utf8View("33234"), Utf8View("86611"), Utf8View("71494"), Utf8View("17823"), Utf8View("57172"), Utf8View("59869"), Utf8View("34086"), Utf8View("51052"), Utf8View("11320"), Utf8View("39717"), Utf8View("79604"), Utf8View("24672"), Utf8View("70555"), Utf8View("38378"), Utf8View("91135"), Utf8View("15567"), Utf8View("21606"), Utf8View("74994"), Utf8View("77168"), Utf8View("38607"), Utf8View("27384"), Utf8View("68328"), Utf8View("88944"), Utf8View("40203"), Utf8View("37893"), Utf8View("42726"), Utf8View("83549"), Utf8View("48739"), Utf8View("55652"), Utf8View("27543"), Utf8View("23109"), Utf8View("98908"), Utf8View("28831"), Utf8View("45011"), Utf8View("47525"), Utf8View("43870"), Utf8View("79404"), Utf8View("35780"), Utf8View("42136"), Utf8View("49317"), Utf8View("14574"), Utf8View("99586"), Utf8View("21107"), Utf8View("14302"), Utf8View("83882"), Utf8View("81272"), Utf8View("92552"), Utf8View("14916"), Utf8View("87533"), Utf8View("86518"), Utf8View("17862"), Utf8View("30741"), Utf8View("96288"), Utf8View("57886"), Utf8View("30304"), Utf8View("24201"), Utf8View("79457"), Utf8View("36728"), Utf8View("49833"), Utf8View("35182"), Utf8View("20108"), Utf8View("39858"), Utf8View("10804"), Utf8View("47042"), Utf8View("20439"), Utf8View("54708"), Utf8View("59027"), Utf8View("82499"), Utf8View("75311"), Utf8View("26548"), Utf8View("53406"), Utf8View("92060"), Utf8View("41152"), Utf8View("60446"), Utf8View("33129"), Utf8View("43979"), Utf8View("16903"), Utf8View("60319"), Utf8View("35550"), Utf8View("33887"), Utf8View("25463"), Utf8View("40343"), Utf8View("20726"), Utf8View("44429")])
                              Projection: <exprs>
                                Projection: <exprs>
                                  SubqueryAlias: customer_address
                                    Projection: <exprs>
                                      Projection: <exprs>
                                        TableScan: ?table?
                        Projection: <exprs>
                          SubqueryAlias: A1
                            Projection: <exprs>
                              Filter: count(Int64(1)) > Int64(10)
                                Aggregate: groupBy=[[customer_address.#<col>]], aggr=[[count(Int64(1))]]
                                  Filter: customer.#<col> = Utf8("Y")
                                    Inner Join: customer_address.#<col> = customer.#<col>
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          SubqueryAlias: customer_address
                                            Projection: <exprs>
                                              Projection: <exprs>
                                                TableScan: ?table?
                                      Projection: <exprs>
                                        Projection: <exprs>
                                          SubqueryAlias: customer
                                            Projection: <exprs>
                                              Projection: <exprs>
                                                TableScan: ?table?

logical_plan after push_down_filter:
Projection: <exprs>
  Limit: skip=0, fetch=100
    Sort: <exprs>
      Projection: <exprs>
        Aggregate: groupBy=[[store.#<col>]], aggr=[[sum(store_sales.#<col>)]]
          Projection: <exprs>
            Inner Join: CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8) = CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)
              Inner Join: store_sales.#<col> = CAST(store.#<col> AS Float64)
                Inner Join: store_sales.#<col> = CAST(date_dim.#<col> AS Float64)
                  Projection: <exprs>
                    Projection: <exprs>
                      SubqueryAlias: store_sales
                        Projection: <exprs>
                          Projection: <exprs>
                            TableScan: ?table?
                  Projection: <exprs>
                    Projection: <exprs>
                      SubqueryAlias: date_dim
                        Projection: <exprs>
                          Projection: <exprs>
                            Filter: ?table?._10 = Int64(1) AND ?table?._6 = Int64(2000)
                              TableScan: ?table?
                Projection: <exprs>
                  Projection: <exprs>
                    SubqueryAlias: store
                      Projection: <exprs>
                        Projection: <exprs>
                          TableScan: ?table?
              SubqueryAlias: V1
                Projection: <exprs>
                  SubqueryAlias: A2
                    LeftSemi Join: #<col> = #<col>
                      Aggregate: groupBy=[[#<col>]], aggr=[[]]
                        Projection: <exprs>
                          Projection: <exprs>
                            Projection: <exprs>
                              SubqueryAlias: customer_address
                                Projection: <exprs>
                                  Projection: <exprs>
                                    Filter: substr(CAST(?table?._9 AS Utf8), Int64(1), Int64(5)) IN ([Utf8View("19100"), Utf8View("41548"), Utf8View("51640"), Utf8View("49699"), Utf8View("88329"), Utf8View("55986"), Utf8View("85119"), Utf8View("19510"), Utf8View("61020"), Utf8View("95452"), Utf8View("26235"), Utf8View("51102"), Utf8View("16733"), Utf8View("42819"), Utf8View("27823"), Utf8View("90192"), Utf8View("31905"), Utf8View("28865"), Utf8View("62197"), Utf8View("23750"), Utf8View("81398"), Utf8View("95288"), Utf8View("45114"), Utf8View("82060"), Utf8View("12313"), Utf8View("25218"), Utf8View("64386"), Utf8View("46400"), Utf8View("77230"), Utf8View("69271"), Utf8View("43672"), Utf8View("36521"), Utf8View("34217"), Utf8View("13017"), Utf8View("27936"), Utf8View("42766"), Utf8View("59233"), Utf8View("26060"), Utf8View("27477"), Utf8View("39981"), Utf8View("93402"), Utf8View("74270"), Utf8View("13932"), Utf8View("51731"), Utf8View("71642"), Utf8View("17710"), Utf8View("85156"), Utf8View("21679"), Utf8View("70840"), Utf8View("67191"), Utf8View("39214"), Utf8View("35273"), Utf8View("27293"), Utf8View("17128"), Utf8View("15458"), Utf8View("31615"), Utf8View("60706"), Utf8View("67657"), Utf8View("54092"), Utf8View("32775"), Utf8View("14683"), Utf8View("32206"), Utf8View("62543"), Utf8View("43053"), Utf8View("11297"), Utf8View("58216"), Utf8View("49410"), Utf8View("14710"), Utf8View("24501"), Utf8View("79057"), Utf8View("77038"), Utf8View("91286"), Utf8View("32334"), Utf8View("46298"), Utf8View("18326"), Utf8View("67213"), Utf8View("65382"), Utf8View("40315"), Utf8View("56115"), Utf8View("80162"), Utf8View("55956"), Utf8View("81583"), Utf8View("73588"), Utf8View("32513"), Utf8View("62880"), Utf8View("12201"), Utf8View("11592"), Utf8View("17014"), Utf8View("83832"), Utf8View("61796"), Utf8View("57872"), Utf8View("78829"), Utf8View("69912"), Utf8View("48524"), Utf8View("22016"), Utf8View("26905"), Utf8View("48511"), Utf8View("92168"), Utf8View("63051"), Utf8View("25748"), Utf8View("89786"), Utf8View("98827"), Utf8View("86404"), Utf8View("53029"), Utf8View("37524"), Utf8View("14039"), Utf8View("50078"), Utf8View("34487"), Utf8View("70142"), Utf8View("18697"), Utf8View("40129"), Utf8View("60642"), Utf8View("42810"), Utf8View("62667"), Utf8View("57183"), Utf8View("46414"), Utf8View("58463"), Utf8View("71211"), Utf8View("46364"), Utf8View("34851"), Utf8View("54884"), Utf8View("25382"), Utf8View("25239"), Utf8View("74126"), Utf8View("21568"), Utf8View("84204"), Utf8View("13607"), Utf8View("82518"), Utf8View("32982"), Utf8View("36953"), Utf8View("86001"), Utf8View("79278"), Utf8View("21745"), Utf8View("64444"), Utf8View("35199"), Utf8View("83181"), Utf8View("73255"), Utf8View("86177"), Utf8View("98043"), Utf8View("90392"), Utf8View("13882"), Utf8View("47084"), Utf8View("17859"), Utf8View("89526"), Utf8View("42072"), Utf8View("20233"), Utf8View("52745"), Utf8View("75000"), Utf8View("22044"), Utf8View("77013"), Utf8View("24182"), Utf8View("52554"), Utf8View("56138"), Utf8View("43440"), Utf8View("86100"), Utf8View("48791"), Utf8View("21883"), Utf8View("17096"), Utf8View("15965"), Utf8View("31196"), Utf8View("74903"), Utf8View("19810"), Utf8View("35763"), Utf8View("92020"), Utf8View("55176"), Utf8View("54433"), Utf8View("68063"), Utf8View("71919"), Utf8View("44384"), Utf8View("16612"), Utf8View("32109"), Utf8View("28207"), Utf8View("14762"), Utf8View("89933"), Utf8View("10930"), Utf8View("27616"), Utf8View("56809"), Utf8View("14244"), Utf8View("22733"), Utf8View("33177"), Utf8View("29784"), Utf8View("74968"), Utf8View("37887"), Utf8View("11299"), Utf8View("34692"), Utf8View("85843"), Utf8View("83663"), Utf8View("95421"), Utf8View("19323"), Utf8View("17406"), Utf8View("69264"), Utf8View("28341"), Utf8View("50150"), Utf8View("79121"), Utf8View("73974"), Utf8View("92917"), Utf8View("21229"), Utf8View("32254"), Utf8View("97408"), Utf8View("46011"), Utf8View("37169"), Utf8View("18146"), Utf8View("27296"), Utf8View("62927"), Utf8View("68812"), Utf8View("47734"), Utf8View("86572"), Utf8View("12620"), Utf8View("80252"), Utf8View("50173"), Utf8View("27261"), Utf8View("29534"), Utf8View("23488"), Utf8View("42184"), Utf8View("23695"), Utf8View("45868"), Utf8View("12910"), Utf8View("23429"), Utf8View("29052"), Utf8View("63228"), Utf8View("30731"), Utf8View("15747"), Utf8View("25827"), Utf8View("22332"), Utf8View("62349"), Utf8View("56661"), Utf8View("44652"), Utf8View("51862"), Utf8View("57007"), Utf8View("22773"), Utf8View("40361"), Utf8View("65238"), Utf8View("19327"), Utf8View("17282"), Utf8View("44708"), Utf8View("35484"), Utf8View("34064"), Utf8View("11148"), Utf8View("92729"), Utf8View("22995"), Utf8View("18833"), Utf8View("77528"), Utf8View("48917"), Utf8View("17256"), Utf8View("93166"), Utf8View("68576"), Utf8View("71096"), Utf8View("56499"), Utf8View("35096"), Utf8View("80551"), Utf8View("82424"), Utf8View("17700"), Utf8View("32748"), Utf8View("78969"), Utf8View("46820"), Utf8View("57725"), Utf8View("46179"), Utf8View("54677"), Utf8View("98097"), Utf8View("62869"), Utf8View("83959"), Utf8View("66728"), Utf8View("19716"), Utf8View("48326"), Utf8View("27420"), Utf8View("53458"), Utf8View("69056"), Utf8View("84216"), Utf8View("36688"), Utf8View("63957"), Utf8View("41469"), Utf8View("66843"), Utf8View("18024"), Utf8View("81950"), Utf8View("21911"), Utf8View("58387"), Utf8View("58103"), Utf8View("19813"), Utf8View("34581"), Utf8View("55347"), Utf8View("17171"), Utf8View("35914"), Utf8View("75043"), Utf8View("75088"), Utf8View("80541"), Utf8View("26802"), Utf8View("28849"), Utf8View("22356"), Utf8View("57721"), Utf8View("77084"), Utf8View("46385"), Utf8View("59255"), Utf8View("29308"), Utf8View("65885"), Utf8View("70673"), Utf8View("13306"), Utf8View("68788"), Utf8View("87335"), Utf8View("40987"), Utf8View("31654"), Utf8View("67560"), Utf8View("92309"), Utf8View("78116"), Utf8View("65961"), Utf8View("45018"), Utf8View("16548"), Utf8View("67092"), Utf8View("21818"), Utf8View("33716"), Utf8View("49449"), Utf8View("86150"), Utf8View("12156"), Utf8View("27574"), Utf8View("43201"), Utf8View("50977"), Utf8View("52839"), Utf8View("33234"), Utf8View("86611"), Utf8View("71494"), Utf8View("17823"), Utf8View("57172"), Utf8View("59869"), Utf8View("34086"), Utf8View("51052"), Utf8View("11320"), Utf8View("39717"), Utf8View("79604"), Utf8View("24672"), Utf8View("70555"), Utf8View("38378"), Utf8View("91135"), Utf8View("15567"), Utf8View("21606"), Utf8View("74994"), Utf8View("77168"), Utf8View("38607"), Utf8View("27384"), Utf8View("68328"), Utf8View("88944"), Utf8View("40203"), Utf8View("37893"), Utf8View("42726"), Utf8View("83549"), Utf8View("48739"), Utf8View("55652"), Utf8View("27543"), Utf8View("23109"), Utf8View("98908"), Utf8View("28831"), Utf8View("45011"), Utf8View("47525"), Utf8View("43870"), Utf8View("79404"), Utf8View("35780"), Utf8View("42136"), Utf8View("49317"), Utf8View("14574"), Utf8View("99586"), Utf8View("21107"), Utf8View("14302"), Utf8View("83882"), Utf8View("81272"), Utf8View("92552"), Utf8View("14916"), Utf8View("87533"), Utf8View("86518"), Utf8View("17862"), Utf8View("30741"), Utf8View("96288"), Utf8View("57886"), Utf8View("30304"), Utf8View("24201"), Utf8View("79457"), Utf8View("36728"), Utf8View("49833"), Utf8View("35182"), Utf8View("20108"), Utf8View("39858"), Utf8View("10804"), Utf8View("47042"), Utf8View("20439"), Utf8View("54708"), Utf8View("59027"), Utf8View("82499"), Utf8View("75311"), Utf8View("26548"), Utf8View("53406"), Utf8View("92060"), Utf8View("41152"), Utf8View("60446"), Utf8View("33129"), Utf8View("43979"), Utf8View("16903"), Utf8View("60319"), Utf8View("35550"), Utf8View("33887"), Utf8View("25463"), Utf8View("40343"), Utf8View("20726"), Utf8View("44429")])
                                      TableScan: ?table?
                      Projection: <exprs>
                        SubqueryAlias: A1
                          Projection: <exprs>
                            Filter: count(Int64(1)) > Int64(10)
                              Aggregate: groupBy=[[customer_address.#<col>]], aggr=[[count(Int64(1))]]
                                Inner Join: customer_address.#<col> = customer.#<col>
                                  Projection: <exprs>
                                    Projection: <exprs>
                                      SubqueryAlias: customer_address
                                        Projection: <exprs>
                                          Projection: <exprs>
                                            TableScan: ?table?
                                  Projection: <exprs>
                                    Projection: <exprs>
                                      SubqueryAlias: customer
                                        Projection: <exprs>
                                          Projection: <exprs>
                                            Filter: ?table?._10 = Utf8("Y")
                                              TableScan: ?table?

logical_plan after single_distinct_aggregation_to_group_by:
SAME TEXT AS ABOVE

logical_plan after eliminate_group_by_constant:
SAME TEXT AS ABOVE

logical_plan after common_sub_expression_eliminate:
SAME TEXT AS ABOVE

logical_plan after optimize_projections:
Projection: <exprs>
  Limit: skip=0, fetch=100
    Sort: <exprs>
      Projection: <exprs>
        Aggregate: groupBy=[[store.#<col>]], aggr=[[sum(store_sales.#<col>)]]
          Projection: <exprs>
            Inner Join: CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8) = CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)
              Projection: <exprs>
                Inner Join: store_sales.#<col> = CAST(store.#<col> AS Float64)
                  Projection: <exprs>
                    Inner Join: store_sales.#<col> = CAST(date_dim.#<col> AS Float64)
                      Projection: <exprs>
                        SubqueryAlias: store_sales
                          Projection: <exprs>
                            TableScan: ?table? projection=[_0, _7, _22]
                      Projection: <exprs>
                        SubqueryAlias: date_dim
                          Projection: <exprs>
                            Filter: ?table?._10 = Int64(1) AND ?table?._6 = Int64(2000)
                              TableScan: ?table? projection=[_0, _6, _10]
                  Projection: <exprs>
                    SubqueryAlias: store
                      Projection: <exprs>
                        TableScan: ?table? projection=[_0, _5, _25]
              SubqueryAlias: V1
                Projection: <exprs>
                  SubqueryAlias: A2
                    LeftSemi Join: #<col> = #<col>
                      Aggregate: groupBy=[[#<col>]], aggr=[[]]
                        Projection: <exprs>
                          Projection: <exprs>
                            SubqueryAlias: customer_address
                              Projection: <exprs>
                                Filter: substr(CAST(?table?._9 AS Utf8), Int64(1), Int64(5)) IN ([Utf8View("19100"), Utf8View("41548"), Utf8View("51640"), Utf8View("49699"), Utf8View("88329"), Utf8View("55986"), Utf8View("85119"), Utf8View("19510"), Utf8View("61020"), Utf8View("95452"), Utf8View("26235"), Utf8View("51102"), Utf8View("16733"), Utf8View("42819"), Utf8View("27823"), Utf8View("90192"), Utf8View("31905"), Utf8View("28865"), Utf8View("62197"), Utf8View("23750"), Utf8View("81398"), Utf8View("95288"), Utf8View("45114"), Utf8View("82060"), Utf8View("12313"), Utf8View("25218"), Utf8View("64386"), Utf8View("46400"), Utf8View("77230"), Utf8View("69271"), Utf8View("43672"), Utf8View("36521"), Utf8View("34217"), Utf8View("13017"), Utf8View("27936"), Utf8View("42766"), Utf8View("59233"), Utf8View("26060"), Utf8View("27477"), Utf8View("39981"), Utf8View("93402"), Utf8View("74270"), Utf8View("13932"), Utf8View("51731"), Utf8View("71642"), Utf8View("17710"), Utf8View("85156"), Utf8View("21679"), Utf8View("70840"), Utf8View("67191"), Utf8View("39214"), Utf8View("35273"), Utf8View("27293"), Utf8View("17128"), Utf8View("15458"), Utf8View("31615"), Utf8View("60706"), Utf8View("67657"), Utf8View("54092"), Utf8View("32775"), Utf8View("14683"), Utf8View("32206"), Utf8View("62543"), Utf8View("43053"), Utf8View("11297"), Utf8View("58216"), Utf8View("49410"), Utf8View("14710"), Utf8View("24501"), Utf8View("79057"), Utf8View("77038"), Utf8View("91286"), Utf8View("32334"), Utf8View("46298"), Utf8View("18326"), Utf8View("67213"), Utf8View("65382"), Utf8View("40315"), Utf8View("56115"), Utf8View("80162"), Utf8View("55956"), Utf8View("81583"), Utf8View("73588"), Utf8View("32513"), Utf8View("62880"), Utf8View("12201"), Utf8View("11592"), Utf8View("17014"), Utf8View("83832"), Utf8View("61796"), Utf8View("57872"), Utf8View("78829"), Utf8View("69912"), Utf8View("48524"), Utf8View("22016"), Utf8View("26905"), Utf8View("48511"), Utf8View("92168"), Utf8View("63051"), Utf8View("25748"), Utf8View("89786"), Utf8View("98827"), Utf8View("86404"), Utf8View("53029"), Utf8View("37524"), Utf8View("14039"), Utf8View("50078"), Utf8View("34487"), Utf8View("70142"), Utf8View("18697"), Utf8View("40129"), Utf8View("60642"), Utf8View("42810"), Utf8View("62667"), Utf8View("57183"), Utf8View("46414"), Utf8View("58463"), Utf8View("71211"), Utf8View("46364"), Utf8View("34851"), Utf8View("54884"), Utf8View("25382"), Utf8View("25239"), Utf8View("74126"), Utf8View("21568"), Utf8View("84204"), Utf8View("13607"), Utf8View("82518"), Utf8View("32982"), Utf8View("36953"), Utf8View("86001"), Utf8View("79278"), Utf8View("21745"), Utf8View("64444"), Utf8View("35199"), Utf8View("83181"), Utf8View("73255"), Utf8View("86177"), Utf8View("98043"), Utf8View("90392"), Utf8View("13882"), Utf8View("47084"), Utf8View("17859"), Utf8View("89526"), Utf8View("42072"), Utf8View("20233"), Utf8View("52745"), Utf8View("75000"), Utf8View("22044"), Utf8View("77013"), Utf8View("24182"), Utf8View("52554"), Utf8View("56138"), Utf8View("43440"), Utf8View("86100"), Utf8View("48791"), Utf8View("21883"), Utf8View("17096"), Utf8View("15965"), Utf8View("31196"), Utf8View("74903"), Utf8View("19810"), Utf8View("35763"), Utf8View("92020"), Utf8View("55176"), Utf8View("54433"), Utf8View("68063"), Utf8View("71919"), Utf8View("44384"), Utf8View("16612"), Utf8View("32109"), Utf8View("28207"), Utf8View("14762"), Utf8View("89933"), Utf8View("10930"), Utf8View("27616"), Utf8View("56809"), Utf8View("14244"), Utf8View("22733"), Utf8View("33177"), Utf8View("29784"), Utf8View("74968"), Utf8View("37887"), Utf8View("11299"), Utf8View("34692"), Utf8View("85843"), Utf8View("83663"), Utf8View("95421"), Utf8View("19323"), Utf8View("17406"), Utf8View("69264"), Utf8View("28341"), Utf8View("50150"), Utf8View("79121"), Utf8View("73974"), Utf8View("92917"), Utf8View("21229"), Utf8View("32254"), Utf8View("97408"), Utf8View("46011"), Utf8View("37169"), Utf8View("18146"), Utf8View("27296"), Utf8View("62927"), Utf8View("68812"), Utf8View("47734"), Utf8View("86572"), Utf8View("12620"), Utf8View("80252"), Utf8View("50173"), Utf8View("27261"), Utf8View("29534"), Utf8View("23488"), Utf8View("42184"), Utf8View("23695"), Utf8View("45868"), Utf8View("12910"), Utf8View("23429"), Utf8View("29052"), Utf8View("63228"), Utf8View("30731"), Utf8View("15747"), Utf8View("25827"), Utf8View("22332"), Utf8View("62349"), Utf8View("56661"), Utf8View("44652"), Utf8View("51862"), Utf8View("57007"), Utf8View("22773"), Utf8View("40361"), Utf8View("65238"), Utf8View("19327"), Utf8View("17282"), Utf8View("44708"), Utf8View("35484"), Utf8View("34064"), Utf8View("11148"), Utf8View("92729"), Utf8View("22995"), Utf8View("18833"), Utf8View("77528"), Utf8View("48917"), Utf8View("17256"), Utf8View("93166"), Utf8View("68576"), Utf8View("71096"), Utf8View("56499"), Utf8View("35096"), Utf8View("80551"), Utf8View("82424"), Utf8View("17700"), Utf8View("32748"), Utf8View("78969"), Utf8View("46820"), Utf8View("57725"), Utf8View("46179"), Utf8View("54677"), Utf8View("98097"), Utf8View("62869"), Utf8View("83959"), Utf8View("66728"), Utf8View("19716"), Utf8View("48326"), Utf8View("27420"), Utf8View("53458"), Utf8View("69056"), Utf8View("84216"), Utf8View("36688"), Utf8View("63957"), Utf8View("41469"), Utf8View("66843"), Utf8View("18024"), Utf8View("81950"), Utf8View("21911"), Utf8View("58387"), Utf8View("58103"), Utf8View("19813"), Utf8View("34581"), Utf8View("55347"), Utf8View("17171"), Utf8View("35914"), Utf8View("75043"), Utf8View("75088"), Utf8View("80541"), Utf8View("26802"), Utf8View("28849"), Utf8View("22356"), Utf8View("57721"), Utf8View("77084"), Utf8View("46385"), Utf8View("59255"), Utf8View("29308"), Utf8View("65885"), Utf8View("70673"), Utf8View("13306"), Utf8View("68788"), Utf8View("87335"), Utf8View("40987"), Utf8View("31654"), Utf8View("67560"), Utf8View("92309"), Utf8View("78116"), Utf8View("65961"), Utf8View("45018"), Utf8View("16548"), Utf8View("67092"), Utf8View("21818"), Utf8View("33716"), Utf8View("49449"), Utf8View("86150"), Utf8View("12156"), Utf8View("27574"), Utf8View("43201"), Utf8View("50977"), Utf8View("52839"), Utf8View("33234"), Utf8View("86611"), Utf8View("71494"), Utf8View("17823"), Utf8View("57172"), Utf8View("59869"), Utf8View("34086"), Utf8View("51052"), Utf8View("11320"), Utf8View("39717"), Utf8View("79604"), Utf8View("24672"), Utf8View("70555"), Utf8View("38378"), Utf8View("91135"), Utf8View("15567"), Utf8View("21606"), Utf8View("74994"), Utf8View("77168"), Utf8View("38607"), Utf8View("27384"), Utf8View("68328"), Utf8View("88944"), Utf8View("40203"), Utf8View("37893"), Utf8View("42726"), Utf8View("83549"), Utf8View("48739"), Utf8View("55652"), Utf8View("27543"), Utf8View("23109"), Utf8View("98908"), Utf8View("28831"), Utf8View("45011"), Utf8View("47525"), Utf8View("43870"), Utf8View("79404"), Utf8View("35780"), Utf8View("42136"), Utf8View("49317"), Utf8View("14574"), Utf8View("99586"), Utf8View("21107"), Utf8View("14302"), Utf8View("83882"), Utf8View("81272"), Utf8View("92552"), Utf8View("14916"), Utf8View("87533"), Utf8View("86518"), Utf8View("17862"), Utf8View("30741"), Utf8View("96288"), Utf8View("57886"), Utf8View("30304"), Utf8View("24201"), Utf8View("79457"), Utf8View("36728"), Utf8View("49833"), Utf8View("35182"), Utf8View("20108"), Utf8View("39858"), Utf8View("10804"), Utf8View("47042"), Utf8View("20439"), Utf8View("54708"), Utf8View("59027"), Utf8View("82499"), Utf8View("75311"), Utf8View("26548"), Utf8View("53406"), Utf8View("92060"), Utf8View("41152"), Utf8View("60446"), Utf8View("33129"), Utf8View("43979"), Utf8View("16903"), Utf8View("60319"), Utf8View("35550"), Utf8View("33887"), Utf8View("25463"), Utf8View("40343"), Utf8View("20726"), Utf8View("44429")])
                                  TableScan: ?table? projection=[_9]
                      Projection: <exprs>
                        SubqueryAlias: A1
                          Projection: <exprs>
                            Filter: count(Int64(1)) > Int64(10)
                              Aggregate: groupBy=[[customer_address.#<col>]], aggr=[[count(Int64(1))]]
                                Projection: <exprs>
                                  Inner Join: customer_address.#<col> = customer.#<col>
                                    Projection: <exprs>
                                      SubqueryAlias: customer_address
                                        Projection: <exprs>
                                          TableScan: ?table? projection=[_0, _9]
                                    Projection: <exprs>
                                      SubqueryAlias: customer
                                        Projection: <exprs>
                                          Filter: ?table?._10 = Utf8("Y")
                                            TableScan: ?table? projection=[_4, _10]

logical_plan after eliminate_nested_union:
SAME TEXT AS ABOVE

logical_plan after simplify_expressions:
SAME TEXT AS ABOVE

logical_plan after replace_distinct_aggregate:
SAME TEXT AS ABOVE

logical_plan after eliminate_join:
SAME TEXT AS ABOVE

logical_plan after decorrelate_predicate_subquery:
SAME TEXT AS ABOVE

logical_plan after scalar_subquery_to_join:
SAME TEXT AS ABOVE

logical_plan after decorrelate_lateral_join:
SAME TEXT AS ABOVE

logical_plan after extract_equijoin_predicate:
SAME TEXT AS ABOVE

logical_plan after eliminate_duplicated_expr:
SAME TEXT AS ABOVE

logical_plan after eliminate_filter:
SAME TEXT AS ABOVE

logical_plan after eliminate_cross_join:
SAME TEXT AS ABOVE

logical_plan after eliminate_limit:
SAME TEXT AS ABOVE

logical_plan after propagate_empty_relation:
SAME TEXT AS ABOVE

logical_plan after eliminate_one_union:
SAME TEXT AS ABOVE

logical_plan after filter_null_join_keys:
SAME TEXT AS ABOVE

logical_plan after eliminate_outer_join:
SAME TEXT AS ABOVE

logical_plan after push_down_limit:
Projection: <exprs>
  Sort: <exprs>
    Projection: <exprs>
      Aggregate: groupBy=[[store.#<col>]], aggr=[[sum(store_sales.#<col>)]]
        Projection: <exprs>
          Inner Join: CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8) = CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)
            Projection: <exprs>
              Inner Join: store_sales.#<col> = CAST(store.#<col> AS Float64)
                Projection: <exprs>
                  Inner Join: store_sales.#<col> = CAST(date_dim.#<col> AS Float64)
                    Projection: <exprs>
                      SubqueryAlias: store_sales
                        Projection: <exprs>
                          TableScan: ?table? projection=[_0, _7, _22]
                    Projection: <exprs>
                      SubqueryAlias: date_dim
                        Projection: <exprs>
                          Filter: ?table?._10 = Int64(1) AND ?table?._6 = Int64(2000)
                            TableScan: ?table? projection=[_0, _6, _10]
                Projection: <exprs>
                  SubqueryAlias: store
                    Projection: <exprs>
                      TableScan: ?table? projection=[_0, _5, _25]
            SubqueryAlias: V1
              Projection: <exprs>
                SubqueryAlias: A2
                  LeftSemi Join: #<col> = #<col>
                    Aggregate: groupBy=[[#<col>]], aggr=[[]]
                      Projection: <exprs>
                        Projection: <exprs>
                          SubqueryAlias: customer_address
                            Projection: <exprs>
                              Filter: substr(CAST(?table?._9 AS Utf8), Int64(1), Int64(5)) IN ([Utf8View("19100"), Utf8View("41548"), Utf8View("51640"), Utf8View("49699"), Utf8View("88329"), Utf8View("55986"), Utf8View("85119"), Utf8View("19510"), Utf8View("61020"), Utf8View("95452"), Utf8View("26235"), Utf8View("51102"), Utf8View("16733"), Utf8View("42819"), Utf8View("27823"), Utf8View("90192"), Utf8View("31905"), Utf8View("28865"), Utf8View("62197"), Utf8View("23750"), Utf8View("81398"), Utf8View("95288"), Utf8View("45114"), Utf8View("82060"), Utf8View("12313"), Utf8View("25218"), Utf8View("64386"), Utf8View("46400"), Utf8View("77230"), Utf8View("69271"), Utf8View("43672"), Utf8View("36521"), Utf8View("34217"), Utf8View("13017"), Utf8View("27936"), Utf8View("42766"), Utf8View("59233"), Utf8View("26060"), Utf8View("27477"), Utf8View("39981"), Utf8View("93402"), Utf8View("74270"), Utf8View("13932"), Utf8View("51731"), Utf8View("71642"), Utf8View("17710"), Utf8View("85156"), Utf8View("21679"), Utf8View("70840"), Utf8View("67191"), Utf8View("39214"), Utf8View("35273"), Utf8View("27293"), Utf8View("17128"), Utf8View("15458"), Utf8View("31615"), Utf8View("60706"), Utf8View("67657"), Utf8View("54092"), Utf8View("32775"), Utf8View("14683"), Utf8View("32206"), Utf8View("62543"), Utf8View("43053"), Utf8View("11297"), Utf8View("58216"), Utf8View("49410"), Utf8View("14710"), Utf8View("24501"), Utf8View("79057"), Utf8View("77038"), Utf8View("91286"), Utf8View("32334"), Utf8View("46298"), Utf8View("18326"), Utf8View("67213"), Utf8View("65382"), Utf8View("40315"), Utf8View("56115"), Utf8View("80162"), Utf8View("55956"), Utf8View("81583"), Utf8View("73588"), Utf8View("32513"), Utf8View("62880"), Utf8View("12201"), Utf8View("11592"), Utf8View("17014"), Utf8View("83832"), Utf8View("61796"), Utf8View("57872"), Utf8View("78829"), Utf8View("69912"), Utf8View("48524"), Utf8View("22016"), Utf8View("26905"), Utf8View("48511"), Utf8View("92168"), Utf8View("63051"), Utf8View("25748"), Utf8View("89786"), Utf8View("98827"), Utf8View("86404"), Utf8View("53029"), Utf8View("37524"), Utf8View("14039"), Utf8View("50078"), Utf8View("34487"), Utf8View("70142"), Utf8View("18697"), Utf8View("40129"), Utf8View("60642"), Utf8View("42810"), Utf8View("62667"), Utf8View("57183"), Utf8View("46414"), Utf8View("58463"), Utf8View("71211"), Utf8View("46364"), Utf8View("34851"), Utf8View("54884"), Utf8View("25382"), Utf8View("25239"), Utf8View("74126"), Utf8View("21568"), Utf8View("84204"), Utf8View("13607"), Utf8View("82518"), Utf8View("32982"), Utf8View("36953"), Utf8View("86001"), Utf8View("79278"), Utf8View("21745"), Utf8View("64444"), Utf8View("35199"), Utf8View("83181"), Utf8View("73255"), Utf8View("86177"), Utf8View("98043"), Utf8View("90392"), Utf8View("13882"), Utf8View("47084"), Utf8View("17859"), Utf8View("89526"), Utf8View("42072"), Utf8View("20233"), Utf8View("52745"), Utf8View("75000"), Utf8View("22044"), Utf8View("77013"), Utf8View("24182"), Utf8View("52554"), Utf8View("56138"), Utf8View("43440"), Utf8View("86100"), Utf8View("48791"), Utf8View("21883"), Utf8View("17096"), Utf8View("15965"), Utf8View("31196"), Utf8View("74903"), Utf8View("19810"), Utf8View("35763"), Utf8View("92020"), Utf8View("55176"), Utf8View("54433"), Utf8View("68063"), Utf8View("71919"), Utf8View("44384"), Utf8View("16612"), Utf8View("32109"), Utf8View("28207"), Utf8View("14762"), Utf8View("89933"), Utf8View("10930"), Utf8View("27616"), Utf8View("56809"), Utf8View("14244"), Utf8View("22733"), Utf8View("33177"), Utf8View("29784"), Utf8View("74968"), Utf8View("37887"), Utf8View("11299"), Utf8View("34692"), Utf8View("85843"), Utf8View("83663"), Utf8View("95421"), Utf8View("19323"), Utf8View("17406"), Utf8View("69264"), Utf8View("28341"), Utf8View("50150"), Utf8View("79121"), Utf8View("73974"), Utf8View("92917"), Utf8View("21229"), Utf8View("32254"), Utf8View("97408"), Utf8View("46011"), Utf8View("37169"), Utf8View("18146"), Utf8View("27296"), Utf8View("62927"), Utf8View("68812"), Utf8View("47734"), Utf8View("86572"), Utf8View("12620"), Utf8View("80252"), Utf8View("50173"), Utf8View("27261"), Utf8View("29534"), Utf8View("23488"), Utf8View("42184"), Utf8View("23695"), Utf8View("45868"), Utf8View("12910"), Utf8View("23429"), Utf8View("29052"), Utf8View("63228"), Utf8View("30731"), Utf8View("15747"), Utf8View("25827"), Utf8View("22332"), Utf8View("62349"), Utf8View("56661"), Utf8View("44652"), Utf8View("51862"), Utf8View("57007"), Utf8View("22773"), Utf8View("40361"), Utf8View("65238"), Utf8View("19327"), Utf8View("17282"), Utf8View("44708"), Utf8View("35484"), Utf8View("34064"), Utf8View("11148"), Utf8View("92729"), Utf8View("22995"), Utf8View("18833"), Utf8View("77528"), Utf8View("48917"), Utf8View("17256"), Utf8View("93166"), Utf8View("68576"), Utf8View("71096"), Utf8View("56499"), Utf8View("35096"), Utf8View("80551"), Utf8View("82424"), Utf8View("17700"), Utf8View("32748"), Utf8View("78969"), Utf8View("46820"), Utf8View("57725"), Utf8View("46179"), Utf8View("54677"), Utf8View("98097"), Utf8View("62869"), Utf8View("83959"), Utf8View("66728"), Utf8View("19716"), Utf8View("48326"), Utf8View("27420"), Utf8View("53458"), Utf8View("69056"), Utf8View("84216"), Utf8View("36688"), Utf8View("63957"), Utf8View("41469"), Utf8View("66843"), Utf8View("18024"), Utf8View("81950"), Utf8View("21911"), Utf8View("58387"), Utf8View("58103"), Utf8View("19813"), Utf8View("34581"), Utf8View("55347"), Utf8View("17171"), Utf8View("35914"), Utf8View("75043"), Utf8View("75088"), Utf8View("80541"), Utf8View("26802"), Utf8View("28849"), Utf8View("22356"), Utf8View("57721"), Utf8View("77084"), Utf8View("46385"), Utf8View("59255"), Utf8View("29308"), Utf8View("65885"), Utf8View("70673"), Utf8View("13306"), Utf8View("68788"), Utf8View("87335"), Utf8View("40987"), Utf8View("31654"), Utf8View("67560"), Utf8View("92309"), Utf8View("78116"), Utf8View("65961"), Utf8View("45018"), Utf8View("16548"), Utf8View("67092"), Utf8View("21818"), Utf8View("33716"), Utf8View("49449"), Utf8View("86150"), Utf8View("12156"), Utf8View("27574"), Utf8View("43201"), Utf8View("50977"), Utf8View("52839"), Utf8View("33234"), Utf8View("86611"), Utf8View("71494"), Utf8View("17823"), Utf8View("57172"), Utf8View("59869"), Utf8View("34086"), Utf8View("51052"), Utf8View("11320"), Utf8View("39717"), Utf8View("79604"), Utf8View("24672"), Utf8View("70555"), Utf8View("38378"), Utf8View("91135"), Utf8View("15567"), Utf8View("21606"), Utf8View("74994"), Utf8View("77168"), Utf8View("38607"), Utf8View("27384"), Utf8View("68328"), Utf8View("88944"), Utf8View("40203"), Utf8View("37893"), Utf8View("42726"), Utf8View("83549"), Utf8View("48739"), Utf8View("55652"), Utf8View("27543"), Utf8View("23109"), Utf8View("98908"), Utf8View("28831"), Utf8View("45011"), Utf8View("47525"), Utf8View("43870"), Utf8View("79404"), Utf8View("35780"), Utf8View("42136"), Utf8View("49317"), Utf8View("14574"), Utf8View("99586"), Utf8View("21107"), Utf8View("14302"), Utf8View("83882"), Utf8View("81272"), Utf8View("92552"), Utf8View("14916"), Utf8View("87533"), Utf8View("86518"), Utf8View("17862"), Utf8View("30741"), Utf8View("96288"), Utf8View("57886"), Utf8View("30304"), Utf8View("24201"), Utf8View("79457"), Utf8View("36728"), Utf8View("49833"), Utf8View("35182"), Utf8View("20108"), Utf8View("39858"), Utf8View("10804"), Utf8View("47042"), Utf8View("20439"), Utf8View("54708"), Utf8View("59027"), Utf8View("82499"), Utf8View("75311"), Utf8View("26548"), Utf8View("53406"), Utf8View("92060"), Utf8View("41152"), Utf8View("60446"), Utf8View("33129"), Utf8View("43979"), Utf8View("16903"), Utf8View("60319"), Utf8View("35550"), Utf8View("33887"), Utf8View("25463"), Utf8View("40343"), Utf8View("20726"), Utf8View("44429")])
                                TableScan: ?table? projection=[_9]
                    Projection: <exprs>
                      SubqueryAlias: A1
                        Projection: <exprs>
                          Filter: count(Int64(1)) > Int64(10)
                            Aggregate: groupBy=[[customer_address.#<col>]], aggr=[[count(Int64(1))]]
                              Projection: <exprs>
                                Inner Join: customer_address.#<col> = customer.#<col>
                                  Projection: <exprs>
                                    SubqueryAlias: customer_address
                                      Projection: <exprs>
                                        TableScan: ?table? projection=[_0, _9]
                                  Projection: <exprs>
                                    SubqueryAlias: customer
                                      Projection: <exprs>
                                        Filter: ?table?._10 = Utf8("Y")
                                          TableScan: ?table? projection=[_4, _10]

logical_plan after push_down_filter:
SAME TEXT AS ABOVE

logical_plan after single_distinct_aggregation_to_group_by:
SAME TEXT AS ABOVE

logical_plan after eliminate_group_by_constant:
SAME TEXT AS ABOVE

logical_plan after common_sub_expression_eliminate:
SAME TEXT AS ABOVE

logical_plan after optimize_projections:
Projection: <exprs>
  Sort: <exprs>
    Projection: <exprs>
      Aggregate: groupBy=[[store.#<col>]], aggr=[[sum(store_sales.#<col>)]]
        Projection: <exprs>
          Inner Join: CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8) = CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)
            Projection: <exprs>
              Inner Join: store_sales.#<col> = CAST(store.#<col> AS Float64)
                Projection: <exprs>
                  Inner Join: store_sales.#<col> = CAST(date_dim.#<col> AS Float64)
                    Projection: <exprs>
                      SubqueryAlias: store_sales
                        Projection: <exprs>
                          TableScan: ?table? projection=[_0, _7, _22]
                    Projection: <exprs>
                      SubqueryAlias: date_dim
                        Projection: <exprs>
                          Filter: ?table?._10 = Int64(1) AND ?table?._6 = Int64(2000)
                            TableScan: ?table? projection=[_0, _6, _10]
                Projection: <exprs>
                  SubqueryAlias: store
                    Projection: <exprs>
                      TableScan: ?table? projection=[_0, _5, _25]
            SubqueryAlias: V1
              Projection: <exprs>
                SubqueryAlias: A2
                  LeftSemi Join: #<col> = #<col>
                    Aggregate: groupBy=[[#<col>]], aggr=[[]]
                      Projection: <exprs>
                        SubqueryAlias: customer_address
                          Projection: <exprs>
                            Filter: substr(CAST(?table?._9 AS Utf8), Int64(1), Int64(5)) IN ([Utf8View("19100"), Utf8View("41548"), Utf8View("51640"), Utf8View("49699"), Utf8View("88329"), Utf8View("55986"), Utf8View("85119"), Utf8View("19510"), Utf8View("61020"), Utf8View("95452"), Utf8View("26235"), Utf8View("51102"), Utf8View("16733"), Utf8View("42819"), Utf8View("27823"), Utf8View("90192"), Utf8View("31905"), Utf8View("28865"), Utf8View("62197"), Utf8View("23750"), Utf8View("81398"), Utf8View("95288"), Utf8View("45114"), Utf8View("82060"), Utf8View("12313"), Utf8View("25218"), Utf8View("64386"), Utf8View("46400"), Utf8View("77230"), Utf8View("69271"), Utf8View("43672"), Utf8View("36521"), Utf8View("34217"), Utf8View("13017"), Utf8View("27936"), Utf8View("42766"), Utf8View("59233"), Utf8View("26060"), Utf8View("27477"), Utf8View("39981"), Utf8View("93402"), Utf8View("74270"), Utf8View("13932"), Utf8View("51731"), Utf8View("71642"), Utf8View("17710"), Utf8View("85156"), Utf8View("21679"), Utf8View("70840"), Utf8View("67191"), Utf8View("39214"), Utf8View("35273"), Utf8View("27293"), Utf8View("17128"), Utf8View("15458"), Utf8View("31615"), Utf8View("60706"), Utf8View("67657"), Utf8View("54092"), Utf8View("32775"), Utf8View("14683"), Utf8View("32206"), Utf8View("62543"), Utf8View("43053"), Utf8View("11297"), Utf8View("58216"), Utf8View("49410"), Utf8View("14710"), Utf8View("24501"), Utf8View("79057"), Utf8View("77038"), Utf8View("91286"), Utf8View("32334"), Utf8View("46298"), Utf8View("18326"), Utf8View("67213"), Utf8View("65382"), Utf8View("40315"), Utf8View("56115"), Utf8View("80162"), Utf8View("55956"), Utf8View("81583"), Utf8View("73588"), Utf8View("32513"), Utf8View("62880"), Utf8View("12201"), Utf8View("11592"), Utf8View("17014"), Utf8View("83832"), Utf8View("61796"), Utf8View("57872"), Utf8View("78829"), Utf8View("69912"), Utf8View("48524"), Utf8View("22016"), Utf8View("26905"), Utf8View("48511"), Utf8View("92168"), Utf8View("63051"), Utf8View("25748"), Utf8View("89786"), Utf8View("98827"), Utf8View("86404"), Utf8View("53029"), Utf8View("37524"), Utf8View("14039"), Utf8View("50078"), Utf8View("34487"), Utf8View("70142"), Utf8View("18697"), Utf8View("40129"), Utf8View("60642"), Utf8View("42810"), Utf8View("62667"), Utf8View("57183"), Utf8View("46414"), Utf8View("58463"), Utf8View("71211"), Utf8View("46364"), Utf8View("34851"), Utf8View("54884"), Utf8View("25382"), Utf8View("25239"), Utf8View("74126"), Utf8View("21568"), Utf8View("84204"), Utf8View("13607"), Utf8View("82518"), Utf8View("32982"), Utf8View("36953"), Utf8View("86001"), Utf8View("79278"), Utf8View("21745"), Utf8View("64444"), Utf8View("35199"), Utf8View("83181"), Utf8View("73255"), Utf8View("86177"), Utf8View("98043"), Utf8View("90392"), Utf8View("13882"), Utf8View("47084"), Utf8View("17859"), Utf8View("89526"), Utf8View("42072"), Utf8View("20233"), Utf8View("52745"), Utf8View("75000"), Utf8View("22044"), Utf8View("77013"), Utf8View("24182"), Utf8View("52554"), Utf8View("56138"), Utf8View("43440"), Utf8View("86100"), Utf8View("48791"), Utf8View("21883"), Utf8View("17096"), Utf8View("15965"), Utf8View("31196"), Utf8View("74903"), Utf8View("19810"), Utf8View("35763"), Utf8View("92020"), Utf8View("55176"), Utf8View("54433"), Utf8View("68063"), Utf8View("71919"), Utf8View("44384"), Utf8View("16612"), Utf8View("32109"), Utf8View("28207"), Utf8View("14762"), Utf8View("89933"), Utf8View("10930"), Utf8View("27616"), Utf8View("56809"), Utf8View("14244"), Utf8View("22733"), Utf8View("33177"), Utf8View("29784"), Utf8View("74968"), Utf8View("37887"), Utf8View("11299"), Utf8View("34692"), Utf8View("85843"), Utf8View("83663"), Utf8View("95421"), Utf8View("19323"), Utf8View("17406"), Utf8View("69264"), Utf8View("28341"), Utf8View("50150"), Utf8View("79121"), Utf8View("73974"), Utf8View("92917"), Utf8View("21229"), Utf8View("32254"), Utf8View("97408"), Utf8View("46011"), Utf8View("37169"), Utf8View("18146"), Utf8View("27296"), Utf8View("62927"), Utf8View("68812"), Utf8View("47734"), Utf8View("86572"), Utf8View("12620"), Utf8View("80252"), Utf8View("50173"), Utf8View("27261"), Utf8View("29534"), Utf8View("23488"), Utf8View("42184"), Utf8View("23695"), Utf8View("45868"), Utf8View("12910"), Utf8View("23429"), Utf8View("29052"), Utf8View("63228"), Utf8View("30731"), Utf8View("15747"), Utf8View("25827"), Utf8View("22332"), Utf8View("62349"), Utf8View("56661"), Utf8View("44652"), Utf8View("51862"), Utf8View("57007"), Utf8View("22773"), Utf8View("40361"), Utf8View("65238"), Utf8View("19327"), Utf8View("17282"), Utf8View("44708"), Utf8View("35484"), Utf8View("34064"), Utf8View("11148"), Utf8View("92729"), Utf8View("22995"), Utf8View("18833"), Utf8View("77528"), Utf8View("48917"), Utf8View("17256"), Utf8View("93166"), Utf8View("68576"), Utf8View("71096"), Utf8View("56499"), Utf8View("35096"), Utf8View("80551"), Utf8View("82424"), Utf8View("17700"), Utf8View("32748"), Utf8View("78969"), Utf8View("46820"), Utf8View("57725"), Utf8View("46179"), Utf8View("54677"), Utf8View("98097"), Utf8View("62869"), Utf8View("83959"), Utf8View("66728"), Utf8View("19716"), Utf8View("48326"), Utf8View("27420"), Utf8View("53458"), Utf8View("69056"), Utf8View("84216"), Utf8View("36688"), Utf8View("63957"), Utf8View("41469"), Utf8View("66843"), Utf8View("18024"), Utf8View("81950"), Utf8View("21911"), Utf8View("58387"), Utf8View("58103"), Utf8View("19813"), Utf8View("34581"), Utf8View("55347"), Utf8View("17171"), Utf8View("35914"), Utf8View("75043"), Utf8View("75088"), Utf8View("80541"), Utf8View("26802"), Utf8View("28849"), Utf8View("22356"), Utf8View("57721"), Utf8View("77084"), Utf8View("46385"), Utf8View("59255"), Utf8View("29308"), Utf8View("65885"), Utf8View("70673"), Utf8View("13306"), Utf8View("68788"), Utf8View("87335"), Utf8View("40987"), Utf8View("31654"), Utf8View("67560"), Utf8View("92309"), Utf8View("78116"), Utf8View("65961"), Utf8View("45018"), Utf8View("16548"), Utf8View("67092"), Utf8View("21818"), Utf8View("33716"), Utf8View("49449"), Utf8View("86150"), Utf8View("12156"), Utf8View("27574"), Utf8View("43201"), Utf8View("50977"), Utf8View("52839"), Utf8View("33234"), Utf8View("86611"), Utf8View("71494"), Utf8View("17823"), Utf8View("57172"), Utf8View("59869"), Utf8View("34086"), Utf8View("51052"), Utf8View("11320"), Utf8View("39717"), Utf8View("79604"), Utf8View("24672"), Utf8View("70555"), Utf8View("38378"), Utf8View("91135"), Utf8View("15567"), Utf8View("21606"), Utf8View("74994"), Utf8View("77168"), Utf8View("38607"), Utf8View("27384"), Utf8View("68328"), Utf8View("88944"), Utf8View("40203"), Utf8View("37893"), Utf8View("42726"), Utf8View("83549"), Utf8View("48739"), Utf8View("55652"), Utf8View("27543"), Utf8View("23109"), Utf8View("98908"), Utf8View("28831"), Utf8View("45011"), Utf8View("47525"), Utf8View("43870"), Utf8View("79404"), Utf8View("35780"), Utf8View("42136"), Utf8View("49317"), Utf8View("14574"), Utf8View("99586"), Utf8View("21107"), Utf8View("14302"), Utf8View("83882"), Utf8View("81272"), Utf8View("92552"), Utf8View("14916"), Utf8View("87533"), Utf8View("86518"), Utf8View("17862"), Utf8View("30741"), Utf8View("96288"), Utf8View("57886"), Utf8View("30304"), Utf8View("24201"), Utf8View("79457"), Utf8View("36728"), Utf8View("49833"), Utf8View("35182"), Utf8View("20108"), Utf8View("39858"), Utf8View("10804"), Utf8View("47042"), Utf8View("20439"), Utf8View("54708"), Utf8View("59027"), Utf8View("82499"), Utf8View("75311"), Utf8View("26548"), Utf8View("53406"), Utf8View("92060"), Utf8View("41152"), Utf8View("60446"), Utf8View("33129"), Utf8View("43979"), Utf8View("16903"), Utf8View("60319"), Utf8View("35550"), Utf8View("33887"), Utf8View("25463"), Utf8View("40343"), Utf8View("20726"), Utf8View("44429")])
                              TableScan: ?table? projection=[_9]
                    Projection: <exprs>
                      SubqueryAlias: A1
                        Projection: <exprs>
                          Filter: count(Int64(1)) > Int64(10)
                            Aggregate: groupBy=[[customer_address.#<col>]], aggr=[[count(Int64(1))]]
                              Projection: <exprs>
                                Inner Join: customer_address.#<col> = customer.#<col>
                                  Projection: <exprs>
                                    SubqueryAlias: customer_address
                                      Projection: <exprs>
                                        TableScan: ?table? projection=[_0, _9]
                                  Projection: <exprs>
                                    SubqueryAlias: customer
                                      Projection: <exprs>
                                        Filter: ?table?._10 = Utf8("Y")
                                          TableScan: ?table? projection=[_4, _10]

logical_plan after eliminate_nested_union:
SAME TEXT AS ABOVE

logical_plan after simplify_expressions:
SAME TEXT AS ABOVE

logical_plan after replace_distinct_aggregate:
SAME TEXT AS ABOVE

logical_plan after eliminate_join:
SAME TEXT AS ABOVE

logical_plan after decorrelate_predicate_subquery:
SAME TEXT AS ABOVE

logical_plan after scalar_subquery_to_join:
SAME TEXT AS ABOVE

logical_plan after decorrelate_lateral_join:
SAME TEXT AS ABOVE

logical_plan after extract_equijoin_predicate:
SAME TEXT AS ABOVE

logical_plan after eliminate_duplicated_expr:
SAME TEXT AS ABOVE

logical_plan after eliminate_filter:
SAME TEXT AS ABOVE

logical_plan after eliminate_cross_join:
SAME TEXT AS ABOVE

logical_plan after eliminate_limit:
SAME TEXT AS ABOVE

logical_plan after propagate_empty_relation:
SAME TEXT AS ABOVE

logical_plan after eliminate_one_union:
SAME TEXT AS ABOVE

logical_plan after filter_null_join_keys:
SAME TEXT AS ABOVE

logical_plan after eliminate_outer_join:
SAME TEXT AS ABOVE

logical_plan after push_down_limit:
SAME TEXT AS ABOVE

logical_plan after push_down_filter:
SAME TEXT AS ABOVE

logical_plan after single_distinct_aggregation_to_group_by:
SAME TEXT AS ABOVE

logical_plan after eliminate_group_by_constant:
SAME TEXT AS ABOVE

logical_plan after common_sub_expression_eliminate:
SAME TEXT AS ABOVE

logical_plan after optimize_projections:
SAME TEXT AS ABOVE

logical_plan:
Projection: <exprs>
  Sort: <exprs>
    Projection: <exprs>
      Aggregate: groupBy=[[store.#<col>]], aggr=[[sum(store_sales.#<col>)]]
        Projection: <exprs>
          Inner Join: CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8) = CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)
            Projection: <exprs>
              Inner Join: store_sales.#<col> = CAST(store.#<col> AS Float64)
                Projection: <exprs>
                  Inner Join: store_sales.#<col> = CAST(date_dim.#<col> AS Float64)
                    Projection: <exprs>
                      SubqueryAlias: store_sales
                        Projection: <exprs>
                          TableScan: ?table? projection=[_0, _7, _22]
                    Projection: <exprs>
                      SubqueryAlias: date_dim
                        Projection: <exprs>
                          Filter: ?table?._10 = Int64(1) AND ?table?._6 = Int64(2000)
                            TableScan: ?table? projection=[_0, _6, _10]
                Projection: <exprs>
                  SubqueryAlias: store
                    Projection: <exprs>
                      TableScan: ?table? projection=[_0, _5, _25]
            SubqueryAlias: V1
              Projection: <exprs>
                SubqueryAlias: A2
                  LeftSemi Join: #<col> = #<col>
                    Aggregate: groupBy=[[#<col>]], aggr=[[]]
                      Projection: <exprs>
                        SubqueryAlias: customer_address
                          Projection: <exprs>
                            Filter: substr(CAST(?table?._9 AS Utf8), Int64(1), Int64(5)) IN ([Utf8View("19100"), Utf8View("41548"), Utf8View("51640"), Utf8View("49699"), Utf8View("88329"), Utf8View("55986"), Utf8View("85119"), Utf8View("19510"), Utf8View("61020"), Utf8View("95452"), Utf8View("26235"), Utf8View("51102"), Utf8View("16733"), Utf8View("42819"), Utf8View("27823"), Utf8View("90192"), Utf8View("31905"), Utf8View("28865"), Utf8View("62197"), Utf8View("23750"), Utf8View("81398"), Utf8View("95288"), Utf8View("45114"), Utf8View("82060"), Utf8View("12313"), Utf8View("25218"), Utf8View("64386"), Utf8View("46400"), Utf8View("77230"), Utf8View("69271"), Utf8View("43672"), Utf8View("36521"), Utf8View("34217"), Utf8View("13017"), Utf8View("27936"), Utf8View("42766"), Utf8View("59233"), Utf8View("26060"), Utf8View("27477"), Utf8View("39981"), Utf8View("93402"), Utf8View("74270"), Utf8View("13932"), Utf8View("51731"), Utf8View("71642"), Utf8View("17710"), Utf8View("85156"), Utf8View("21679"), Utf8View("70840"), Utf8View("67191"), Utf8View("39214"), Utf8View("35273"), Utf8View("27293"), Utf8View("17128"), Utf8View("15458"), Utf8View("31615"), Utf8View("60706"), Utf8View("67657"), Utf8View("54092"), Utf8View("32775"), Utf8View("14683"), Utf8View("32206"), Utf8View("62543"), Utf8View("43053"), Utf8View("11297"), Utf8View("58216"), Utf8View("49410"), Utf8View("14710"), Utf8View("24501"), Utf8View("79057"), Utf8View("77038"), Utf8View("91286"), Utf8View("32334"), Utf8View("46298"), Utf8View("18326"), Utf8View("67213"), Utf8View("65382"), Utf8View("40315"), Utf8View("56115"), Utf8View("80162"), Utf8View("55956"), Utf8View("81583"), Utf8View("73588"), Utf8View("32513"), Utf8View("62880"), Utf8View("12201"), Utf8View("11592"), Utf8View("17014"), Utf8View("83832"), Utf8View("61796"), Utf8View("57872"), Utf8View("78829"), Utf8View("69912"), Utf8View("48524"), Utf8View("22016"), Utf8View("26905"), Utf8View("48511"), Utf8View("92168"), Utf8View("63051"), Utf8View("25748"), Utf8View("89786"), Utf8View("98827"), Utf8View("86404"), Utf8View("53029"), Utf8View("37524"), Utf8View("14039"), Utf8View("50078"), Utf8View("34487"), Utf8View("70142"), Utf8View("18697"), Utf8View("40129"), Utf8View("60642"), Utf8View("42810"), Utf8View("62667"), Utf8View("57183"), Utf8View("46414"), Utf8View("58463"), Utf8View("71211"), Utf8View("46364"), Utf8View("34851"), Utf8View("54884"), Utf8View("25382"), Utf8View("25239"), Utf8View("74126"), Utf8View("21568"), Utf8View("84204"), Utf8View("13607"), Utf8View("82518"), Utf8View("32982"), Utf8View("36953"), Utf8View("86001"), Utf8View("79278"), Utf8View("21745"), Utf8View("64444"), Utf8View("35199"), Utf8View("83181"), Utf8View("73255"), Utf8View("86177"), Utf8View("98043"), Utf8View("90392"), Utf8View("13882"), Utf8View("47084"), Utf8View("17859"), Utf8View("89526"), Utf8View("42072"), Utf8View("20233"), Utf8View("52745"), Utf8View("75000"), Utf8View("22044"), Utf8View("77013"), Utf8View("24182"), Utf8View("52554"), Utf8View("56138"), Utf8View("43440"), Utf8View("86100"), Utf8View("48791"), Utf8View("21883"), Utf8View("17096"), Utf8View("15965"), Utf8View("31196"), Utf8View("74903"), Utf8View("19810"), Utf8View("35763"), Utf8View("92020"), Utf8View("55176"), Utf8View("54433"), Utf8View("68063"), Utf8View("71919"), Utf8View("44384"), Utf8View("16612"), Utf8View("32109"), Utf8View("28207"), Utf8View("14762"), Utf8View("89933"), Utf8View("10930"), Utf8View("27616"), Utf8View("56809"), Utf8View("14244"), Utf8View("22733"), Utf8View("33177"), Utf8View("29784"), Utf8View("74968"), Utf8View("37887"), Utf8View("11299"), Utf8View("34692"), Utf8View("85843"), Utf8View("83663"), Utf8View("95421"), Utf8View("19323"), Utf8View("17406"), Utf8View("69264"), Utf8View("28341"), Utf8View("50150"), Utf8View("79121"), Utf8View("73974"), Utf8View("92917"), Utf8View("21229"), Utf8View("32254"), Utf8View("97408"), Utf8View("46011"), Utf8View("37169"), Utf8View("18146"), Utf8View("27296"), Utf8View("62927"), Utf8View("68812"), Utf8View("47734"), Utf8View("86572"), Utf8View("12620"), Utf8View("80252"), Utf8View("50173"), Utf8View("27261"), Utf8View("29534"), Utf8View("23488"), Utf8View("42184"), Utf8View("23695"), Utf8View("45868"), Utf8View("12910"), Utf8View("23429"), Utf8View("29052"), Utf8View("63228"), Utf8View("30731"), Utf8View("15747"), Utf8View("25827"), Utf8View("22332"), Utf8View("62349"), Utf8View("56661"), Utf8View("44652"), Utf8View("51862"), Utf8View("57007"), Utf8View("22773"), Utf8View("40361"), Utf8View("65238"), Utf8View("19327"), Utf8View("17282"), Utf8View("44708"), Utf8View("35484"), Utf8View("34064"), Utf8View("11148"), Utf8View("92729"), Utf8View("22995"), Utf8View("18833"), Utf8View("77528"), Utf8View("48917"), Utf8View("17256"), Utf8View("93166"), Utf8View("68576"), Utf8View("71096"), Utf8View("56499"), Utf8View("35096"), Utf8View("80551"), Utf8View("82424"), Utf8View("17700"), Utf8View("32748"), Utf8View("78969"), Utf8View("46820"), Utf8View("57725"), Utf8View("46179"), Utf8View("54677"), Utf8View("98097"), Utf8View("62869"), Utf8View("83959"), Utf8View("66728"), Utf8View("19716"), Utf8View("48326"), Utf8View("27420"), Utf8View("53458"), Utf8View("69056"), Utf8View("84216"), Utf8View("36688"), Utf8View("63957"), Utf8View("41469"), Utf8View("66843"), Utf8View("18024"), Utf8View("81950"), Utf8View("21911"), Utf8View("58387"), Utf8View("58103"), Utf8View("19813"), Utf8View("34581"), Utf8View("55347"), Utf8View("17171"), Utf8View("35914"), Utf8View("75043"), Utf8View("75088"), Utf8View("80541"), Utf8View("26802"), Utf8View("28849"), Utf8View("22356"), Utf8View("57721"), Utf8View("77084"), Utf8View("46385"), Utf8View("59255"), Utf8View("29308"), Utf8View("65885"), Utf8View("70673"), Utf8View("13306"), Utf8View("68788"), Utf8View("87335"), Utf8View("40987"), Utf8View("31654"), Utf8View("67560"), Utf8View("92309"), Utf8View("78116"), Utf8View("65961"), Utf8View("45018"), Utf8View("16548"), Utf8View("67092"), Utf8View("21818"), Utf8View("33716"), Utf8View("49449"), Utf8View("86150"), Utf8View("12156"), Utf8View("27574"), Utf8View("43201"), Utf8View("50977"), Utf8View("52839"), Utf8View("33234"), Utf8View("86611"), Utf8View("71494"), Utf8View("17823"), Utf8View("57172"), Utf8View("59869"), Utf8View("34086"), Utf8View("51052"), Utf8View("11320"), Utf8View("39717"), Utf8View("79604"), Utf8View("24672"), Utf8View("70555"), Utf8View("38378"), Utf8View("91135"), Utf8View("15567"), Utf8View("21606"), Utf8View("74994"), Utf8View("77168"), Utf8View("38607"), Utf8View("27384"), Utf8View("68328"), Utf8View("88944"), Utf8View("40203"), Utf8View("37893"), Utf8View("42726"), Utf8View("83549"), Utf8View("48739"), Utf8View("55652"), Utf8View("27543"), Utf8View("23109"), Utf8View("98908"), Utf8View("28831"), Utf8View("45011"), Utf8View("47525"), Utf8View("43870"), Utf8View("79404"), Utf8View("35780"), Utf8View("42136"), Utf8View("49317"), Utf8View("14574"), Utf8View("99586"), Utf8View("21107"), Utf8View("14302"), Utf8View("83882"), Utf8View("81272"), Utf8View("92552"), Utf8View("14916"), Utf8View("87533"), Utf8View("86518"), Utf8View("17862"), Utf8View("30741"), Utf8View("96288"), Utf8View("57886"), Utf8View("30304"), Utf8View("24201"), Utf8View("79457"), Utf8View("36728"), Utf8View("49833"), Utf8View("35182"), Utf8View("20108"), Utf8View("39858"), Utf8View("10804"), Utf8View("47042"), Utf8View("20439"), Utf8View("54708"), Utf8View("59027"), Utf8View("82499"), Utf8View("75311"), Utf8View("26548"), Utf8View("53406"), Utf8View("92060"), Utf8View("41152"), Utf8View("60446"), Utf8View("33129"), Utf8View("43979"), Utf8View("16903"), Utf8View("60319"), Utf8View("35550"), Utf8View("33887"), Utf8View("25463"), Utf8View("40343"), Utf8View("20726"), Utf8View("44429")])
                              TableScan: ?table? projection=[_9]
                    Projection: <exprs>
                      SubqueryAlias: A1
                        Projection: <exprs>
                          Filter: count(Int64(1)) > Int64(10)
                            Aggregate: groupBy=[[customer_address.#<col>]], aggr=[[count(Int64(1))]]
                              Projection: <exprs>
                                Inner Join: customer_address.#<col> = customer.#<col>
                                  Projection: <exprs>
                                    SubqueryAlias: customer_address
                                      Projection: <exprs>
                                        TableScan: ?table? projection=[_0, _9]
                                  Projection: <exprs>
                                    SubqueryAlias: customer
                                      Projection: <exprs>
                                        Filter: ?table?._10 = Utf8("Y")
                                          TableScan: ?table? projection=[_4, _10]

initial_physical_plan:
ProjectionExec: expr=[<exprs>]
  SortExec: [<sort_exprs>], fetch=100
    SortExec: expr=[<exprs>]
      ProjectionExec: expr=[<exprs>]
        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
          CoalesceBatchesExec: target_batch_size=8192
            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
              AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
                CoalesceBatchesExec: target_batch_size=8192
                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>, CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>)], projection=[#<col>, #<col>]
                    CoalescePartitionsExec
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192
                          HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(store.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>, #<col>]
                            ProjectionExec: expr=[<exprs>]
                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                            CoalesceBatchesExec: target_batch_size=8192
                              HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>]
                                ProjectionExec: expr=[<exprs>]
                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                ProjectionExec: expr=[<exprs>]
                                  CoalesceBatchesExec: target_batch_size=8192
                                    FilterExec: _10@<id> = 1 AND _6@<id> = 2000, projection=[_0@<id>]
                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                    ProjectionExec: expr=[<exprs>]
                      CoalesceBatchesExec: target_batch_size=8192
                        HashJoinExec: mode=CollectLeft, join_type=LeftSemi, on=[(#<col>, #<col>)], NullsEqual: true
                          CoalescePartitionsExec
                            AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[]
                              CoalesceBatchesExec: target_batch_size=8192
                                RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                  AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[]
                                    ProjectionExec: expr=[<exprs>]
                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                        ProjectionExec: expr=[<exprs>]
                                          CoalesceBatchesExec: target_batch_size=8192
                                            FilterExec: substr(_9@<id>, 1, 5) IN ([19100, 41548, 51640, 49699, 88329, 55986, 85119, 19510, 61020, 95452, 26235, 51102, 16733, 42819, 27823, 90192, 31905, 28865, 62197, 23750, 81398, 95288, 45114, 82060, 12313, 25218, 64386, 46400, 77230, 69271, 43672, 36521, 34217, 13017, 27936, 42766, 59233, 26060, 27477, 39981, 93402, 74270, 13932, 51731, 71642, 17710, 85156, 21679, 70840, 67191, 39214, 35273, 27293, 17128, 15458, 31615, 60706, 67657, 54092, 32775, 14683, 32206, 62543, 43053, 11297, 58216, 49410, 14710, 24501, 79057, 77038, 91286, 32334, 46298, 18326, 67213, 65382, 40315, 56115, 80162, 55956, 81583, 73588, 32513, 62880, 12201, 11592, 17014, 83832, 61796, 57872, 78829, 69912, 48524, 22016, 26905, 48511, 92168, 63051, 25748, 89786, 98827, 86404, 53029, 37524, 14039, 50078, 34487, 70142, 18697, 40129, 60642, 42810, 62667, 57183, 46414, 58463, 71211, 46364, 34851, 54884, 25382, 25239, 74126, 21568, 84204, 13607, 82518, 32982, 36953, 86001, 79278, 21745, 64444, 35199, 83181, 73255, 86177, 98043, 90392, 13882, 47084, 17859, 89526, 42072, 20233, 52745, 75000, 22044, 77013, 24182, 52554, 56138, 43440, 86100, 48791, 21883, 17096, 15965, 31196, 74903, 19810, 35763, 92020, 55176, 54433, 68063, 71919, 44384, 16612, 32109, 28207, 14762, 89933, 10930, 27616, 56809, 14244, 22733, 33177, 29784, 74968, 37887, 11299, 34692, 85843, 83663, 95421, 19323, 17406, 69264, 28341, 50150, 79121, 73974, 92917, 21229, 32254, 97408, 46011, 37169, 18146, 27296, 62927, 68812, 47734, 86572, 12620, 80252, 50173, 27261, 29534, 23488, 42184, 23695, 45868, 12910, 23429, 29052, 63228, 30731, 15747, 25827, 22332, 62349, 56661, 44652, 51862, 57007, 22773, 40361, 65238, 19327, 17282, 44708, 35484, 34064, 11148, 92729, 22995, 18833, 77528, 48917, 17256, 93166, 68576, 71096, 56499, 35096, 80551, 82424, 17700, 32748, 78969, 46820, 57725, 46179, 54677, 98097, 62869, 83959, 66728, 19716, 48326, 27420, 53458, 69056, 84216, 36688, 63957, 41469, 66843, 18024, 81950, 21911, 58387, 58103, 19813, 34581, 55347, 17171, 35914, 75043, 75088, 80541, 26802, 28849, 22356, 57721, 77084, 46385, 59255, 29308, 65885, 70673, 13306, 68788, 87335, 40987, 31654, 67560, 92309, 78116, 65961, 45018, 16548, 67092, 21818, 33716, 49449, 86150, 12156, 27574, 43201, 50977, 52839, 33234, 86611, 71494, 17823, 57172, 59869, 34086, 51052, 11320, 39717, 79604, 24672, 70555, 38378, 91135, 15567, 21606, 74994, 77168, 38607, 27384, 68328, 88944, 40203, 37893, 42726, 83549, 48739, 55652, 27543, 23109, 98908, 28831, 45011, 47525, 43870, 79404, 35780, 42136, 49317, 14574, 99586, 21107, 14302, 83882, 81272, 92552, 14916, 87533, 86518, 17862, 30741, 96288, 57886, 30304, 24201, 79457, 36728, 49833, 35182, 20108, 39858, 10804, 47042, 20439, 54708, 59027, 82499, 75311, 26548, 53406, 92060, 41152, 60446, 33129, 43979, 16903, 60319, 35550, 33887, 25463, 40343, 20726, 44429])
                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                          ProjectionExec: expr=[<exprs>]
                            CoalesceBatchesExec: target_batch_size=8192
                              FilterExec: count(Int64(1))@<id> > 10, projection=[#<col>]
                                AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                  CoalesceBatchesExec: target_batch_size=8192
                                    RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                      AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                          CoalesceBatchesExec: target_batch_size=8192
                                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, #<col>)], projection=[#<col>]
                                              ProjectionExec: expr=[<exprs>]
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  FilterExec: _10@<id> = Y, projection=[_4@<id>]
                                                    DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                              ProjectionExec: expr=[<exprs>]
                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]


initial_physical_plan_with_stats:
ProjectionExec: expr=[<exprs>]
  SortExec: [<sort_exprs>]
    SortExec: expr=[<exprs>]
      ProjectionExec: expr=[<exprs>]
        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)], statistics=[Rows=Inexact(1), Bytes=Absent, [(Col[0]:),(Col[1]:)]]
          CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(1), Bytes=Absent, [(Col[0]:),(Col[1]:)]]
            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>, statistics=[Rows=Inexact(1), Bytes=Absent, [(Col[0]:),(Col[1]:)]]
              AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)], statistics=[Rows=Inexact(1), Bytes=Absent, [(Col[0]:),(Col[1]:)]]
                CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(1), Bytes=Absent, [(Col[0]: Null=Exact(1260)),(Col[1]: Null=Exact(0))]]
                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>, CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>)], projection=[#<col>, #<col>], statistics=[Rows=Inexact(1), Bytes=Absent, [(Col[0]: Null=Exact(1260)),(Col[1]: Null=Exact(0))]]
                    CoalescePartitionsExec, statistics=[Rows=Inexact(1), Bytes=Absent, [(Col[0]: Null=Exact(1260)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(0)),(Col[3]:)]]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(1), Bytes=Absent, [(Col[0]: Null=Exact(0)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(1260))]]
                          HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(store.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>, #<col>], statistics=[Rows=Inexact(1), Bytes=Absent, [(Col[0]: Null=Exact(0)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(1260))]]
                            ProjectionExec: expr=[<exprs>]
                              DataSourceExec: partitions=1, partition_sizes=[<sizes>], statistics=[Rows=Exact(1), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(0)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(0))]]
                            CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(15249), Bytes=Absent, [(Col[0]: Null=Exact(1242)),(Col[1]: Null=Exact(1260))]]
                              HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>], statistics=[Rows=Inexact(15249), Bytes=Absent, [(Col[0]: Null=Exact(1242)),(Col[1]: Null=Exact(1260))]]
                                ProjectionExec: expr=[<exprs>]
                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>], statistics=[Rows=Exact(28810), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(1208)),(Col[1]: Null=Exact(1242)),(Col[2]: Null=Exact(1260))]]
                                ProjectionExec: expr=[<exprs>]
                                  CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(14610), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(0))]]
                                    FilterExec: _10@<id> = 1 AND _6@<id> = 2000, projection=[_0@<id>], statistics=[Rows=Inexact(14610), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(0))]]
                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, statistics=[Rows=Exact(73049), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(0)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(0))]]
                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>], statistics=[Rows=Exact(73049), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(0)),(Col[1]: Null=Exact(0)),(Col[2]: Null=Exact(0))]]
                    ProjectionExec: expr=[<exprs>]
                      CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(100), Bytes=Absent, [(Col[0]:)]]
                        HashJoinExec: mode=CollectLeft, join_type=LeftSemi, on=[(#<col>, #<col>)], NullsEqual: true, statistics=[Rows=Inexact(100), Bytes=Absent, [(Col[0]:)]]
                          CoalescePartitionsExec, statistics=[Rows=Inexact(100), Bytes=Absent, [(Col[0]:)]]
                            AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[], statistics=[Rows=Inexact(100), Bytes=Absent, [(Col[0]:)]]
                              CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(100), Bytes=Absent, [(Col[0]:)]]
                                RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>, statistics=[Rows=Inexact(100), Bytes=Absent, [(Col[0]:)]]
                                  AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[], statistics=[Rows=Inexact(100), Bytes=Absent, [(Col[0]:)]]
                                    ProjectionExec: expr=[<exprs>]
                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, statistics=[Rows=Inexact(100), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(16))]]
                                        ProjectionExec: expr=[<exprs>]
                                          CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(100), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(16))]]
                                            FilterExec: substr(_9@<id>, 1, 5) IN ([19100, 41548, 51640, 49699, 88329, 55986, 85119, 19510, 61020, 95452, 26235, 51102, 16733, 42819, 27823, 90192, 31905, 28865, 62197, 23750, 81398, 95288, 45114, 82060, 12313, 25218, 64386, 46400, 77230, 69271, 43672, 36521, 34217, 13017, 27936, 42766, 59233, 26060, 27477, 39981, 93402, 74270, 13932, 51731, 71642, 17710, 85156, 21679, 70840, 67191, 39214, 35273, 27293, 17128, 15458, 31615, 60706, 67657, 54092, 32775, 14683, 32206, 62543, 43053, 11297, 58216, 49410, 14710, 24501, 79057, 77038, 91286, 32334, 46298, 18326, 67213, 65382, 40315, 56115, 80162, 55956, 81583, 73588, 32513, 62880, 12201, 11592, 17014, 83832, 61796, 57872, 78829, 69912, 48524, 22016, 26905, 48511, 92168, 63051, 25748, 89786, 98827, 86404, 53029, 37524, 14039, 50078, 34487, 70142, 18697, 40129, 60642, 42810, 62667, 57183, 46414, 58463, 71211, 46364, 34851, 54884, 25382, 25239, 74126, 21568, 84204, 13607, 82518, 32982, 36953, 86001, 79278, 21745, 64444, 35199, 83181, 73255, 86177, 98043, 90392, 13882, 47084, 17859, 89526, 42072, 20233, 52745, 75000, 22044, 77013, 24182, 52554, 56138, 43440, 86100, 48791, 21883, 17096, 15965, 31196, 74903, 19810, 35763, 92020, 55176, 54433, 68063, 71919, 44384, 16612, 32109, 28207, 14762, 89933, 10930, 27616, 56809, 14244, 22733, 33177, 29784, 74968, 37887, 11299, 34692, 85843, 83663, 95421, 19323, 17406, 69264, 28341, 50150, 79121, 73974, 92917, 21229, 32254, 97408, 46011, 37169, 18146, 27296, 62927, 68812, 47734, 86572, 12620, 80252, 50173, 27261, 29534, 23488, 42184, 23695, 45868, 12910, 23429, 29052, 63228, 30731, 15747, 25827, 22332, 62349, 56661, 44652, 51862, 57007, 22773, 40361, 65238, 19327, 17282, 44708, 35484, 34064, 11148, 92729, 22995, 18833, 77528, 48917, 17256, 93166, 68576, 71096, 56499, 35096, 80551, 82424, 17700, 32748, 78969, 46820, 57725, 46179, 54677, 98097, 62869, 83959, 66728, 19716, 48326, 27420, 53458, 69056, 84216, 36688, 63957, 41469, 66843, 18024, 81950, 21911, 58387, 58103, 19813, 34581, 55347, 17171, 35914, 75043, 75088, 80541, 26802, 28849, 22356, 57721, 77084, 46385, 59255, 29308, 65885, 70673, 13306, 68788, 87335, 40987, 31654, 67560, 92309, 78116, 65961, 45018, 16548, 67092, 21818, 33716, 49449, 86150, 12156, 27574, 43201, 50977, 52839, 33234, 86611, 71494, 17823, 57172, 59869, 34086, 51052, 11320, 39717, 79604, 24672, 70555, 38378, 91135, 15567, 21606, 74994, 77168, 38607, 27384, 68328, 88944, 40203, 37893, 42726, 83549, 48739, 55652, 27543, 23109, 98908, 28831, 45011, 47525, 43870, 79404, 35780, 42136, 49317, 14574, 99586, 21107, 14302, 83882, 81272, 92552, 14916, 87533, 86518, 17862, 30741, 96288, 57886, 30304, 24201, 79457, 36728, 49833, 35182, 20108, 39858, 10804, 47042, 20439, 54708, 59027, 82499, 75311, 26548, 53406, 92060, 41152, 60446, 33129, 43979, 16903, 60319, 35550, 33887, 25463, 40343, 20726, 44429]), statistics=[Rows=Inexact(100), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(16))]]
                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>], statistics=[Rows=Exact(500), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(16))]]
                          ProjectionExec: expr=[<exprs>]
                            CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(40), Bytes=Absent, [(Col[0]:)]]
                              FilterExec: count(Int64(1))@<id> > 10, projection=[#<col>], statistics=[Rows=Inexact(40), Bytes=Absent, [(Col[0]:)]]
                                AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[count(Int64(1))], statistics=[Rows=Inexact(200), Bytes=Absent, [(Col[0]:),(Col[1]:)]]
                                  CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(200), Bytes=Absent, [(Col[0]:),(Col[1]:)]]
                                    RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>, statistics=[Rows=Inexact(200), Bytes=Absent, [(Col[0]:),(Col[1]:)]]
                                      AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[count(Int64(1))], statistics=[Rows=Inexact(200), Bytes=Absent, [(Col[0]:),(Col[1]:)]]
                                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, statistics=[Rows=Inexact(200), Bytes=Absent, [(Col[0]: Null=Exact(16))]]
                                          CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(200), Bytes=Absent, [(Col[0]: Null=Exact(16))]]
                                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, #<col>)], projection=[#<col>], statistics=[Rows=Inexact(200), Bytes=Absent, [(Col[0]: Null=Exact(16))]]
                                              ProjectionExec: expr=[<exprs>]
                                                CoalesceBatchesExec: target_batch_size=8192, statistics=[Rows=Inexact(200), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(0))]]
                                                  FilterExec: _10@<id> = Y, projection=[_4@<id>], statistics=[Rows=Inexact(200), Bytes=Inexact(<bytes>), [(Col[0]: Null=Inexact(0))]]
                                                    DataSourceExec: partitions=1, partition_sizes=[<sizes>], statistics=[Rows=Exact(1000), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(0)),(Col[1]: Null=Exact(29))]]
                                              ProjectionExec: expr=[<exprs>]
                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>], statistics=[Rows=Exact(500), Bytes=Exact(<bytes>), [(Col[0]: Null=Exact(0)),(Col[1]: Null=Exact(16))]]


initial_physical_plan_with_schema:
ProjectionExec: expr=[<exprs>]
  SortExec: [<sort_exprs>]
    SortExec: expr=[<exprs>]
      ProjectionExec: expr=[<exprs>]
        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)], schema=[#<col>:Utf8;N, sum(store_sales.#<col>):Decimal128(16, 2);N]
          CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Utf8;N, sum(store_sales.#<col>)[sum]:Decimal128(16, 2);N]
            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>, schema=[#<col>:Utf8;N, sum(store_sales.#<col>)[sum]:Decimal128(16, 2);N]
              AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)], schema=[#<col>:Utf8;N, sum(store_sales.#<col>)[sum]:Decimal128(16, 2);N]
                CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Decimal128(6, 2);N, #<col>:Utf8;N]
                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>, CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>)], projection=[#<col>, #<col>], schema=[#<col>:Decimal128(6, 2);N, #<col>:Utf8;N]
                    CoalescePartitionsExec, schema=[#<col>:Decimal128(6, 2);N, #<col>:Utf8;N, #<col>:Utf8;N, CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8):Utf8;N]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Utf8;N, #<col>:Utf8;N, #<col>:Decimal128(6, 2);N]
                          HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(store.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>, #<col>], schema=[#<col>:Utf8;N, #<col>:Utf8;N, #<col>:Decimal128(6, 2);N]
                            ProjectionExec: expr=[<exprs>]
                              DataSourceExec: partitions=1, partition_sizes=[<sizes>], schema=[_0:Int64;N, _5:Utf8;N, _25:Utf8;N]
                            CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Float64;N, #<col>:Decimal128(6, 2);N]
                              HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>], schema=[#<col>:Float64;N, #<col>:Decimal128(6, 2);N]
                                ProjectionExec: expr=[<exprs>]
                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>], schema=[_0:Float64;N, _7:Float64;N, _22:Decimal128(6, 2);N]
                                ProjectionExec: expr=[<exprs>]
                                  CoalesceBatchesExec: target_batch_size=8192, schema=[_0:Int64;N]
                                    FilterExec: _10@<id> = 1 AND _6@<id> = 2000, projection=[_0@<id>], schema=[_0:Int64;N]
                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, schema=[_0:Int64;N, _6:Int64;N, _10:Int64;N]
                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>], schema=[_0:Int64;N, _6:Int64;N, _10:Int64;N]
                    ProjectionExec: expr=[<exprs>]
                      CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Utf8;N]
                        HashJoinExec: mode=CollectLeft, join_type=LeftSemi, on=[(#<col>, #<col>)], NullsEqual: true, schema=[#<col>:Utf8;N]
                          CoalescePartitionsExec, schema=[#<col>:Utf8;N]
                            AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[], schema=[#<col>:Utf8;N]
                              CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Utf8;N]
                                RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>, schema=[#<col>:Utf8;N]
                                  AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[], schema=[#<col>:Utf8;N]
                                    ProjectionExec: expr=[<exprs>]
                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, schema=[#<col>:Utf8;N]
                                        ProjectionExec: expr=[<exprs>]
                                          CoalesceBatchesExec: target_batch_size=8192, schema=[_9:Utf8;N]
                                            FilterExec: substr(_9@<id>, 1, 5) IN ([19100, 41548, 51640, 49699, 88329, 55986, 85119, 19510, 61020, 95452, 26235, 51102, 16733, 42819, 27823, 90192, 31905, 28865, 62197, 23750, 81398, 95288, 45114, 82060, 12313, 25218, 64386, 46400, 77230, 69271, 43672, 36521, 34217, 13017, 27936, 42766, 59233, 26060, 27477, 39981, 93402, 74270, 13932, 51731, 71642, 17710, 85156, 21679, 70840, 67191, 39214, 35273, 27293, 17128, 15458, 31615, 60706, 67657, 54092, 32775, 14683, 32206, 62543, 43053, 11297, 58216, 49410, 14710, 24501, 79057, 77038, 91286, 32334, 46298, 18326, 67213, 65382, 40315, 56115, 80162, 55956, 81583, 73588, 32513, 62880, 12201, 11592, 17014, 83832, 61796, 57872, 78829, 69912, 48524, 22016, 26905, 48511, 92168, 63051, 25748, 89786, 98827, 86404, 53029, 37524, 14039, 50078, 34487, 70142, 18697, 40129, 60642, 42810, 62667, 57183, 46414, 58463, 71211, 46364, 34851, 54884, 25382, 25239, 74126, 21568, 84204, 13607, 82518, 32982, 36953, 86001, 79278, 21745, 64444, 35199, 83181, 73255, 86177, 98043, 90392, 13882, 47084, 17859, 89526, 42072, 20233, 52745, 75000, 22044, 77013, 24182, 52554, 56138, 43440, 86100, 48791, 21883, 17096, 15965, 31196, 74903, 19810, 35763, 92020, 55176, 54433, 68063, 71919, 44384, 16612, 32109, 28207, 14762, 89933, 10930, 27616, 56809, 14244, 22733, 33177, 29784, 74968, 37887, 11299, 34692, 85843, 83663, 95421, 19323, 17406, 69264, 28341, 50150, 79121, 73974, 92917, 21229, 32254, 97408, 46011, 37169, 18146, 27296, 62927, 68812, 47734, 86572, 12620, 80252, 50173, 27261, 29534, 23488, 42184, 23695, 45868, 12910, 23429, 29052, 63228, 30731, 15747, 25827, 22332, 62349, 56661, 44652, 51862, 57007, 22773, 40361, 65238, 19327, 17282, 44708, 35484, 34064, 11148, 92729, 22995, 18833, 77528, 48917, 17256, 93166, 68576, 71096, 56499, 35096, 80551, 82424, 17700, 32748, 78969, 46820, 57725, 46179, 54677, 98097, 62869, 83959, 66728, 19716, 48326, 27420, 53458, 69056, 84216, 36688, 63957, 41469, 66843, 18024, 81950, 21911, 58387, 58103, 19813, 34581, 55347, 17171, 35914, 75043, 75088, 80541, 26802, 28849, 22356, 57721, 77084, 46385, 59255, 29308, 65885, 70673, 13306, 68788, 87335, 40987, 31654, 67560, 92309, 78116, 65961, 45018, 16548, 67092, 21818, 33716, 49449, 86150, 12156, 27574, 43201, 50977, 52839, 33234, 86611, 71494, 17823, 57172, 59869, 34086, 51052, 11320, 39717, 79604, 24672, 70555, 38378, 91135, 15567, 21606, 74994, 77168, 38607, 27384, 68328, 88944, 40203, 37893, 42726, 83549, 48739, 55652, 27543, 23109, 98908, 28831, 45011, 47525, 43870, 79404, 35780, 42136, 49317, 14574, 99586, 21107, 14302, 83882, 81272, 92552, 14916, 87533, 86518, 17862, 30741, 96288, 57886, 30304, 24201, 79457, 36728, 49833, 35182, 20108, 39858, 10804, 47042, 20439, 54708, 59027, 82499, 75311, 26548, 53406, 92060, 41152, 60446, 33129, 43979, 16903, 60319, 35550, 33887, 25463, 40343, 20726, 44429]), schema=[_9:Utf8;N]
                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>], schema=[_9:Utf8;N]
                          ProjectionExec: expr=[<exprs>]
                            CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Utf8;N]
                              FilterExec: count(Int64(1))@<id> > 10, projection=[#<col>], schema=[#<col>:Utf8;N]
                                AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[count(Int64(1))], schema=[#<col>:Utf8;N, count(Int64(1)):Int64]
                                  CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Utf8;N, count(Int64(1))[count]:Int64]
                                    RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>, schema=[#<col>:Utf8;N, count(Int64(1))[count]:Int64]
                                      AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[count(Int64(1))], schema=[#<col>:Utf8;N, count(Int64(1))[count]:Int64]
                                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>, schema=[#<col>:Utf8;N]
                                          CoalesceBatchesExec: target_batch_size=8192, schema=[#<col>:Utf8;N]
                                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, #<col>)], projection=[#<col>], schema=[#<col>:Utf8;N]
                                              ProjectionExec: expr=[<exprs>]
                                                CoalesceBatchesExec: target_batch_size=8192, schema=[_4:Int64;N]
                                                  FilterExec: _10@<id> = Y, projection=[_4@<id>], schema=[_4:Int64;N]
                                                    DataSourceExec: partitions=1, partition_sizes=[<sizes>], schema=[_4:Int64;N, _10:Utf8;N]
                                              ProjectionExec: expr=[<exprs>]
                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>], schema=[_0:Int64;N, _9:Utf8;N]


physical_plan after OutputRequirements:
ProjectionExec: expr=[<exprs>]
  OutputRequirementExec: order_by=[(#<col>, asc)], dist_by=SinglePartition
    SortExec: [<sort_exprs>], fetch=100
      SortExec: expr=[<exprs>]
        ProjectionExec: expr=[<exprs>]
          AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
            CoalesceBatchesExec: target_batch_size=8192
              RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
                  CoalesceBatchesExec: target_batch_size=8192
                    HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>, CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>)], projection=[#<col>, #<col>]
                      CoalescePartitionsExec
                        ProjectionExec: expr=[<exprs>]
                          CoalesceBatchesExec: target_batch_size=8192
                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(store.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>, #<col>]
                              ProjectionExec: expr=[<exprs>]
                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                              CoalesceBatchesExec: target_batch_size=8192
                                HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, CAST(date_dim.#<col> AS Float64)@<id>)], projection=[#<col>, #<col>]
                                  ProjectionExec: expr=[<exprs>]
                                    DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                  ProjectionExec: expr=[<exprs>]
                                    CoalesceBatchesExec: target_batch_size=8192
                                      FilterExec: _10@<id> = 1 AND _6@<id> = 2000, projection=[_0@<id>]
                                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                          DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192
                          HashJoinExec: mode=CollectLeft, join_type=LeftSemi, on=[(#<col>, #<col>)], NullsEqual: true
                            CoalescePartitionsExec
                              AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[]
                                CoalesceBatchesExec: target_batch_size=8192
                                  RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                    AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[]
                                      ProjectionExec: expr=[<exprs>]
                                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                          ProjectionExec: expr=[<exprs>]
                                            CoalesceBatchesExec: target_batch_size=8192
                                              FilterExec: substr(_9@<id>, 1, 5) IN ([19100, 41548, 51640, 49699, 88329, 55986, 85119, 19510, 61020, 95452, 26235, 51102, 16733, 42819, 27823, 90192, 31905, 28865, 62197, 23750, 81398, 95288, 45114, 82060, 12313, 25218, 64386, 46400, 77230, 69271, 43672, 36521, 34217, 13017, 27936, 42766, 59233, 26060, 27477, 39981, 93402, 74270, 13932, 51731, 71642, 17710, 85156, 21679, 70840, 67191, 39214, 35273, 27293, 17128, 15458, 31615, 60706, 67657, 54092, 32775, 14683, 32206, 62543, 43053, 11297, 58216, 49410, 14710, 24501, 79057, 77038, 91286, 32334, 46298, 18326, 67213, 65382, 40315, 56115, 80162, 55956, 81583, 73588, 32513, 62880, 12201, 11592, 17014, 83832, 61796, 57872, 78829, 69912, 48524, 22016, 26905, 48511, 92168, 63051, 25748, 89786, 98827, 86404, 53029, 37524, 14039, 50078, 34487, 70142, 18697, 40129, 60642, 42810, 62667, 57183, 46414, 58463, 71211, 46364, 34851, 54884, 25382, 25239, 74126, 21568, 84204, 13607, 82518, 32982, 36953, 86001, 79278, 21745, 64444, 35199, 83181, 73255, 86177, 98043, 90392, 13882, 47084, 17859, 89526, 42072, 20233, 52745, 75000, 22044, 77013, 24182, 52554, 56138, 43440, 86100, 48791, 21883, 17096, 15965, 31196, 74903, 19810, 35763, 92020, 55176, 54433, 68063, 71919, 44384, 16612, 32109, 28207, 14762, 89933, 10930, 27616, 56809, 14244, 22733, 33177, 29784, 74968, 37887, 11299, 34692, 85843, 83663, 95421, 19323, 17406, 69264, 28341, 50150, 79121, 73974, 92917, 21229, 32254, 97408, 46011, 37169, 18146, 27296, 62927, 68812, 47734, 86572, 12620, 80252, 50173, 27261, 29534, 23488, 42184, 23695, 45868, 12910, 23429, 29052, 63228, 30731, 15747, 25827, 22332, 62349, 56661, 44652, 51862, 57007, 22773, 40361, 65238, 19327, 17282, 44708, 35484, 34064, 11148, 92729, 22995, 18833, 77528, 48917, 17256, 93166, 68576, 71096, 56499, 35096, 80551, 82424, 17700, 32748, 78969, 46820, 57725, 46179, 54677, 98097, 62869, 83959, 66728, 19716, 48326, 27420, 53458, 69056, 84216, 36688, 63957, 41469, 66843, 18024, 81950, 21911, 58387, 58103, 19813, 34581, 55347, 17171, 35914, 75043, 75088, 80541, 26802, 28849, 22356, 57721, 77084, 46385, 59255, 29308, 65885, 70673, 13306, 68788, 87335, 40987, 31654, 67560, 92309, 78116, 65961, 45018, 16548, 67092, 21818, 33716, 49449, 86150, 12156, 27574, 43201, 50977, 52839, 33234, 86611, 71494, 17823, 57172, 59869, 34086, 51052, 11320, 39717, 79604, 24672, 70555, 38378, 91135, 15567, 21606, 74994, 77168, 38607, 27384, 68328, 88944, 40203, 37893, 42726, 83549, 48739, 55652, 27543, 23109, 98908, 28831, 45011, 47525, 43870, 79404, 35780, 42136, 49317, 14574, 99586, 21107, 14302, 83882, 81272, 92552, 14916, 87533, 86518, 17862, 30741, 96288, 57886, 30304, 24201, 79457, 36728, 49833, 35182, 20108, 39858, 10804, 47042, 20439, 54708, 59027, 82499, 75311, 26548, 53406, 92060, 41152, 60446, 33129, 43979, 16903, 60319, 35550, 33887, 25463, 40343, 20726, 44429])
                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                            ProjectionExec: expr=[<exprs>]
                              CoalesceBatchesExec: target_batch_size=8192
                                FilterExec: count(Int64(1))@<id> > 10, projection=[#<col>]
                                  AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                    CoalesceBatchesExec: target_batch_size=8192
                                      RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                        AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                            CoalesceBatchesExec: target_batch_size=8192
                                              HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, #<col>)], projection=[#<col>]
                                                ProjectionExec: expr=[<exprs>]
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    FilterExec: _10@<id> = Y, projection=[_4@<id>]
                                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                ProjectionExec: expr=[<exprs>]
                                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>]


physical_plan after aggregate_statistics:
SAME TEXT AS ABOVE

physical_plan after join_selection:
ProjectionExec: expr=[<exprs>]
  OutputRequirementExec: order_by=[(#<col>, asc)], dist_by=SinglePartition
    SortExec: [<sort_exprs>], fetch=100
      SortExec: expr=[<exprs>]
        ProjectionExec: expr=[<exprs>]
          AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
            CoalesceBatchesExec: target_batch_size=8192
              RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
                  CoalesceBatchesExec: target_batch_size=8192
                    HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>, CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>)], projection=[#<col>, #<col>]
                      CoalescePartitionsExec
                        ProjectionExec: expr=[<exprs>]
                          CoalesceBatchesExec: target_batch_size=8192
                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(store.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>, #<col>]
                              ProjectionExec: expr=[<exprs>]
                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                              CoalesceBatchesExec: target_batch_size=8192
                                HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(date_dim.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>]
                                  ProjectionExec: expr=[<exprs>]
                                    CoalesceBatchesExec: target_batch_size=8192
                                      FilterExec: _10@<id> = 1 AND _6@<id> = 2000, projection=[_0@<id>]
                                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                          DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                  ProjectionExec: expr=[<exprs>]
                                    DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192
                          HashJoinExec: mode=CollectLeft, join_type=RightSemi, on=[(#<col>, #<col>)], NullsEqual: true
                            ProjectionExec: expr=[<exprs>]
                              CoalesceBatchesExec: target_batch_size=8192
                                FilterExec: count(Int64(1))@<id> > 10, projection=[#<col>]
                                  AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                    CoalesceBatchesExec: target_batch_size=8192
                                      RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                        AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                            CoalesceBatchesExec: target_batch_size=8192
                                              HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, #<col>)], projection=[#<col>]
                                                ProjectionExec: expr=[<exprs>]
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    FilterExec: _10@<id> = Y, projection=[_4@<id>]
                                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                ProjectionExec: expr=[<exprs>]
                                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                            CoalescePartitionsExec
                              AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[]
                                CoalesceBatchesExec: target_batch_size=8192
                                  RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                    AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[]
                                      ProjectionExec: expr=[<exprs>]
                                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                          ProjectionExec: expr=[<exprs>]
                                            CoalesceBatchesExec: target_batch_size=8192
                                              FilterExec: substr(_9@<id>, 1, 5) IN ([19100, 41548, 51640, 49699, 88329, 55986, 85119, 19510, 61020, 95452, 26235, 51102, 16733, 42819, 27823, 90192, 31905, 28865, 62197, 23750, 81398, 95288, 45114, 82060, 12313, 25218, 64386, 46400, 77230, 69271, 43672, 36521, 34217, 13017, 27936, 42766, 59233, 26060, 27477, 39981, 93402, 74270, 13932, 51731, 71642, 17710, 85156, 21679, 70840, 67191, 39214, 35273, 27293, 17128, 15458, 31615, 60706, 67657, 54092, 32775, 14683, 32206, 62543, 43053, 11297, 58216, 49410, 14710, 24501, 79057, 77038, 91286, 32334, 46298, 18326, 67213, 65382, 40315, 56115, 80162, 55956, 81583, 73588, 32513, 62880, 12201, 11592, 17014, 83832, 61796, 57872, 78829, 69912, 48524, 22016, 26905, 48511, 92168, 63051, 25748, 89786, 98827, 86404, 53029, 37524, 14039, 50078, 34487, 70142, 18697, 40129, 60642, 42810, 62667, 57183, 46414, 58463, 71211, 46364, 34851, 54884, 25382, 25239, 74126, 21568, 84204, 13607, 82518, 32982, 36953, 86001, 79278, 21745, 64444, 35199, 83181, 73255, 86177, 98043, 90392, 13882, 47084, 17859, 89526, 42072, 20233, 52745, 75000, 22044, 77013, 24182, 52554, 56138, 43440, 86100, 48791, 21883, 17096, 15965, 31196, 74903, 19810, 35763, 92020, 55176, 54433, 68063, 71919, 44384, 16612, 32109, 28207, 14762, 89933, 10930, 27616, 56809, 14244, 22733, 33177, 29784, 74968, 37887, 11299, 34692, 85843, 83663, 95421, 19323, 17406, 69264, 28341, 50150, 79121, 73974, 92917, 21229, 32254, 97408, 46011, 37169, 18146, 27296, 62927, 68812, 47734, 86572, 12620, 80252, 50173, 27261, 29534, 23488, 42184, 23695, 45868, 12910, 23429, 29052, 63228, 30731, 15747, 25827, 22332, 62349, 56661, 44652, 51862, 57007, 22773, 40361, 65238, 19327, 17282, 44708, 35484, 34064, 11148, 92729, 22995, 18833, 77528, 48917, 17256, 93166, 68576, 71096, 56499, 35096, 80551, 82424, 17700, 32748, 78969, 46820, 57725, 46179, 54677, 98097, 62869, 83959, 66728, 19716, 48326, 27420, 53458, 69056, 84216, 36688, 63957, 41469, 66843, 18024, 81950, 21911, 58387, 58103, 19813, 34581, 55347, 17171, 35914, 75043, 75088, 80541, 26802, 28849, 22356, 57721, 77084, 46385, 59255, 29308, 65885, 70673, 13306, 68788, 87335, 40987, 31654, 67560, 92309, 78116, 65961, 45018, 16548, 67092, 21818, 33716, 49449, 86150, 12156, 27574, 43201, 50977, 52839, 33234, 86611, 71494, 17823, 57172, 59869, 34086, 51052, 11320, 39717, 79604, 24672, 70555, 38378, 91135, 15567, 21606, 74994, 77168, 38607, 27384, 68328, 88944, 40203, 37893, 42726, 83549, 48739, 55652, 27543, 23109, 98908, 28831, 45011, 47525, 43870, 79404, 35780, 42136, 49317, 14574, 99586, 21107, 14302, 83882, 81272, 92552, 14916, 87533, 86518, 17862, 30741, 96288, 57886, 30304, 24201, 79457, 36728, 49833, 35182, 20108, 39858, 10804, 47042, 20439, 54708, 59027, 82499, 75311, 26548, 53406, 92060, 41152, 60446, 33129, 43979, 16903, 60319, 35550, 33887, 25463, 40343, 20726, 44429])
                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]


physical_plan after LimitedDistinctAggregation:
SAME TEXT AS ABOVE

physical_plan after FilterPushdown:
SAME TEXT AS ABOVE

physical_plan after EnforceDistribution:
ProjectionExec: expr=[<exprs>]
  OutputRequirementExec: order_by=[(#<col>, asc)], dist_by=SinglePartition
    SortExec: expr=[<exprs>]
      CoalescePartitionsExec
        SortExec: expr=[<exprs>]
          ProjectionExec: expr=[<exprs>]
            AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
              RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                CoalesceBatchesExec: target_batch_size=8192
                  AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
                    CoalesceBatchesExec: target_batch_size=8192
                      HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>, CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>)], projection=[#<col>, #<col>]
                        CoalescePartitionsExec
                          ProjectionExec: expr=[<exprs>]
                            CoalesceBatchesExec: target_batch_size=8192
                              HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(store.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>, #<col>]
                                ProjectionExec: expr=[<exprs>]
                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                CoalesceBatchesExec: target_batch_size=8192
                                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(date_dim.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>]
                                    CoalescePartitionsExec
                                      ProjectionExec: expr=[<exprs>]
                                        CoalesceBatchesExec: target_batch_size=8192
                                          FilterExec: _10@<id> = 1 AND _6@<id> = 2000, projection=[_0@<id>]
                                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                    RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                      ProjectionExec: expr=[<exprs>]
                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                        ProjectionExec: expr=[<exprs>]
                          CoalesceBatchesExec: target_batch_size=8192
                            HashJoinExec: mode=CollectLeft, join_type=RightSemi, on=[(#<col>, #<col>)], NullsEqual: true
                              CoalescePartitionsExec
                                ProjectionExec: expr=[<exprs>]
                                  CoalesceBatchesExec: target_batch_size=8192
                                    FilterExec: count(Int64(1))@<id> > 10, projection=[#<col>]
                                      AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                        RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                          CoalesceBatchesExec: target_batch_size=8192
                                            AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, #<col>)], projection=[#<col>]
                                                    ProjectionExec: expr=[<exprs>]
                                                      CoalesceBatchesExec: target_batch_size=8192
                                                        FilterExec: _10@<id> = Y, projection=[_4@<id>]
                                                          DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                    ProjectionExec: expr=[<exprs>]
                                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                              AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[]
                                RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                  CoalesceBatchesExec: target_batch_size=8192
                                    AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[]
                                      ProjectionExec: expr=[<exprs>]
                                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                          ProjectionExec: expr=[<exprs>]
                                            CoalesceBatchesExec: target_batch_size=8192
                                              FilterExec: substr(_9@<id>, 1, 5) IN ([19100, 41548, 51640, 49699, 88329, 55986, 85119, 19510, 61020, 95452, 26235, 51102, 16733, 42819, 27823, 90192, 31905, 28865, 62197, 23750, 81398, 95288, 45114, 82060, 12313, 25218, 64386, 46400, 77230, 69271, 43672, 36521, 34217, 13017, 27936, 42766, 59233, 26060, 27477, 39981, 93402, 74270, 13932, 51731, 71642, 17710, 85156, 21679, 70840, 67191, 39214, 35273, 27293, 17128, 15458, 31615, 60706, 67657, 54092, 32775, 14683, 32206, 62543, 43053, 11297, 58216, 49410, 14710, 24501, 79057, 77038, 91286, 32334, 46298, 18326, 67213, 65382, 40315, 56115, 80162, 55956, 81583, 73588, 32513, 62880, 12201, 11592, 17014, 83832, 61796, 57872, 78829, 69912, 48524, 22016, 26905, 48511, 92168, 63051, 25748, 89786, 98827, 86404, 53029, 37524, 14039, 50078, 34487, 70142, 18697, 40129, 60642, 42810, 62667, 57183, 46414, 58463, 71211, 46364, 34851, 54884, 25382, 25239, 74126, 21568, 84204, 13607, 82518, 32982, 36953, 86001, 79278, 21745, 64444, 35199, 83181, 73255, 86177, 98043, 90392, 13882, 47084, 17859, 89526, 42072, 20233, 52745, 75000, 22044, 77013, 24182, 52554, 56138, 43440, 86100, 48791, 21883, 17096, 15965, 31196, 74903, 19810, 35763, 92020, 55176, 54433, 68063, 71919, 44384, 16612, 32109, 28207, 14762, 89933, 10930, 27616, 56809, 14244, 22733, 33177, 29784, 74968, 37887, 11299, 34692, 85843, 83663, 95421, 19323, 17406, 69264, 28341, 50150, 79121, 73974, 92917, 21229, 32254, 97408, 46011, 37169, 18146, 27296, 62927, 68812, 47734, 86572, 12620, 80252, 50173, 27261, 29534, 23488, 42184, 23695, 45868, 12910, 23429, 29052, 63228, 30731, 15747, 25827, 22332, 62349, 56661, 44652, 51862, 57007, 22773, 40361, 65238, 19327, 17282, 44708, 35484, 34064, 11148, 92729, 22995, 18833, 77528, 48917, 17256, 93166, 68576, 71096, 56499, 35096, 80551, 82424, 17700, 32748, 78969, 46820, 57725, 46179, 54677, 98097, 62869, 83959, 66728, 19716, 48326, 27420, 53458, 69056, 84216, 36688, 63957, 41469, 66843, 18024, 81950, 21911, 58387, 58103, 19813, 34581, 55347, 17171, 35914, 75043, 75088, 80541, 26802, 28849, 22356, 57721, 77084, 46385, 59255, 29308, 65885, 70673, 13306, 68788, 87335, 40987, 31654, 67560, 92309, 78116, 65961, 45018, 16548, 67092, 21818, 33716, 49449, 86150, 12156, 27574, 43201, 50977, 52839, 33234, 86611, 71494, 17823, 57172, 59869, 34086, 51052, 11320, 39717, 79604, 24672, 70555, 38378, 91135, 15567, 21606, 74994, 77168, 38607, 27384, 68328, 88944, 40203, 37893, 42726, 83549, 48739, 55652, 27543, 23109, 98908, 28831, 45011, 47525, 43870, 79404, 35780, 42136, 49317, 14574, 99586, 21107, 14302, 83882, 81272, 92552, 14916, 87533, 86518, 17862, 30741, 96288, 57886, 30304, 24201, 79457, 36728, 49833, 35182, 20108, 39858, 10804, 47042, 20439, 54708, 59027, 82499, 75311, 26548, 53406, 92060, 41152, 60446, 33129, 43979, 16903, 60319, 35550, 33887, 25463, 40343, 20726, 44429])
                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]


physical_plan after CombinePartialFinalAggregate:
SAME TEXT AS ABOVE

physical_plan after EnforceSorting:
ProjectionExec: expr=[<exprs>]
  OutputRequirementExec: order_by=[(#<col>, asc)], dist_by=SinglePartition
    SortExec: [<sort_exprs>], fetch=100
      SortExec: expr=[<exprs>]
        ProjectionExec: expr=[<exprs>]
          AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
              CoalesceBatchesExec: target_batch_size=8192
                AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
                  CoalesceBatchesExec: target_batch_size=8192
                    HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>, CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>)], projection=[#<col>, #<col>]
                      CoalescePartitionsExec
                        ProjectionExec: expr=[<exprs>]
                          CoalesceBatchesExec: target_batch_size=8192
                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(store.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>, #<col>]
                              ProjectionExec: expr=[<exprs>]
                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                              CoalesceBatchesExec: target_batch_size=8192
                                HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(date_dim.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>]
                                  CoalescePartitionsExec
                                    ProjectionExec: expr=[<exprs>]
                                      CoalesceBatchesExec: target_batch_size=8192
                                        FilterExec: _10@<id> = 1 AND _6@<id> = 2000, projection=[_0@<id>]
                                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                            DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                  RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                    ProjectionExec: expr=[<exprs>]
                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                      ProjectionExec: expr=[<exprs>]
                        CoalesceBatchesExec: target_batch_size=8192
                          HashJoinExec: mode=CollectLeft, join_type=RightSemi, on=[(#<col>, #<col>)], NullsEqual: true
                            CoalescePartitionsExec
                              ProjectionExec: expr=[<exprs>]
                                CoalesceBatchesExec: target_batch_size=8192
                                  FilterExec: count(Int64(1))@<id> > 10, projection=[#<col>]
                                    AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                      RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                        CoalesceBatchesExec: target_batch_size=8192
                                          AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                              CoalesceBatchesExec: target_batch_size=8192
                                                HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, #<col>)], projection=[#<col>]
                                                  ProjectionExec: expr=[<exprs>]
                                                    CoalesceBatchesExec: target_batch_size=8192
                                                      FilterExec: _10@<id> = Y, projection=[_4@<id>]
                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                  ProjectionExec: expr=[<exprs>]
                                                    DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                            AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[]
                              RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                CoalesceBatchesExec: target_batch_size=8192
                                  AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[]
                                    ProjectionExec: expr=[<exprs>]
                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                        ProjectionExec: expr=[<exprs>]
                                          CoalesceBatchesExec: target_batch_size=8192
                                            FilterExec: substr(_9@<id>, 1, 5) IN ([19100, 41548, 51640, 49699, 88329, 55986, 85119, 19510, 61020, 95452, 26235, 51102, 16733, 42819, 27823, 90192, 31905, 28865, 62197, 23750, 81398, 95288, 45114, 82060, 12313, 25218, 64386, 46400, 77230, 69271, 43672, 36521, 34217, 13017, 27936, 42766, 59233, 26060, 27477, 39981, 93402, 74270, 13932, 51731, 71642, 17710, 85156, 21679, 70840, 67191, 39214, 35273, 27293, 17128, 15458, 31615, 60706, 67657, 54092, 32775, 14683, 32206, 62543, 43053, 11297, 58216, 49410, 14710, 24501, 79057, 77038, 91286, 32334, 46298, 18326, 67213, 65382, 40315, 56115, 80162, 55956, 81583, 73588, 32513, 62880, 12201, 11592, 17014, 83832, 61796, 57872, 78829, 69912, 48524, 22016, 26905, 48511, 92168, 63051, 25748, 89786, 98827, 86404, 53029, 37524, 14039, 50078, 34487, 70142, 18697, 40129, 60642, 42810, 62667, 57183, 46414, 58463, 71211, 46364, 34851, 54884, 25382, 25239, 74126, 21568, 84204, 13607, 82518, 32982, 36953, 86001, 79278, 21745, 64444, 35199, 83181, 73255, 86177, 98043, 90392, 13882, 47084, 17859, 89526, 42072, 20233, 52745, 75000, 22044, 77013, 24182, 52554, 56138, 43440, 86100, 48791, 21883, 17096, 15965, 31196, 74903, 19810, 35763, 92020, 55176, 54433, 68063, 71919, 44384, 16612, 32109, 28207, 14762, 89933, 10930, 27616, 56809, 14244, 22733, 33177, 29784, 74968, 37887, 11299, 34692, 85843, 83663, 95421, 19323, 17406, 69264, 28341, 50150, 79121, 73974, 92917, 21229, 32254, 97408, 46011, 37169, 18146, 27296, 62927, 68812, 47734, 86572, 12620, 80252, 50173, 27261, 29534, 23488, 42184, 23695, 45868, 12910, 23429, 29052, 63228, 30731, 15747, 25827, 22332, 62349, 56661, 44652, 51862, 57007, 22773, 40361, 65238, 19327, 17282, 44708, 35484, 34064, 11148, 92729, 22995, 18833, 77528, 48917, 17256, 93166, 68576, 71096, 56499, 35096, 80551, 82424, 17700, 32748, 78969, 46820, 57725, 46179, 54677, 98097, 62869, 83959, 66728, 19716, 48326, 27420, 53458, 69056, 84216, 36688, 63957, 41469, 66843, 18024, 81950, 21911, 58387, 58103, 19813, 34581, 55347, 17171, 35914, 75043, 75088, 80541, 26802, 28849, 22356, 57721, 77084, 46385, 59255, 29308, 65885, 70673, 13306, 68788, 87335, 40987, 31654, 67560, 92309, 78116, 65961, 45018, 16548, 67092, 21818, 33716, 49449, 86150, 12156, 27574, 43201, 50977, 52839, 33234, 86611, 71494, 17823, 57172, 59869, 34086, 51052, 11320, 39717, 79604, 24672, 70555, 38378, 91135, 15567, 21606, 74994, 77168, 38607, 27384, 68328, 88944, 40203, 37893, 42726, 83549, 48739, 55652, 27543, 23109, 98908, 28831, 45011, 47525, 43870, 79404, 35780, 42136, 49317, 14574, 99586, 21107, 14302, 83882, 81272, 92552, 14916, 87533, 86518, 17862, 30741, 96288, 57886, 30304, 24201, 79457, 36728, 49833, 35182, 20108, 39858, 10804, 47042, 20439, 54708, 59027, 82499, 75311, 26548, 53406, 92060, 41152, 60446, 33129, 43979, 16903, 60319, 35550, 33887, 25463, 40343, 20726, 44429])
                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]


physical_plan after OptimizeAggregateOrder:
SAME TEXT AS ABOVE

physical_plan after ProjectionPushdown:
SAME TEXT AS ABOVE

physical_plan after coalesce_batches:
ProjectionExec: expr=[<exprs>]
  OutputRequirementExec: order_by=[(#<col>, asc)], dist_by=SinglePartition
    SortExec: [<sort_exprs>], fetch=100
      SortExec: expr=[<exprs>]
        ProjectionExec: expr=[<exprs>]
          AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
            CoalesceBatchesExec: target_batch_size=8192
              RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                CoalesceBatchesExec: target_batch_size=8192
                  AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
                    CoalesceBatchesExec: target_batch_size=8192
                      CoalesceBatchesExec: target_batch_size=8192
                        HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>, CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>)], projection=[#<col>, #<col>]
                          CoalescePartitionsExec
                            ProjectionExec: expr=[<exprs>]
                              CoalesceBatchesExec: target_batch_size=8192
                                CoalesceBatchesExec: target_batch_size=8192
                                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(store.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>, #<col>]
                                    ProjectionExec: expr=[<exprs>]
                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                    CoalesceBatchesExec: target_batch_size=8192
                                      CoalesceBatchesExec: target_batch_size=8192
                                        HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(date_dim.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>]
                                          CoalescePartitionsExec
                                            ProjectionExec: expr=[<exprs>]
                                              CoalesceBatchesExec: target_batch_size=8192
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  FilterExec: _10@<id> = 1 AND _6@<id> = 2000, projection=[_0@<id>]
                                                    RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                            ProjectionExec: expr=[<exprs>]
                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                          ProjectionExec: expr=[<exprs>]
                            CoalesceBatchesExec: target_batch_size=8192
                              CoalesceBatchesExec: target_batch_size=8192
                                HashJoinExec: mode=CollectLeft, join_type=RightSemi, on=[(#<col>, #<col>)], NullsEqual: true
                                  CoalescePartitionsExec
                                    ProjectionExec: expr=[<exprs>]
                                      CoalesceBatchesExec: target_batch_size=8192
                                        CoalesceBatchesExec: target_batch_size=8192
                                          FilterExec: count(Int64(1))@<id> > 10, projection=[#<col>]
                                            AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                              CoalesceBatchesExec: target_batch_size=8192
                                                RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          CoalesceBatchesExec: target_batch_size=8192
                                                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, #<col>)], projection=[#<col>]
                                                              ProjectionExec: expr=[<exprs>]
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: _10@<id> = Y, projection=[_4@<id>]
                                                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                              ProjectionExec: expr=[<exprs>]
                                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                  AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[]
                                    CoalesceBatchesExec: target_batch_size=8192
                                      RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                        CoalesceBatchesExec: target_batch_size=8192
                                          AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[]
                                            ProjectionExec: expr=[<exprs>]
                                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                ProjectionExec: expr=[<exprs>]
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    CoalesceBatchesExec: target_batch_size=8192
                                                      FilterExec: substr(_9@<id>, 1, 5) IN ([19100, 41548, 51640, 49699, 88329, 55986, 85119, 19510, 61020, 95452, 26235, 51102, 16733, 42819, 27823, 90192, 31905, 28865, 62197, 23750, 81398, 95288, 45114, 82060, 12313, 25218, 64386, 46400, 77230, 69271, 43672, 36521, 34217, 13017, 27936, 42766, 59233, 26060, 27477, 39981, 93402, 74270, 13932, 51731, 71642, 17710, 85156, 21679, 70840, 67191, 39214, 35273, 27293, 17128, 15458, 31615, 60706, 67657, 54092, 32775, 14683, 32206, 62543, 43053, 11297, 58216, 49410, 14710, 24501, 79057, 77038, 91286, 32334, 46298, 18326, 67213, 65382, 40315, 56115, 80162, 55956, 81583, 73588, 32513, 62880, 12201, 11592, 17014, 83832, 61796, 57872, 78829, 69912, 48524, 22016, 26905, 48511, 92168, 63051, 25748, 89786, 98827, 86404, 53029, 37524, 14039, 50078, 34487, 70142, 18697, 40129, 60642, 42810, 62667, 57183, 46414, 58463, 71211, 46364, 34851, 54884, 25382, 25239, 74126, 21568, 84204, 13607, 82518, 32982, 36953, 86001, 79278, 21745, 64444, 35199, 83181, 73255, 86177, 98043, 90392, 13882, 47084, 17859, 89526, 42072, 20233, 52745, 75000, 22044, 77013, 24182, 52554, 56138, 43440, 86100, 48791, 21883, 17096, 15965, 31196, 74903, 19810, 35763, 92020, 55176, 54433, 68063, 71919, 44384, 16612, 32109, 28207, 14762, 89933, 10930, 27616, 56809, 14244, 22733, 33177, 29784, 74968, 37887, 11299, 34692, 85843, 83663, 95421, 19323, 17406, 69264, 28341, 50150, 79121, 73974, 92917, 21229, 32254, 97408, 46011, 37169, 18146, 27296, 62927, 68812, 47734, 86572, 12620, 80252, 50173, 27261, 29534, 23488, 42184, 23695, 45868, 12910, 23429, 29052, 63228, 30731, 15747, 25827, 22332, 62349, 56661, 44652, 51862, 57007, 22773, 40361, 65238, 19327, 17282, 44708, 35484, 34064, 11148, 92729, 22995, 18833, 77528, 48917, 17256, 93166, 68576, 71096, 56499, 35096, 80551, 82424, 17700, 32748, 78969, 46820, 57725, 46179, 54677, 98097, 62869, 83959, 66728, 19716, 48326, 27420, 53458, 69056, 84216, 36688, 63957, 41469, 66843, 18024, 81950, 21911, 58387, 58103, 19813, 34581, 55347, 17171, 35914, 75043, 75088, 80541, 26802, 28849, 22356, 57721, 77084, 46385, 59255, 29308, 65885, 70673, 13306, 68788, 87335, 40987, 31654, 67560, 92309, 78116, 65961, 45018, 16548, 67092, 21818, 33716, 49449, 86150, 12156, 27574, 43201, 50977, 52839, 33234, 86611, 71494, 17823, 57172, 59869, 34086, 51052, 11320, 39717, 79604, 24672, 70555, 38378, 91135, 15567, 21606, 74994, 77168, 38607, 27384, 68328, 88944, 40203, 37893, 42726, 83549, 48739, 55652, 27543, 23109, 98908, 28831, 45011, 47525, 43870, 79404, 35780, 42136, 49317, 14574, 99586, 21107, 14302, 83882, 81272, 92552, 14916, 87533, 86518, 17862, 30741, 96288, 57886, 30304, 24201, 79457, 36728, 49833, 35182, 20108, 39858, 10804, 47042, 20439, 54708, 59027, 82499, 75311, 26548, 53406, 92060, 41152, 60446, 33129, 43979, 16903, 60319, 35550, 33887, 25463, 40343, 20726, 44429])
                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]


physical_plan after coalesce_async_exec_input:
SAME TEXT AS ABOVE

physical_plan after OutputRequirements:
ProjectionExec: expr=[<exprs>]
  SortExec: [<sort_exprs>], fetch=100
    SortExec: expr=[<exprs>]
      ProjectionExec: expr=[<exprs>]
        AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
          CoalesceBatchesExec: target_batch_size=8192
            RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
              CoalesceBatchesExec: target_batch_size=8192
                AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
                  CoalesceBatchesExec: target_batch_size=8192
                    CoalesceBatchesExec: target_batch_size=8192
                      HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>, CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>)], projection=[#<col>, #<col>]
                        CoalescePartitionsExec
                          ProjectionExec: expr=[<exprs>]
                            CoalesceBatchesExec: target_batch_size=8192
                              CoalesceBatchesExec: target_batch_size=8192
                                HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(store.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>, #<col>]
                                  ProjectionExec: expr=[<exprs>]
                                    DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                  CoalesceBatchesExec: target_batch_size=8192
                                    CoalesceBatchesExec: target_batch_size=8192
                                      HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(date_dim.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>]
                                        CoalescePartitionsExec
                                          ProjectionExec: expr=[<exprs>]
                                            CoalesceBatchesExec: target_batch_size=8192
                                              CoalesceBatchesExec: target_batch_size=8192
                                                FilterExec: _10@<id> = 1 AND _6@<id> = 2000, projection=[_0@<id>]
                                                  RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                    DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                          ProjectionExec: expr=[<exprs>]
                                            DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                        ProjectionExec: expr=[<exprs>]
                          CoalesceBatchesExec: target_batch_size=8192
                            CoalesceBatchesExec: target_batch_size=8192
                              HashJoinExec: mode=CollectLeft, join_type=RightSemi, on=[(#<col>, #<col>)], NullsEqual: true
                                CoalescePartitionsExec
                                  ProjectionExec: expr=[<exprs>]
                                    CoalesceBatchesExec: target_batch_size=8192
                                      CoalesceBatchesExec: target_batch_size=8192
                                        FilterExec: count(Int64(1))@<id> > 10, projection=[#<col>]
                                          AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                            CoalesceBatchesExec: target_batch_size=8192
                                              RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                                    RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                      CoalesceBatchesExec: target_batch_size=8192
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, #<col>)], projection=[#<col>]
                                                            ProjectionExec: expr=[<exprs>]
                                                              CoalesceBatchesExec: target_batch_size=8192
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  FilterExec: _10@<id> = Y, projection=[_4@<id>]
                                                                    DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                            ProjectionExec: expr=[<exprs>]
                                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[]
                                  CoalesceBatchesExec: target_batch_size=8192
                                    RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                      CoalesceBatchesExec: target_batch_size=8192
                                        AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[]
                                          ProjectionExec: expr=[<exprs>]
                                            RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                              ProjectionExec: expr=[<exprs>]
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    FilterExec: substr(_9@<id>, 1, 5) IN ([19100, 41548, 51640, 49699, 88329, 55986, 85119, 19510, 61020, 95452, 26235, 51102, 16733, 42819, 27823, 90192, 31905, 28865, 62197, 23750, 81398, 95288, 45114, 82060, 12313, 25218, 64386, 46400, 77230, 69271, 43672, 36521, 34217, 13017, 27936, 42766, 59233, 26060, 27477, 39981, 93402, 74270, 13932, 51731, 71642, 17710, 85156, 21679, 70840, 67191, 39214, 35273, 27293, 17128, 15458, 31615, 60706, 67657, 54092, 32775, 14683, 32206, 62543, 43053, 11297, 58216, 49410, 14710, 24501, 79057, 77038, 91286, 32334, 46298, 18326, 67213, 65382, 40315, 56115, 80162, 55956, 81583, 73588, 32513, 62880, 12201, 11592, 17014, 83832, 61796, 57872, 78829, 69912, 48524, 22016, 26905, 48511, 92168, 63051, 25748, 89786, 98827, 86404, 53029, 37524, 14039, 50078, 34487, 70142, 18697, 40129, 60642, 42810, 62667, 57183, 46414, 58463, 71211, 46364, 34851, 54884, 25382, 25239, 74126, 21568, 84204, 13607, 82518, 32982, 36953, 86001, 79278, 21745, 64444, 35199, 83181, 73255, 86177, 98043, 90392, 13882, 47084, 17859, 89526, 42072, 20233, 52745, 75000, 22044, 77013, 24182, 52554, 56138, 43440, 86100, 48791, 21883, 17096, 15965, 31196, 74903, 19810, 35763, 92020, 55176, 54433, 68063, 71919, 44384, 16612, 32109, 28207, 14762, 89933, 10930, 27616, 56809, 14244, 22733, 33177, 29784, 74968, 37887, 11299, 34692, 85843, 83663, 95421, 19323, 17406, 69264, 28341, 50150, 79121, 73974, 92917, 21229, 32254, 97408, 46011, 37169, 18146, 27296, 62927, 68812, 47734, 86572, 12620, 80252, 50173, 27261, 29534, 23488, 42184, 23695, 45868, 12910, 23429, 29052, 63228, 30731, 15747, 25827, 22332, 62349, 56661, 44652, 51862, 57007, 22773, 40361, 65238, 19327, 17282, 44708, 35484, 34064, 11148, 92729, 22995, 18833, 77528, 48917, 17256, 93166, 68576, 71096, 56499, 35096, 80551, 82424, 17700, 32748, 78969, 46820, 57725, 46179, 54677, 98097, 62869, 83959, 66728, 19716, 48326, 27420, 53458, 69056, 84216, 36688, 63957, 41469, 66843, 18024, 81950, 21911, 58387, 58103, 19813, 34581, 55347, 17171, 35914, 75043, 75088, 80541, 26802, 28849, 22356, 57721, 77084, 46385, 59255, 29308, 65885, 70673, 13306, 68788, 87335, 40987, 31654, 67560, 92309, 78116, 65961, 45018, 16548, 67092, 21818, 33716, 49449, 86150, 12156, 27574, 43201, 50977, 52839, 33234, 86611, 71494, 17823, 57172, 59869, 34086, 51052, 11320, 39717, 79604, 24672, 70555, 38378, 91135, 15567, 21606, 74994, 77168, 38607, 27384, 68328, 88944, 40203, 37893, 42726, 83549, 48739, 55652, 27543, 23109, 98908, 28831, 45011, 47525, 43870, 79404, 35780, 42136, 49317, 14574, 99586, 21107, 14302, 83882, 81272, 92552, 14916, 87533, 86518, 17862, 30741, 96288, 57886, 30304, 24201, 79457, 36728, 49833, 35182, 20108, 39858, 10804, 47042, 20439, 54708, 59027, 82499, 75311, 26548, 53406, 92060, 41152, 60446, 33129, 43979, 16903, 60319, 35550, 33887, 25463, 40343, 20726, 44429])
                                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]


physical_plan after LimitAggregation:
SAME TEXT AS ABOVE

physical_plan after LimitPushPastWindows:
SAME TEXT AS ABOVE

physical_plan after LimitPushdown:
SAME TEXT AS ABOVE

physical_plan after ProjectionPushdown:
SAME TEXT AS ABOVE

physical_plan after EnsureCooperative:
SAME TEXT AS ABOVE

physical_plan after FilterPushdown(Post):
SAME TEXT AS ABOVE

physical_plan after RewriteExplicitRepartition:
SAME TEXT AS ABOVE

physical_plan after SanityCheckPlan:
SAME TEXT AS ABOVE

physical_plan:
ProjectionExec: expr=[<exprs>]
  ProjectionExec: expr=[<exprs>]
    SortExec: [<sort_exprs>], fetch=100
      SortExec: expr=[<exprs>]
        ProjectionExec: expr=[<exprs>]
          AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
            CoalesceBatchesExec: target_batch_size=8192
              RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                CoalesceBatchesExec: target_batch_size=8192
                  AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
                    CoalesceBatchesExec: target_batch_size=8192
                      CoalesceBatchesExec: target_batch_size=8192
                        HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>, CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>)], projection=[#<col>, #<col>]
                          CoalescePartitionsExec
                            ProjectionExec: expr=[<exprs>]
                              CoalesceBatchesExec: target_batch_size=8192
                                CoalesceBatchesExec: target_batch_size=8192
                                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(store.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>, #<col>]
                                    ProjectionExec: expr=[<exprs>]
                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                    CoalesceBatchesExec: target_batch_size=8192
                                      CoalesceBatchesExec: target_batch_size=8192
                                        HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(date_dim.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>]
                                          CoalescePartitionsExec
                                            ProjectionExec: expr=[<exprs>]
                                              CoalesceBatchesExec: target_batch_size=8192
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  FilterExec: _10@<id> = 1 AND _6@<id> = 2000, projection=[_0@<id>]
                                                    RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                            ProjectionExec: expr=[<exprs>]
                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                          ProjectionExec: expr=[<exprs>]
                            CoalesceBatchesExec: target_batch_size=8192
                              CoalesceBatchesExec: target_batch_size=8192
                                HashJoinExec: mode=CollectLeft, join_type=RightSemi, on=[(#<col>, #<col>)], NullsEqual: true
                                  CoalescePartitionsExec
                                    ProjectionExec: expr=[<exprs>]
                                      CoalesceBatchesExec: target_batch_size=8192
                                        CoalesceBatchesExec: target_batch_size=8192
                                          FilterExec: count(Int64(1))@<id> > 10, projection=[#<col>]
                                            AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                              CoalesceBatchesExec: target_batch_size=8192
                                                RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          CoalesceBatchesExec: target_batch_size=8192
                                                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, #<col>)], projection=[#<col>]
                                                              ProjectionExec: expr=[<exprs>]
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: _10@<id> = Y, projection=[_4@<id>]
                                                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                              ProjectionExec: expr=[<exprs>]
                                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                  AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[]
                                    CoalesceBatchesExec: target_batch_size=8192
                                      RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                        CoalesceBatchesExec: target_batch_size=8192
                                          AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[]
                                            ProjectionExec: expr=[<exprs>]
                                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                ProjectionExec: expr=[<exprs>]
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    CoalesceBatchesExec: target_batch_size=8192
                                                      FilterExec: substr(_9@<id>, 1, 5) IN ([19100, 41548, 51640, 49699, 88329, 55986, 85119, 19510, 61020, 95452, 26235, 51102, 16733, 42819, 27823, 90192, 31905, 28865, 62197, 23750, 81398, 95288, 45114, 82060, 12313, 25218, 64386, 46400, 77230, 69271, 43672, 36521, 34217, 13017, 27936, 42766, 59233, 26060, 27477, 39981, 93402, 74270, 13932, 51731, 71642, 17710, 85156, 21679, 70840, 67191, 39214, 35273, 27293, 17128, 15458, 31615, 60706, 67657, 54092, 32775, 14683, 32206, 62543, 43053, 11297, 58216, 49410, 14710, 24501, 79057, 77038, 91286, 32334, 46298, 18326, 67213, 65382, 40315, 56115, 80162, 55956, 81583, 73588, 32513, 62880, 12201, 11592, 17014, 83832, 61796, 57872, 78829, 69912, 48524, 22016, 26905, 48511, 92168, 63051, 25748, 89786, 98827, 86404, 53029, 37524, 14039, 50078, 34487, 70142, 18697, 40129, 60642, 42810, 62667, 57183, 46414, 58463, 71211, 46364, 34851, 54884, 25382, 25239, 74126, 21568, 84204, 13607, 82518, 32982, 36953, 86001, 79278, 21745, 64444, 35199, 83181, 73255, 86177, 98043, 90392, 13882, 47084, 17859, 89526, 42072, 20233, 52745, 75000, 22044, 77013, 24182, 52554, 56138, 43440, 86100, 48791, 21883, 17096, 15965, 31196, 74903, 19810, 35763, 92020, 55176, 54433, 68063, 71919, 44384, 16612, 32109, 28207, 14762, 89933, 10930, 27616, 56809, 14244, 22733, 33177, 29784, 74968, 37887, 11299, 34692, 85843, 83663, 95421, 19323, 17406, 69264, 28341, 50150, 79121, 73974, 92917, 21229, 32254, 97408, 46011, 37169, 18146, 27296, 62927, 68812, 47734, 86572, 12620, 80252, 50173, 27261, 29534, 23488, 42184, 23695, 45868, 12910, 23429, 29052, 63228, 30731, 15747, 25827, 22332, 62349, 56661, 44652, 51862, 57007, 22773, 40361, 65238, 19327, 17282, 44708, 35484, 34064, 11148, 92729, 22995, 18833, 77528, 48917, 17256, 93166, 68576, 71096, 56499, 35096, 80551, 82424, 17700, 32748, 78969, 46820, 57725, 46179, 54677, 98097, 62869, 83959, 66728, 19716, 48326, 27420, 53458, 69056, 84216, 36688, 63957, 41469, 66843, 18024, 81950, 21911, 58387, 58103, 19813, 34581, 55347, 17171, 35914, 75043, 75088, 80541, 26802, 28849, 22356, 57721, 77084, 46385, 59255, 29308, 65885, 70673, 13306, 68788, 87335, 40987, 31654, 67560, 92309, 78116, 65961, 45018, 16548, 67092, 21818, 33716, 49449, 86150, 12156, 27574, 43201, 50977, 52839, 33234, 86611, 71494, 17823, 57172, 59869, 34086, 51052, 11320, 39717, 79604, 24672, 70555, 38378, 91135, 15567, 21606, 74994, 77168, 38607, 27384, 68328, 88944, 40203, 37893, 42726, 83549, 48739, 55652, 27543, 23109, 98908, 28831, 45011, 47525, 43870, 79404, 35780, 42136, 49317, 14574, 99586, 21107, 14302, 83882, 81272, 92552, 14916, 87533, 86518, 17862, 30741, 96288, 57886, 30304, 24201, 79457, 36728, 49833, 35182, 20108, 39858, 10804, 47042, 20439, 54708, 59027, 82499, 75311, 26548, 53406, 92060, 41152, 60446, 33129, 43979, 16903, 60319, 35550, 33887, 25463, 40343, 20726, 44429])
                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]


== Physical Plan ==
ProjectionExec: expr=[<exprs>]
  ProjectionExec: expr=[<exprs>]
    SortExec: [<sort_exprs>], fetch=100
      SortExec: expr=[<exprs>]
        ProjectionExec: expr=[<exprs>]
          AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
            CoalesceBatchesExec: target_batch_size=8192
              RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                CoalesceBatchesExec: target_batch_size=8192
                  AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[sum(store_sales.#<col>)]
                    CoalesceBatchesExec: target_batch_size=8192
                      CoalesceBatchesExec: target_batch_size=8192
                        HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(substr(CAST(store.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>, CAST(substr(CAST(V1.#<col> AS Utf8), Int64(1), Int64(2)) AS Utf8)@<id>)], projection=[#<col>, #<col>]
                          CoalescePartitionsExec
                            ProjectionExec: expr=[<exprs>]
                              CoalesceBatchesExec: target_batch_size=8192
                                CoalesceBatchesExec: target_batch_size=8192
                                  HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(store.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>, #<col>]
                                    ProjectionExec: expr=[<exprs>]
                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                    CoalesceBatchesExec: target_batch_size=8192
                                      CoalesceBatchesExec: target_batch_size=8192
                                        HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(CAST(date_dim.#<col> AS Float64)@<id>, #<col>)], projection=[#<col>, #<col>]
                                          CoalescePartitionsExec
                                            ProjectionExec: expr=[<exprs>]
                                              CoalesceBatchesExec: target_batch_size=8192
                                                CoalesceBatchesExec: target_batch_size=8192
                                                  FilterExec: _10@<id> = 1 AND _6@<id> = 2000, projection=[_0@<id>]
                                                    RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                          RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                            ProjectionExec: expr=[<exprs>]
                                              DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                          ProjectionExec: expr=[<exprs>]
                            CoalesceBatchesExec: target_batch_size=8192
                              CoalesceBatchesExec: target_batch_size=8192
                                HashJoinExec: mode=CollectLeft, join_type=RightSemi, on=[(#<col>, #<col>)], NullsEqual: true
                                  CoalescePartitionsExec
                                    ProjectionExec: expr=[<exprs>]
                                      CoalesceBatchesExec: target_batch_size=8192
                                        CoalesceBatchesExec: target_batch_size=8192
                                          FilterExec: count(Int64(1))@<id> > 10, projection=[#<col>]
                                            AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                              CoalesceBatchesExec: target_batch_size=8192
                                                RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[count(Int64(1))]
                                                      RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                        CoalesceBatchesExec: target_batch_size=8192
                                                          CoalesceBatchesExec: target_batch_size=8192
                                                            HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(#<col>, #<col>)], projection=[#<col>]
                                                              ProjectionExec: expr=[<exprs>]
                                                                CoalesceBatchesExec: target_batch_size=8192
                                                                  CoalesceBatchesExec: target_batch_size=8192
                                                                    FilterExec: _10@<id> = Y, projection=[_4@<id>]
                                                                      DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                                              ProjectionExec: expr=[<exprs>]
                                                                DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                  AggregateExec: mode=FinalPartitioned, gby=[#<col> as #<col>], aggr=[]
                                    CoalesceBatchesExec: target_batch_size=8192
                                      RepartitionExec: partitioning=Hash([#<col>], <partitions>), input_partitions=<partitions>
                                        CoalesceBatchesExec: target_batch_size=8192
                                          AggregateExec: mode=Partial, gby=[#<col> as #<col>], aggr=[]
                                            ProjectionExec: expr=[<exprs>]
                                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                                ProjectionExec: expr=[<exprs>]
                                                  CoalesceBatchesExec: target_batch_size=8192
                                                    CoalesceBatchesExec: target_batch_size=8192
                                                      FilterExec: substr(_9@<id>, 1, 5) IN ([19100, 41548, 51640, 49699, 88329, 55986, 85119, 19510, 61020, 95452, 26235, 51102, 16733, 42819, 27823, 90192, 31905, 28865, 62197, 23750, 81398, 95288, 45114, 82060, 12313, 25218, 64386, 46400, 77230, 69271, 43672, 36521, 34217, 13017, 27936, 42766, 59233, 26060, 27477, 39981, 93402, 74270, 13932, 51731, 71642, 17710, 85156, 21679, 70840, 67191, 39214, 35273, 27293, 17128, 15458, 31615, 60706, 67657, 54092, 32775, 14683, 32206, 62543, 43053, 11297, 58216, 49410, 14710, 24501, 79057, 77038, 91286, 32334, 46298, 18326, 67213, 65382, 40315, 56115, 80162, 55956, 81583, 73588, 32513, 62880, 12201, 11592, 17014, 83832, 61796, 57872, 78829, 69912, 48524, 22016, 26905, 48511, 92168, 63051, 25748, 89786, 98827, 86404, 53029, 37524, 14039, 50078, 34487, 70142, 18697, 40129, 60642, 42810, 62667, 57183, 46414, 58463, 71211, 46364, 34851, 54884, 25382, 25239, 74126, 21568, 84204, 13607, 82518, 32982, 36953, 86001, 79278, 21745, 64444, 35199, 83181, 73255, 86177, 98043, 90392, 13882, 47084, 17859, 89526, 42072, 20233, 52745, 75000, 22044, 77013, 24182, 52554, 56138, 43440, 86100, 48791, 21883, 17096, 15965, 31196, 74903, 19810, 35763, 92020, 55176, 54433, 68063, 71919, 44384, 16612, 32109, 28207, 14762, 89933, 10930, 27616, 56809, 14244, 22733, 33177, 29784, 74968, 37887, 11299, 34692, 85843, 83663, 95421, 19323, 17406, 69264, 28341, 50150, 79121, 73974, 92917, 21229, 32254, 97408, 46011, 37169, 18146, 27296, 62927, 68812, 47734, 86572, 12620, 80252, 50173, 27261, 29534, 23488, 42184, 23695, 45868, 12910, 23429, 29052, 63228, 30731, 15747, 25827, 22332, 62349, 56661, 44652, 51862, 57007, 22773, 40361, 65238, 19327, 17282, 44708, 35484, 34064, 11148, 92729, 22995, 18833, 77528, 48917, 17256, 93166, 68576, 71096, 56499, 35096, 80551, 82424, 17700, 32748, 78969, 46820, 57725, 46179, 54677, 98097, 62869, 83959, 66728, 19716, 48326, 27420, 53458, 69056, 84216, 36688, 63957, 41469, 66843, 18024, 81950, 21911, 58387, 58103, 19813, 34581, 55347, 17171, 35914, 75043, 75088, 80541, 26802, 28849, 22356, 57721, 77084, 46385, 59255, 29308, 65885, 70673, 13306, 68788, 87335, 40987, 31654, 67560, 92309, 78116, 65961, 45018, 16548, 67092, 21818, 33716, 49449, 86150, 12156, 27574, 43201, 50977, 52839, 33234, 86611, 71494, 17823, 57172, 59869, 34086, 51052, 11320, 39717, 79604, 24672, 70555, 38378, 91135, 15567, 21606, 74994, 77168, 38607, 27384, 68328, 88944, 40203, 37893, 42726, 83549, 48739, 55652, 27543, 23109, 98908, 28831, 45011, 47525, 43870, 79404, 35780, 42136, 49317, 14574, 99586, 21107, 14302, 83882, 81272, 92552, 14916, 87533, 86518, 17862, 30741, 96288, 57886, 30304, 24201, 79457, 36728, 49833, 35182, 20108, 39858, 10804, 47042, 20439, 54708, 59027, 82499, 75311, 26548, 53406, 92060, 41152, 60446, 33129, 43979, 16903, 60319, 35550, 33887, 25463, 40343, 20726, 44429])
                                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]