== Physical Plan ==
DeltaCommitExec(table_path=file://<tmp>/merge_explain_partition_pushdown/)
  CoalescePartitionsExec
    UnionExec
      DeltaWriterExec(table_path=file://<tmp>/merge_explain_partition_pushdown/)
        CoalescePartitionsExec
          UnionExec
            ProjectionExec: expr=[CASE WHEN __common_expr_<id>@<i> THEN __sail_src_id@<i> ELSE id@<i> END as id, CASE WHEN __sail_merge_target_row_present@<i> IS NOT NULL AND __sail_merge_source_row_present@<i> IS NOT NULL THEN __sail_src_value@<i> WHEN __common_expr_<id>@<i> THEN __sail_src_value@<i> ELSE value@<i> END as value, CASE WHEN __common_expr_<id>@<i> THEN __sail_src_year@<i> ELSE year@<i> END as year]
              ProjectionExec: expr=[__sail_merge_target_row_present@<i> IS NULL AND __sail_merge_source_row_present@<i> IS NOT NULL as __common_expr_<id>, id@<i> as id, value@<i> as value, year@<i> as year, __sail_file_path@<i> as __sail_file_path, __sail_merge_target_row_id@<i> as __sail_merge_target_row_id, __sail_merge_target_row_present@<i> as __sail_merge_target_row_present, __sail_src_id@<i> as __sail_src_id, __sail_src_year@<i> as __sail_src_year, __sail_src_value@<i> as __sail_src_value, __sail_merge_source_row_present@<i> as __sail_merge_source_row_present]
                CoalesceBatchesExec: target_batch_size=8192
                  FilterExec: __sail_file_path@<i> IS NULL AND (__sail_merge_target_row_present@<i> IS NOT NULL OR __sail_merge_target_row_present@<i> IS NULL AND __sail_merge_source_row_present@<i> IS NOT NULL)
                    RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                      MergeCardinalityCheckExec: row_id=__sail_merge_target_row_id, target_present=__sail_merge_target_row_present, source_present=__sail_merge_source_row_present
                        CoalescePartitionsExec
                          ProjectionExec: expr=[id@<i> as id, value@<i> as value, year@<i> as year, __sail_file_path@<i> as __sail_file_path, __sail_merge_target_row_id@<i> as __sail_merge_target_row_id, __sail_merge_target_row_present@<i> as __sail_merge_target_row_present, __sail_src_id@<i> as __sail_src_id, __sail_src_year@<i> as __sail_src_year, __sail_src_value@<i> as __sail_src_value, __sail_merge_source_row_present@<i> as __sail_merge_source_row_present]
                            CoalesceBatchesExec: target_batch_size=8192
                              HashJoinExec: mode=Partitioned, join_type=Full, on=[(__sail_src_id@<i>, id@<i>)], filter=year@<i> = 2024 AND value@<i> > 150
                                CoalesceBatchesExec: target_batch_size=8192
                                  RepartitionExec: partitioning=Hash([__sail_src_id@<i>], <partitions>), input_partitions=<partitions>
                                    ProjectionExec: expr=[__sail_src_id@<i> as __sail_src_id, __sail_src_year@<i> as __sail_src_year, __sail_src_value@<i> as __sail_src_value, true as __sail_merge_source_row_present]
                                      ProjectionExec: expr=[column1@<i> as __sail_src_id, column2@<i> as __sail_src_year, column3@<i> as __sail_src_value]
                                        DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                CoalesceBatchesExec: target_batch_size=8192
                                  RepartitionExec: partitioning=Hash([id@<i>], <partitions>), input_partitions=<partitions>
                                    ProjectionExec: expr=[id@<i> as id, value@<i> as value, year@<i> as year, __sail_file_path@<i> as __sail_file_path, __sail_merge_target_row_id@<i> as __sail_merge_target_row_id, true as __sail_merge_target_row_present]
                                      ProjectionExec: expr=[id@<i> as id, value@<i> as value, year@<i> as year, __sail_file_path@<i> as __sail_file_path, uuid() as __sail_merge_target_row_id]
                                        DataSourceExec: file_groups={2 groups: [[<tmp>/merge_explain_partition_pushdown/year=2023/part-<id>.snappy.parquet], [<tmp>/merge_explain_partition_pushdown/year=2024/part-<id>.snappy.parquet]]}, projection=[id, value, year, __sail_file_path], file_type=parquet
            CoalesceBatchesExec: target_batch_size=8192
              HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(__sail_file_path@<i>, __sail_file_path@<i>)], projection=[id@<i>, value@<i>, year@<i>]
                CoalescePartitionsExec
                  AggregateExec: mode=FinalPartitioned, gby=[__sail_file_path@<i> as __sail_file_path], aggr=[]
                    CoalesceBatchesExec: target_batch_size=8192
                      RepartitionExec: partitioning=Hash([__sail_file_path@<i>], <partitions>), input_partitions=<partitions>
                        AggregateExec: mode=Partial, gby=[__sail_file_path@<i> as __sail_file_path], aggr=[]
                          CoalesceBatchesExec: target_batch_size=8192
                            FilterExec: __sail_merge_target_row_present@<i> IS NOT NULL AND __sail_merge_source_row_present@<i> IS NOT NULL AND id@<i> = __sail_src_id@<i> AND year@<i> = 2024 AND value@<i> > 150
                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                MergeCardinalityCheckExec: row_id=__sail_merge_target_row_id, target_present=__sail_merge_target_row_present, source_present=__sail_merge_source_row_present
                                  CoalescePartitionsExec
                                    ProjectionExec: expr=[id@<i> as id, value@<i> as value, year@<i> as year, __sail_file_path@<i> as __sail_file_path, __sail_merge_target_row_id@<i> as __sail_merge_target_row_id, __sail_merge_target_row_present@<i> as __sail_merge_target_row_present, __sail_src_id@<i> as __sail_src_id, __sail_src_year@<i> as __sail_src_year, __sail_src_value@<i> as __sail_src_value, __sail_merge_source_row_present@<i> as __sail_merge_source_row_present]
                                      CoalesceBatchesExec: target_batch_size=8192
                                        HashJoinExec: mode=Partitioned, join_type=Full, on=[(__sail_src_id@<i>, id@<i>)], filter=year@<i> = 2024 AND value@<i> > 150
                                          CoalesceBatchesExec: target_batch_size=8192
                                            RepartitionExec: partitioning=Hash([__sail_src_id@<i>], <partitions>), input_partitions=<partitions>
                                              ProjectionExec: expr=[__sail_src_id@<i> as __sail_src_id, __sail_src_year@<i> as __sail_src_year, __sail_src_value@<i> as __sail_src_value, true as __sail_merge_source_row_present]
                                                ProjectionExec: expr=[column1@<i> as __sail_src_id, column2@<i> as __sail_src_year, column3@<i> as __sail_src_value]
                                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                          CoalesceBatchesExec: target_batch_size=8192
                                            RepartitionExec: partitioning=Hash([id@<i>], <partitions>), input_partitions=<partitions>
                                              ProjectionExec: expr=[id@<i> as id, value@<i> as value, year@<i> as year, __sail_file_path@<i> as __sail_file_path, __sail_merge_target_row_id@<i> as __sail_merge_target_row_id, true as __sail_merge_target_row_present]
                                                ProjectionExec: expr=[id@<i> as id, value@<i> as value, year@<i> as year, __sail_file_path@<i> as __sail_file_path, uuid() as __sail_merge_target_row_id]
                                                  DataSourceExec: file_groups={2 groups: [[<tmp>/merge_explain_partition_pushdown/year=2023/part-<id>.snappy.parquet], [<tmp>/merge_explain_partition_pushdown/year=2024/part-<id>.snappy.parquet]]}, projection=[id, value, year, __sail_file_path], file_type=parquet
                ProjectionExec: expr=[CASE WHEN __common_expr_<id>@<i> THEN __sail_src_id@<i> ELSE id@<i> END as id, CASE WHEN __sail_merge_target_row_present@<i> IS NOT NULL AND __sail_merge_source_row_present@<i> IS NOT NULL THEN __sail_src_value@<i> WHEN __common_expr_<id>@<i> THEN __sail_src_value@<i> ELSE value@<i> END as value, CASE WHEN __common_expr_<id>@<i> THEN __sail_src_year@<i> ELSE year@<i> END as year, __sail_file_path@<i> as __sail_file_path]
                  ProjectionExec: expr=[__sail_merge_target_row_present@<i> IS NULL AND __sail_merge_source_row_present@<i> IS NOT NULL as __common_expr_<id>, id@<i> as id, value@<i> as value, year@<i> as year, __sail_file_path@<i> as __sail_file_path, __sail_merge_target_row_id@<i> as __sail_merge_target_row_id, __sail_merge_target_row_present@<i> as __sail_merge_target_row_present, __sail_src_id@<i> as __sail_src_id, __sail_src_year@<i> as __sail_src_year, __sail_src_value@<i> as __sail_src_value, __sail_merge_source_row_present@<i> as __sail_merge_source_row_present]
                    CoalesceBatchesExec: target_batch_size=8192
                      FilterExec: __sail_merge_target_row_present@<i> IS NOT NULL OR __sail_merge_target_row_present@<i> IS NULL AND __sail_merge_source_row_present@<i> IS NOT NULL
                        RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                          MergeCardinalityCheckExec: row_id=__sail_merge_target_row_id, target_present=__sail_merge_target_row_present, source_present=__sail_merge_source_row_present
                            CoalescePartitionsExec
                              ProjectionExec: expr=[id@<i> as id, value@<i> as value, year@<i> as year, __sail_file_path@<i> as __sail_file_path, __sail_merge_target_row_id@<i> as __sail_merge_target_row_id, __sail_merge_target_row_present@<i> as __sail_merge_target_row_present, __sail_src_id@<i> as __sail_src_id, __sail_src_year@<i> as __sail_src_year, __sail_src_value@<i> as __sail_src_value, __sail_merge_source_row_present@<i> as __sail_merge_source_row_present]
                                CoalesceBatchesExec: target_batch_size=8192
                                  HashJoinExec: mode=Partitioned, join_type=Full, on=[(__sail_src_id@<i>, id@<i>)], filter=year@<i> = 2024 AND value@<i> > 150
                                    CoalesceBatchesExec: target_batch_size=8192
                                      RepartitionExec: partitioning=Hash([__sail_src_id@<i>], <partitions>), input_partitions=<partitions>
                                        ProjectionExec: expr=[__sail_src_id@<i> as __sail_src_id, __sail_src_year@<i> as __sail_src_year, __sail_src_value@<i> as __sail_src_value, true as __sail_merge_source_row_present]
                                          ProjectionExec: expr=[column1@<i> as __sail_src_id, column2@<i> as __sail_src_year, column3@<i> as __sail_src_value]
                                            DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                    CoalesceBatchesExec: target_batch_size=8192
                                      RepartitionExec: partitioning=Hash([id@<i>], <partitions>), input_partitions=<partitions>
                                        ProjectionExec: expr=[id@<i> as id, value@<i> as value, year@<i> as year, __sail_file_path@<i> as __sail_file_path, __sail_merge_target_row_id@<i> as __sail_merge_target_row_id, true as __sail_merge_target_row_present]
                                          ProjectionExec: expr=[id@<i> as id, value@<i> as value, year@<i> as year, __sail_file_path@<i> as __sail_file_path, uuid() as __sail_merge_target_row_id]
                                            DataSourceExec: file_groups={2 groups: [[<tmp>/merge_explain_partition_pushdown/year=2023/part-<id>.snappy.parquet], [<tmp>/merge_explain_partition_pushdown/year=2024/part-<id>.snappy.parquet]]}, projection=[id, value, year, __sail_file_path], file_type=parquet
      DeltaRemoveActionsExec
        DeltaDiscoveryExec(table_path=file://<tmp>/merge_explain_partition_pushdown/)
          CoalescePartitionsExec
            CoalesceBatchesExec: target_batch_size=8192
              HashJoinExec: mode=CollectLeft, join_type=Inner, on=[(__sail_file_path@<i>, __sail_file_path@<i>)], projection=[__sail_file_path@<i>, size_bytes@<i>, modification_time@<i>, year@<i>]
                CoalescePartitionsExec
                  AggregateExec: mode=FinalPartitioned, gby=[__sail_file_path@<i> as __sail_file_path], aggr=[]
                    CoalesceBatchesExec: target_batch_size=8192
                      RepartitionExec: partitioning=Hash([__sail_file_path@<i>], <partitions>), input_partitions=<partitions>
                        AggregateExec: mode=Partial, gby=[__sail_file_path@<i> as __sail_file_path], aggr=[]
                          CoalesceBatchesExec: target_batch_size=8192
                            FilterExec: __sail_merge_target_row_present@<i> IS NOT NULL AND __sail_merge_source_row_present@<i> IS NOT NULL AND id@<i> = __sail_src_id@<i> AND year@<i> = 2024 AND value@<i> > 150
                              RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                                MergeCardinalityCheckExec: row_id=__sail_merge_target_row_id, target_present=__sail_merge_target_row_present, source_present=__sail_merge_source_row_present
                                  CoalescePartitionsExec
                                    ProjectionExec: expr=[id@<i> as id, value@<i> as value, year@<i> as year, __sail_file_path@<i> as __sail_file_path, __sail_merge_target_row_id@<i> as __sail_merge_target_row_id, __sail_merge_target_row_present@<i> as __sail_merge_target_row_present, __sail_src_id@<i> as __sail_src_id, __sail_src_year@<i> as __sail_src_year, __sail_src_value@<i> as __sail_src_value, __sail_merge_source_row_present@<i> as __sail_merge_source_row_present]
                                      CoalesceBatchesExec: target_batch_size=8192
                                        HashJoinExec: mode=Partitioned, join_type=Full, on=[(__sail_src_id@<i>, id@<i>)], filter=year@<i> = 2024 AND value@<i> > 150
                                          CoalesceBatchesExec: target_batch_size=8192
                                            RepartitionExec: partitioning=Hash([__sail_src_id@<i>], <partitions>), input_partitions=<partitions>
                                              ProjectionExec: expr=[__sail_src_id@<i> as __sail_src_id, __sail_src_year@<i> as __sail_src_year, __sail_src_value@<i> as __sail_src_value, true as __sail_merge_source_row_present]
                                                ProjectionExec: expr=[column1@<i> as __sail_src_id, column2@<i> as __sail_src_year, column3@<i> as __sail_src_value]
                                                  DataSourceExec: partitions=1, partition_sizes=[<sizes>]
                                          CoalesceBatchesExec: target_batch_size=8192
                                            RepartitionExec: partitioning=Hash([id@<i>], <partitions>), input_partitions=<partitions>
                                              ProjectionExec: expr=[id@<i> as id, value@<i> as value, year@<i> as year, __sail_file_path@<i> as __sail_file_path, __sail_merge_target_row_id@<i> as __sail_merge_target_row_id, true as __sail_merge_target_row_present]
                                                ProjectionExec: expr=[id@<i> as id, value@<i> as value, year@<i> as year, __sail_file_path@<i> as __sail_file_path, uuid() as __sail_merge_target_row_id]
                                                  DataSourceExec: file_groups={2 groups: [[<tmp>/merge_explain_partition_pushdown/year=2023/part-<id>.snappy.parquet], [<tmp>/merge_explain_partition_pushdown/year=2024/part-<id>.snappy.parquet]]}, projection=[id, value, year, __sail_file_path], file_type=parquet
                DeltaLogScanExec(table_path=file://<tmp>/merge_explain_partition_pushdown/, version=0)
                  RepartitionExec: partitioning=RoundRobinBatch(<partitions>), input_partitions=<partitions>
                    DataSourceExec: file_groups={1 group: [[<tmp>/merge_explain_partition_pushdown/_delta_log/00000000000000000000.checkpoint.parquet]]}, projection=[add, remove, metaData, protocol, txn, sidecar], file_type=parquet