== Physical Plan ==
DeltaCommitExec(table_path=file://<tmp>/x/)
  CoalescePartitionsExec
    UnionExec
      DeltaWriterExec(table_path=file://<tmp>/x/)
        SortExec: expr=[year@3 ASC NULLS LAST, month@4 ASC NULLS LAST], preserve_partitioning=[true]
          CoalesceBatchesExec: target_batch_size=8192
            RepartitionExec: partitioning=Hash([year@3, month@4], 4), input_partitions=4
              CoalesceBatchesExec: target_batch_size=8192
                FilterExec: NOT year@3 = 2024 AND value@2 > 650
                  DeltaScanByAddsExec(table_path=file://<tmp>/x/)
                    DeltaDiscoveryExec(table_path=file://<tmp>/x/)
                      ProjectionExec: expr=[CAST(get_field(add@0, path) AS Utf8) as __sail_file_path, coalesce(CAST(get_field(add@0, size) AS Int64), 0) as size_bytes, coalesce(CAST(get_field(add@0, modificationTime) AS Int64), 0) as modification_time, CAST(array_element(map_extract(get_field(add@0, partitionValues), year), 1) AS Utf8) as year, CAST(array_element(map_extract(get_field(add@0, partitionValues), month), 1) AS Utf8) as month, CAST(get_field(add@0, stats) AS Utf8) as stats_json]
                        DeltaLogReplayExec(table_path=file://<tmp>/x/, version=2)
                          SortExec: expr=[__sail_delta_replay_path@1 ASC NULLS LAST], preserve_partitioning=[true]
                            CoalesceBatchesExec: target_batch_size=8192
                              RepartitionExec: partitioning=Hash([__sail_delta_replay_path@1], 4), input_partitions=4
                                ProjectionExec: expr=[add@0 as add, coalesce(get_field(add@0, path), get_field(remove@1, path)) as __sail_delta_replay_path, remove@1 IS NOT NULL as __sail_delta_is_remove]
                                  RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=3
                                    UnionExec
                                      DataSourceExec: file_groups={1 group: [[<tmp>/x/_delta_log/00000000000000000000.checkpoint.parquet]]}, projection=[add, remove, metaData, protocol, txn, sidecar], file_type=parquet
                                      DataSourceExec: file_groups={2 groups: [[<tmp>/x/_delta_log/00000000000000000001.json], [<tmp>/x/_delta_log/00000000000000000002.json]]}, projection=[add, remove, metaData, protocol, txn, sidecar], file_type=json
      DeltaRemoveActionsExec
        CoalescePartitionsExec
          DeltaDiscoveryExec(table_path=file://<tmp>/x/)
            ProjectionExec: expr=[CAST(get_field(add@0, path) AS Utf8) as __sail_file_path, coalesce(CAST(get_field(add@0, size) AS Int64), 0) as size_bytes, coalesce(CAST(get_field(add@0, modificationTime) AS Int64), 0) as modification_time, CAST(array_element(map_extract(get_field(add@0, partitionValues), year), 1) AS Utf8) as year, CAST(array_element(map_extract(get_field(add@0, partitionValues), month), 1) AS Utf8) as month, CAST(get_field(add@0, stats) AS Utf8) as stats_json]
              DeltaLogReplayExec(table_path=file://<tmp>/x/, version=2)
                SortExec: expr=[__sail_delta_replay_path@1 ASC NULLS LAST], preserve_partitioning=[true]
                  CoalesceBatchesExec: target_batch_size=8192
                    RepartitionExec: partitioning=Hash([__sail_delta_replay_path@1], 4), input_partitions=4
                      ProjectionExec: expr=[add@0 as add, coalesce(get_field(add@0, path), get_field(remove@1, path)) as __sail_delta_replay_path, remove@1 IS NOT NULL as __sail_delta_is_remove]
                        RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=3
                          UnionExec
                            DataSourceExec: file_groups={1 group: [[<tmp>/x/_delta_log/00000000000000000000.checkpoint.parquet]]}, projection=[add, remove, metaData, protocol, txn, sidecar], file_type=parquet
                            DataSourceExec: file_groups={2 groups: [[<tmp>/x/_delta_log/00000000000000000001.json], [<tmp>/x/_delta_log/00000000000000000002.json]]}, projection=[add, remove, metaData, protocol, txn, sidecar], file_type=json