== Physical Plan ==
DeltaCommitExec(table_path=file://<tmp>/x/)
  CoalescePartitionsExec
    UnionExec
      DeltaWriterExec(table_path=file://<tmp>/x/)
        SortExec: expr=[year@3 ASC NULLS LAST, month@4 ASC NULLS LAST], preserve_partitioning=[true]
          RepartitionExec: partitioning=Hash([year@3, month@4], 4), input_partitions=4
            FilterExec: NOT year@3 = 2024 AND value@2 > 650
              DeltaScanByAddsExec(table_path=file://<tmp>/x/)
                DeltaDiscoveryExec(table_path=file://<tmp>/x/)
                  DeltaLogReplayExec(table_path=file://<tmp>/x/, version=0)
                    SortExec: expr=[__sail_delta_replay_path@8 ASC NULLS LAST, _commit_version@3 DESC NULLS LAST], preserve_partitioning=[true]
                      RepartitionExec: partitioning=Hash([__sail_delta_replay_path@8], 4), input_partitions=4
                        ProjectionExec: expr=[CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, path) END as __sail_file_path, CASE WHEN CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, size) END IS NOT NULL THEN CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, size) END ELSE 0 END as size_bytes, CASE WHEN CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, modificationTime) END IS NOT NULL THEN CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, modificationTime) END ELSE 0 END as modification_time, __sail_delta_log_version@2 as _commit_version, CASE WHEN CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, modificationTime) END IS NOT NULL THEN CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, modificationTime) END ELSE 0 END as _commit_timestamp, array_element(map_extract(CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, partitionValues) END, year), 1) as year, array_element(map_extract(CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, partitionValues) END, month), 1) as month, CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, stats) END as stats_json, CASE WHEN CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, path) END IS NOT NULL THEN CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, path) END ELSE CASE WHEN remove@1 IS NOT NULL THEN get_field(remove@1, path) END END as __sail_delta_replay_path, remove@1 IS NOT NULL as __sail_delta_is_remove, __sail_delta_log_version@2 as __sail_delta_log_version]
                          RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1
                            DataSourceExec: file_groups={1 group: [[<tmp>/x/_delta_log/00000000000000000000.checkpoint.parquet]]}, projection=[add, remove, __sail_delta_log_version], file_type=parquet
      DeltaRemoveActionsExec
        CoalescePartitionsExec
          DeltaDiscoveryExec(table_path=file://<tmp>/x/)
            DeltaLogReplayExec(table_path=file://<tmp>/x/, version=0)
              SortExec: expr=[__sail_delta_replay_path@8 ASC NULLS LAST, _commit_version@3 DESC NULLS LAST], preserve_partitioning=[true]
                RepartitionExec: partitioning=Hash([__sail_delta_replay_path@8], 4), input_partitions=4
                  ProjectionExec: expr=[CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, path) END as __sail_file_path, CASE WHEN CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, size) END IS NOT NULL THEN CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, size) END ELSE 0 END as size_bytes, CASE WHEN CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, modificationTime) END IS NOT NULL THEN CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, modificationTime) END ELSE 0 END as modification_time, __sail_delta_log_version@2 as _commit_version, CASE WHEN CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, modificationTime) END IS NOT NULL THEN CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, modificationTime) END ELSE 0 END as _commit_timestamp, array_element(map_extract(CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, partitionValues) END, year), 1) as year, array_element(map_extract(CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, partitionValues) END, month), 1) as month, CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, stats) END as stats_json, CASE WHEN CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, path) END IS NOT NULL THEN CASE WHEN add@0 IS NOT NULL THEN get_field(add@0, path) END ELSE CASE WHEN remove@1 IS NOT NULL THEN get_field(remove@1, path) END END as __sail_delta_replay_path, remove@1 IS NOT NULL as __sail_delta_is_remove, __sail_delta_log_version@2 as __sail_delta_log_version]
                    RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1
                      DataSourceExec: file_groups={1 group: [[<tmp>/x/_delta_log/00000000000000000000.checkpoint.parquet]]}, projection=[add, remove, __sail_delta_log_version], file_type=parquet