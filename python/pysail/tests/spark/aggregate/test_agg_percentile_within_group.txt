>>> spark.sql("SELECT percentile_cont(0.5) WITHIN GROUP (ORDER BY x) AS p FROM (VALUES (0), (1), (2), (3)) AS t(x)").show()
+---+
|  p|
+---+
|1.5|
+---+

# x: 0,1,2,3,4,5,6,7,8,9
>>> df = spark.createDataFrame([(i,) for i in range(10)], ["x"])
>>> df.select(sf.percentile("x", sf.lit(0.5)).alias("percentile_50"), sf.median("x").alias("median") ).show()
+-------------+------+
|percentile_50|median|
+-------------+------+
|          4.5|   4.5|
+-------------+------+

# >>> spark.sql("SELECT percentile_disc(0.5) WITHIN GROUP (ORDER BY x) AS p FROM (VALUES (0), (1), (2), (3)) AS t(x)").show()
# +---+
# |  p|
# +---+
# |0.5|
# +---+
#
# # 1 is value TODO need to fix
